2020-06-26 12:31:57.586038 (MainThread): Running with dbt=0.17.0
2020-06-26 12:31:58.062506 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile='sales', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-26 12:31:58.064148 (MainThread): Tracking: tracking
2020-06-26 12:31:58.097855 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112046850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11204bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11204bdd0>]}
2020-06-26 12:31:58.152798 (MainThread): Partial parsing not enabled
2020-06-26 12:31:58.156691 (MainThread): Parsing macros/core.sql
2020-06-26 12:31:58.166746 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-26 12:31:58.181063 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-26 12:31:58.184602 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-26 12:31:58.211500 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-26 12:31:58.249490 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-26 12:31:58.275513 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-26 12:31:58.278809 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-26 12:31:58.287210 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-26 12:31:58.304348 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-26 12:31:58.315294 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-26 12:31:58.324261 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-26 12:31:58.332785 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-26 12:31:58.334910 (MainThread): Parsing macros/etc/query.sql
2020-06-26 12:31:58.336851 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-26 12:31:58.340074 (MainThread): Parsing macros/etc/datetime.sql
2020-06-26 12:31:58.351745 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-26 12:31:58.354728 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-26 12:31:58.357578 (MainThread): Parsing macros/adapters/common.sql
2020-06-26 12:31:58.416882 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-26 12:31:58.419283 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-26 12:31:58.421247 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-26 12:31:58.423558 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-26 12:31:58.427227 (MainThread): Parsing macros/etc.sql
2020-06-26 12:31:58.428590 (MainThread): Parsing macros/catalog.sql
2020-06-26 12:31:58.438140 (MainThread): Parsing macros/adapters.sql
2020-06-26 12:31:58.459161 (MainThread): Parsing macros/materializations/seed.sql
2020-06-26 12:31:58.462541 (MainThread): Parsing macros/materializations/view.sql
2020-06-26 12:31:58.466055 (MainThread): Parsing macros/materializations/table.sql
2020-06-26 12:31:58.482865 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-26 12:31:58.499365 (MainThread): Parsing macros/materializations/snapshot.sql
2020-06-26 12:31:58.526845 (MainThread): Partial parsing not enabled
2020-06-26 12:31:58.567894 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-06-26 12:31:58.568082 (MainThread): Opening a new connection, currently in state init
2020-06-26 12:31:58.696193 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112200ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120a4b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11220eb10>]}
2020-06-26 12:31:58.696534 (MainThread): Flushing usage events
2020-06-26 12:31:58.998865 (MainThread): Connection 'model.springml_demo_dbt_project.payments' was properly closed.
2020-06-26 12:31:58.999131 (MainThread): Encountered an error:
2020-06-26 12:31:58.999371 (MainThread): Compilation Error in model payments (models/payments.sql)
  Model 'model.springml_demo_dbt_project.payments' (models/payments.sql) depends on a source named 'springml_demo_dataset.sales' which was not found
2020-06-26 12:31:59.025720 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 212, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.7/site-packages/dbt/task/runnable.py", line 389, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.7/site-packages/dbt/task/runnable.py", line 103, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.7/site-packages/dbt/task/runnable.py", line 71, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.7/site-packages/dbt/task/runnable.py", line 60, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.7/site-packages/dbt/perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 641, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 358, in load_all
    manifest = loader.create_manifest()
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 334, in create_manifest
    self.process_manifest(manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 305, in process_manifest
    process_sources(manifest, project_name)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 600, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 587, in _process_sources_for_node
    disabled=(isinstance(target_source, Disabled))
  File "/usr/local/lib/python3.7/site-packages/dbt/utils.py", line 337, in invalid_source_fail_unless_test
    disabled=disabled
  File "/usr/local/lib/python3.7/site-packages/dbt/exceptions.py", line 554, in source_target_not_found
    raise_compiler_error(msg, model)
  File "/usr/local/lib/python3.7/site-packages/dbt/exceptions.py", line 392, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model payments (models/payments.sql)
  Model 'model.springml_demo_dbt_project.payments' (models/payments.sql) depends on a source named 'springml_demo_dataset.sales' which was not found

2020-06-26 12:36:45.600116 (MainThread): Running with dbt=0.17.0
2020-06-26 12:36:46.112666 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile='sales', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-26 12:36:46.114375 (MainThread): Tracking: tracking
2020-06-26 12:36:46.149765 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a547190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a54df90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a54de50>]}
2020-06-26 12:36:46.212418 (MainThread): Partial parsing not enabled
2020-06-26 12:36:46.217110 (MainThread): Parsing macros/core.sql
2020-06-26 12:36:46.224273 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-26 12:36:46.240809 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-26 12:36:46.248327 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-26 12:36:46.273588 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-26 12:36:46.337783 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-26 12:36:46.388309 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-26 12:36:46.391679 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-26 12:36:46.400747 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-26 12:36:46.420524 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-26 12:36:46.429850 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-26 12:36:46.439160 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-26 12:36:46.446085 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-26 12:36:46.447529 (MainThread): Parsing macros/etc/query.sql
2020-06-26 12:36:46.449121 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-26 12:36:46.451413 (MainThread): Parsing macros/etc/datetime.sql
2020-06-26 12:36:46.465389 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-26 12:36:46.469711 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-26 12:36:46.472844 (MainThread): Parsing macros/adapters/common.sql
2020-06-26 12:36:46.539423 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-26 12:36:46.541334 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-26 12:36:46.543097 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-26 12:36:46.545532 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-26 12:36:46.549793 (MainThread): Parsing macros/etc.sql
2020-06-26 12:36:46.551292 (MainThread): Parsing macros/catalog.sql
2020-06-26 12:36:46.559361 (MainThread): Parsing macros/adapters.sql
2020-06-26 12:36:46.599995 (MainThread): Parsing macros/materializations/seed.sql
2020-06-26 12:36:46.604692 (MainThread): Parsing macros/materializations/view.sql
2020-06-26 12:36:46.608312 (MainThread): Parsing macros/materializations/table.sql
2020-06-26 12:36:46.625501 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-26 12:36:46.655751 (MainThread): Parsing macros/materializations/snapshot.sql
2020-06-26 12:36:46.686270 (MainThread): Partial parsing not enabled
2020-06-26 12:36:46.742667 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-06-26 12:36:46.742813 (MainThread): Opening a new connection, currently in state init
2020-06-26 12:36:46.881383 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a713390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a71b390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5a2dd0>]}
2020-06-26 12:36:46.881651 (MainThread): Flushing usage events
2020-06-26 12:36:47.190812 (MainThread): Connection 'model.springml_demo_dbt_project.payments' was properly closed.
2020-06-26 12:36:47.191024 (MainThread): Encountered an error:
2020-06-26 12:36:47.191204 (MainThread): Compilation Error in model payments (models/base/payments.sql)
  Model 'model.springml_demo_dbt_project.payments' (models/base/payments.sql) depends on a source named 'springml_demo_dataset.sales' which was not found
2020-06-26 12:36:47.196596 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 212, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.7/site-packages/dbt/task/runnable.py", line 389, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.7/site-packages/dbt/task/runnable.py", line 103, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.7/site-packages/dbt/task/runnable.py", line 71, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.7/site-packages/dbt/task/runnable.py", line 60, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.7/site-packages/dbt/perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 641, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 358, in load_all
    manifest = loader.create_manifest()
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 334, in create_manifest
    self.process_manifest(manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 305, in process_manifest
    process_sources(manifest, project_name)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 600, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 587, in _process_sources_for_node
    disabled=(isinstance(target_source, Disabled))
  File "/usr/local/lib/python3.7/site-packages/dbt/utils.py", line 337, in invalid_source_fail_unless_test
    disabled=disabled
  File "/usr/local/lib/python3.7/site-packages/dbt/exceptions.py", line 554, in source_target_not_found
    raise_compiler_error(msg, model)
  File "/usr/local/lib/python3.7/site-packages/dbt/exceptions.py", line 392, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model payments (models/base/payments.sql)
  Model 'model.springml_demo_dbt_project.payments' (models/base/payments.sql) depends on a source named 'springml_demo_dataset.sales' which was not found

2020-06-26 13:18:39.320669 (MainThread): Running with dbt=0.17.0
2020-06-26 13:18:39.836015 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-26 13:18:39.839175 (MainThread): Tracking: tracking
2020-06-26 13:18:39.857204 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131812d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11315e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11319b4d0>]}
2020-06-26 13:18:39.927226 (MainThread): Partial parsing not enabled
2020-06-26 13:18:39.930146 (MainThread): Parsing macros/core.sql
2020-06-26 13:18:39.936127 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-26 13:18:39.949955 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-26 13:18:39.953324 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-26 13:18:39.979340 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-26 13:18:40.021621 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-26 13:18:40.053228 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-26 13:18:40.056600 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-26 13:18:40.071115 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-26 13:18:40.097565 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-26 13:18:40.106591 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-26 13:18:40.119910 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-26 13:18:40.133418 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-26 13:18:40.135908 (MainThread): Parsing macros/etc/query.sql
2020-06-26 13:18:40.138444 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-26 13:18:40.142415 (MainThread): Parsing macros/etc/datetime.sql
2020-06-26 13:18:40.161951 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-26 13:18:40.164857 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-26 13:18:40.167796 (MainThread): Parsing macros/adapters/common.sql
2020-06-26 13:18:40.236165 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-26 13:18:40.238840 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-26 13:18:40.240876 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-26 13:18:40.243999 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-26 13:18:40.248446 (MainThread): Parsing macros/etc.sql
2020-06-26 13:18:40.249855 (MainThread): Parsing macros/catalog.sql
2020-06-26 13:18:40.258559 (MainThread): Parsing macros/adapters.sql
2020-06-26 13:18:40.281749 (MainThread): Parsing macros/materializations/seed.sql
2020-06-26 13:18:40.284455 (MainThread): Parsing macros/materializations/view.sql
2020-06-26 13:18:40.287101 (MainThread): Parsing macros/materializations/table.sql
2020-06-26 13:18:40.301763 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-26 13:18:40.320722 (MainThread): Parsing macros/materializations/snapshot.sql
2020-06-26 13:18:40.353337 (MainThread): Partial parsing not enabled
2020-06-26 13:18:40.406394 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-06-26 13:18:40.406539 (MainThread): Opening a new connection, currently in state init
2020-06-26 13:18:40.560110 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113210690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11336fe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113350390>]}
2020-06-26 13:18:40.560457 (MainThread): Flushing usage events
2020-06-26 13:18:41.095932 (MainThread): Connection 'model.springml_demo_dbt_project.payments' was properly closed.
2020-06-26 13:18:41.096130 (MainThread): Encountered an error:
2020-06-26 13:18:41.096274 (MainThread): Compilation Error in model payments (models/base/payments.sql)
  Model 'model.springml_demo_dbt_project.payments' (models/base/payments.sql) depends on a source named 'springml_demo_dataset.sales' which was not found
2020-06-26 13:18:41.109437 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 212, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.7/site-packages/dbt/task/runnable.py", line 389, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.7/site-packages/dbt/task/runnable.py", line 103, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.7/site-packages/dbt/task/runnable.py", line 71, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.7/site-packages/dbt/task/runnable.py", line 60, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.7/site-packages/dbt/perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 641, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 358, in load_all
    manifest = loader.create_manifest()
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 334, in create_manifest
    self.process_manifest(manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 305, in process_manifest
    process_sources(manifest, project_name)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 600, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 587, in _process_sources_for_node
    disabled=(isinstance(target_source, Disabled))
  File "/usr/local/lib/python3.7/site-packages/dbt/utils.py", line 337, in invalid_source_fail_unless_test
    disabled=disabled
  File "/usr/local/lib/python3.7/site-packages/dbt/exceptions.py", line 554, in source_target_not_found
    raise_compiler_error(msg, model)
  File "/usr/local/lib/python3.7/site-packages/dbt/exceptions.py", line 392, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model payments (models/base/payments.sql)
  Model 'model.springml_demo_dbt_project.payments' (models/base/payments.sql) depends on a source named 'springml_demo_dataset.sales' which was not found

2020-06-26 13:22:00.333193 (MainThread): Running with dbt=0.17.0
2020-06-26 13:22:00.795861 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-26 13:22:00.797352 (MainThread): Tracking: tracking
2020-06-26 13:22:00.813321 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f369d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f02f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f50150>]}
2020-06-26 13:22:00.867442 (MainThread): Partial parsing not enabled
2020-06-26 13:22:00.871385 (MainThread): Parsing macros/core.sql
2020-06-26 13:22:00.878745 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-26 13:22:00.888879 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-26 13:22:00.891924 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-26 13:22:00.916932 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-26 13:22:00.956433 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-26 13:22:00.985847 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-26 13:22:00.989290 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-26 13:22:00.998032 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-26 13:22:01.019538 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-26 13:22:01.029133 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-26 13:22:01.037431 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-26 13:22:01.043972 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-26 13:22:01.045865 (MainThread): Parsing macros/etc/query.sql
2020-06-26 13:22:01.048067 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-26 13:22:01.051090 (MainThread): Parsing macros/etc/datetime.sql
2020-06-26 13:22:01.066728 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-26 13:22:01.070100 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-26 13:22:01.072990 (MainThread): Parsing macros/adapters/common.sql
2020-06-26 13:22:01.131700 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-26 13:22:01.134269 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-26 13:22:01.136337 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-26 13:22:01.138601 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-26 13:22:01.142806 (MainThread): Parsing macros/etc.sql
2020-06-26 13:22:01.144828 (MainThread): Parsing macros/catalog.sql
2020-06-26 13:22:01.154058 (MainThread): Parsing macros/adapters.sql
2020-06-26 13:22:01.174763 (MainThread): Parsing macros/materializations/seed.sql
2020-06-26 13:22:01.178145 (MainThread): Parsing macros/materializations/view.sql
2020-06-26 13:22:01.181523 (MainThread): Parsing macros/materializations/table.sql
2020-06-26 13:22:01.195022 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-26 13:22:01.211352 (MainThread): Parsing macros/materializations/snapshot.sql
2020-06-26 13:22:01.236025 (MainThread): Partial parsing not enabled
2020-06-26 13:22:01.280674 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-06-26 13:22:01.280852 (MainThread): Opening a new connection, currently in state init
2020-06-26 13:22:01.393386 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e9350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107120090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070f1f10>]}
2020-06-26 13:22:01.393698 (MainThread): Flushing usage events
2020-06-26 13:22:01.897758 (MainThread): Connection 'model.springml_demo_dbt_project.payments' was properly closed.
2020-06-26 13:22:01.898025 (MainThread): Encountered an error:
2020-06-26 13:22:01.898219 (MainThread): Compilation Error in model payments (models/base/payments.sql)
  Model 'model.springml_demo_dbt_project.payments' (models/base/payments.sql) depends on a source named 'springml_demo_dataset.sales' which was not found
2020-06-26 13:22:01.907941 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 212, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.7/site-packages/dbt/task/runnable.py", line 389, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.7/site-packages/dbt/task/runnable.py", line 103, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.7/site-packages/dbt/task/runnable.py", line 71, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.7/site-packages/dbt/task/runnable.py", line 60, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.7/site-packages/dbt/perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 641, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 358, in load_all
    manifest = loader.create_manifest()
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 334, in create_manifest
    self.process_manifest(manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 305, in process_manifest
    process_sources(manifest, project_name)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 600, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 587, in _process_sources_for_node
    disabled=(isinstance(target_source, Disabled))
  File "/usr/local/lib/python3.7/site-packages/dbt/utils.py", line 337, in invalid_source_fail_unless_test
    disabled=disabled
  File "/usr/local/lib/python3.7/site-packages/dbt/exceptions.py", line 554, in source_target_not_found
    raise_compiler_error(msg, model)
  File "/usr/local/lib/python3.7/site-packages/dbt/exceptions.py", line 392, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model payments (models/base/payments.sql)
  Model 'model.springml_demo_dbt_project.payments' (models/base/payments.sql) depends on a source named 'springml_demo_dataset.sales' which was not found

2020-06-26 13:28:11.454002 (MainThread): Running with dbt=0.17.0
2020-06-26 13:28:12.081155 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-26 13:28:12.083143 (MainThread): Tracking: tracking
2020-06-26 13:28:12.104122 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107260e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107276590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107276390>]}
2020-06-26 13:28:12.185497 (MainThread): Partial parsing not enabled
2020-06-26 13:28:12.189476 (MainThread): Parsing macros/core.sql
2020-06-26 13:28:12.197149 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-26 13:28:12.212747 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-26 13:28:12.216265 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-26 13:28:12.248911 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-26 13:28:12.298508 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-26 13:28:12.331238 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-26 13:28:12.338733 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-26 13:28:12.358537 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-26 13:28:12.397407 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-26 13:28:12.420068 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-26 13:28:12.436939 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-26 13:28:12.452463 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-26 13:28:12.457595 (MainThread): Parsing macros/etc/query.sql
2020-06-26 13:28:12.461272 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-26 13:28:12.465376 (MainThread): Parsing macros/etc/datetime.sql
2020-06-26 13:28:12.482723 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-26 13:28:12.490014 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-26 13:28:12.496592 (MainThread): Parsing macros/adapters/common.sql
2020-06-26 13:28:12.563503 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-26 13:28:12.565588 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-26 13:28:12.567451 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-26 13:28:12.570016 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-26 13:28:12.574501 (MainThread): Parsing macros/etc.sql
2020-06-26 13:28:12.576032 (MainThread): Parsing macros/catalog.sql
2020-06-26 13:28:12.584093 (MainThread): Parsing macros/adapters.sql
2020-06-26 13:28:12.604360 (MainThread): Parsing macros/materializations/seed.sql
2020-06-26 13:28:12.607113 (MainThread): Parsing macros/materializations/view.sql
2020-06-26 13:28:12.609997 (MainThread): Parsing macros/materializations/table.sql
2020-06-26 13:28:12.622616 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-26 13:28:12.638720 (MainThread): Parsing macros/materializations/snapshot.sql
2020-06-26 13:28:12.663598 (MainThread): Partial parsing not enabled
2020-06-26 13:28:12.704936 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-06-26 13:28:12.705073 (MainThread): Opening a new connection, currently in state init
2020-06-26 13:28:12.916504 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 1 seed file, 1 source
2020-06-26 13:28:12.917190 (MainThread): 
2020-06-26 13:28:12.917576 (MainThread): Acquiring new bigquery connection "master".
2020-06-26 13:28:12.917686 (MainThread): Opening a new connection, currently in state closed
2020-06-26 13:28:12.921771 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-06-26 13:28:12.922070 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-26 13:28:12.925830 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-06-26 13:28:15.622786 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-06-26 13:28:15.623104 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-06-26 13:28:15.623316 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-06-26 13:28:15.794775 (MainThread): Acquiring new bigquery connection "master".
2020-06-26 13:28:15.794969 (MainThread): Opening a new connection, currently in state closed
2020-06-26 13:28:15.795346 (MainThread): 09:28:15 | Concurrency: 1 threads (target='dev')
2020-06-26 13:28:15.795544 (MainThread): 09:28:15 | 
2020-06-26 13:28:15.799492 (Thread-1): Began running node model.springml_demo_dbt_project.payments
2020-06-26 13:28:15.802417 (Thread-1): 09:28:15 | 1 of 1 START view model springml_demo_dataset.payments............... [RUN]
2020-06-26 13:28:15.802888 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-06-26 13:28:15.803023 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-06-26 13:28:15.803178 (Thread-1): Compiling model.springml_demo_dbt_project.payments
2020-06-26 13:28:15.824411 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.payments"
2020-06-26 13:28:15.825189 (Thread-1): finished collecting timing info
2020-06-26 13:28:15.862915 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.payments"
2020-06-26 13:28:15.863628 (Thread-1): On model.springml_demo_dbt_project.payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
  OPTIONS()
  as select payment_type, 
    count(*) as number_of_payments, 
    sum(price) as total_price 
from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where country like "United States"
group by payment_type;


2020-06-26 13:28:17.126772 (Thread-1): finished collecting timing info
2020-06-26 13:28:17.127588 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '183765e8-0708-4f17-9722-3d7807a4f531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074577d0>]}
2020-06-26 13:28:17.128847 (Thread-1): 09:28:17 | 1 of 1 OK created view model springml_demo_dataset.payments.......... [CREATE VIEW in 1.32s]
2020-06-26 13:28:17.129012 (Thread-1): Finished running node model.springml_demo_dbt_project.payments
2020-06-26 13:28:17.142468 (MainThread): Acquiring new bigquery connection "master".
2020-06-26 13:28:17.142709 (MainThread): Opening a new connection, currently in state closed
2020-06-26 13:28:17.143151 (MainThread): 09:28:17 | 
2020-06-26 13:28:17.143365 (MainThread): 09:28:17 | Finished running 1 view model in 4.23s.
2020-06-26 13:28:17.143567 (MainThread): Connection 'master' was properly closed.
2020-06-26 13:28:17.143723 (MainThread): Connection 'model.springml_demo_dbt_project.payments' was left open.
2020-06-26 13:28:17.149352 (MainThread): 
2020-06-26 13:28:17.149552 (MainThread): Completed successfully
2020-06-26 13:28:17.149737 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-06-26 13:28:17.150053 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10761d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10761db50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072e3c90>]}
2020-06-26 13:28:17.150308 (MainThread): Flushing usage events
2020-06-26 15:08:10.306900 (MainThread): Running with dbt=0.17.0
2020-06-26 15:08:10.879639 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-26 15:08:10.881277 (MainThread): Tracking: tracking
2020-06-26 15:08:10.899054 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdf0b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be06410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be06210>]}
2020-06-26 15:08:10.955926 (MainThread): Partial parsing not enabled
2020-06-26 15:08:10.959770 (MainThread): Parsing macros/core.sql
2020-06-26 15:08:10.968954 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-26 15:08:10.981535 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-26 15:08:10.984830 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-26 15:08:11.007970 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-26 15:08:11.045203 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-26 15:08:11.070902 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-26 15:08:11.073938 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-26 15:08:11.082305 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-26 15:08:11.099524 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-26 15:08:11.110765 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-26 15:08:11.119143 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-26 15:08:11.126483 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-26 15:08:11.128351 (MainThread): Parsing macros/etc/query.sql
2020-06-26 15:08:11.129934 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-26 15:08:11.132140 (MainThread): Parsing macros/etc/datetime.sql
2020-06-26 15:08:11.143339 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-26 15:08:11.146637 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-26 15:08:11.149205 (MainThread): Parsing macros/adapters/common.sql
2020-06-26 15:08:11.207924 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-26 15:08:11.209773 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-26 15:08:11.211315 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-26 15:08:11.213198 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-26 15:08:11.216472 (MainThread): Parsing macros/etc.sql
2020-06-26 15:08:11.217871 (MainThread): Parsing macros/catalog.sql
2020-06-26 15:08:11.225458 (MainThread): Parsing macros/adapters.sql
2020-06-26 15:08:11.245190 (MainThread): Parsing macros/materializations/seed.sql
2020-06-26 15:08:11.248101 (MainThread): Parsing macros/materializations/view.sql
2020-06-26 15:08:11.251055 (MainThread): Parsing macros/materializations/table.sql
2020-06-26 15:08:11.263814 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-26 15:08:11.279688 (MainThread): Parsing macros/materializations/snapshot.sql
2020-06-26 15:08:11.304574 (MainThread): Partial parsing not enabled
2020-06-26 15:08:11.347615 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-06-26 15:08:11.347790 (MainThread): Opening a new connection, currently in state init
2020-06-26 15:08:11.559438 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 1 seed file, 1 source
2020-06-26 15:08:11.560094 (MainThread): 
2020-06-26 15:08:11.560499 (MainThread): Acquiring new bigquery connection "master".
2020-06-26 15:08:11.560605 (MainThread): Opening a new connection, currently in state closed
2020-06-26 15:08:11.562915 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-06-26 15:08:11.563171 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-26 15:08:11.565367 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-06-26 15:08:14.729022 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-06-26 15:08:14.729347 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-06-26 15:08:14.729569 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-06-26 15:08:14.860224 (MainThread): Acquiring new bigquery connection "master".
2020-06-26 15:08:14.860419 (MainThread): Opening a new connection, currently in state closed
2020-06-26 15:08:14.860833 (MainThread): 11:08:14 | Concurrency: 1 threads (target='dev')
2020-06-26 15:08:14.861034 (MainThread): 11:08:14 | 
2020-06-26 15:08:14.863823 (Thread-1): Began running node model.springml_demo_dbt_project.payments
2020-06-26 15:08:14.866758 (Thread-1): 11:08:14 | 1 of 1 START view model springml_demo_dataset.payments............... [RUN]
2020-06-26 15:08:14.867250 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-06-26 15:08:14.867403 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-06-26 15:08:14.867572 (Thread-1): Compiling model.springml_demo_dbt_project.payments
2020-06-26 15:08:14.888734 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.payments"
2020-06-26 15:08:14.889505 (Thread-1): finished collecting timing info
2020-06-26 15:08:14.927414 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.payments"
2020-06-26 15:08:14.928195 (Thread-1): On model.springml_demo_dbt_project.payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
  OPTIONS()
  as select payment_type, 
    count(*) as number_of_payments, 
    sum(price) as total_price 
from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where country like "United States"
group by payment_type;


2020-06-26 15:08:15.716288 (Thread-1): finished collecting timing info
2020-06-26 15:08:15.717100 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55ccf017-570c-412c-8258-393687fb4711', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be7f510>]}
2020-06-26 15:08:15.718268 (Thread-1): 11:08:15 | 1 of 1 OK created view model springml_demo_dataset.payments.......... [CREATE VIEW in 0.85s]
2020-06-26 15:08:15.718421 (Thread-1): Finished running node model.springml_demo_dbt_project.payments
2020-06-26 15:08:15.781557 (MainThread): Acquiring new bigquery connection "master".
2020-06-26 15:08:15.781849 (MainThread): Opening a new connection, currently in state closed
2020-06-26 15:08:15.782327 (MainThread): 11:08:15 | 
2020-06-26 15:08:15.782545 (MainThread): 11:08:15 | Finished running 1 view model in 4.22s.
2020-06-26 15:08:15.782783 (MainThread): Connection 'master' was properly closed.
2020-06-26 15:08:15.783050 (MainThread): Connection 'model.springml_demo_dbt_project.payments' was left open.
2020-06-26 15:08:15.789213 (MainThread): 
2020-06-26 15:08:15.789458 (MainThread): Completed successfully
2020-06-26 15:08:15.789710 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-06-26 15:08:15.790050 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfc1810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2d2ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2d2490>]}
2020-06-26 15:08:15.790291 (MainThread): Flushing usage events
2020-06-26 15:34:47.320176 (MainThread): Running with dbt=0.17.0
2020-06-26 15:34:47.877170 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-26 15:34:47.878521 (MainThread): Tracking: tracking
2020-06-26 15:34:47.928762 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134eced0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f23a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113503310>]}
2020-06-26 15:34:47.983500 (MainThread): Partial parsing not enabled
2020-06-26 15:34:47.987075 (MainThread): Parsing macros/core.sql
2020-06-26 15:34:47.994276 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-26 15:34:48.006060 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-26 15:34:48.009207 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-26 15:34:48.031628 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-26 15:34:48.071192 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-26 15:34:48.097248 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-26 15:34:48.100631 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-26 15:34:48.109208 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-26 15:34:48.126370 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-26 15:34:48.136457 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-26 15:34:48.144836 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-26 15:34:48.152266 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-26 15:34:48.154119 (MainThread): Parsing macros/etc/query.sql
2020-06-26 15:34:48.156324 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-26 15:34:48.159280 (MainThread): Parsing macros/etc/datetime.sql
2020-06-26 15:34:48.170706 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-26 15:34:48.173830 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-26 15:34:48.176529 (MainThread): Parsing macros/adapters/common.sql
2020-06-26 15:34:48.234564 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-26 15:34:48.237766 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-26 15:34:48.240344 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-26 15:34:48.242986 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-26 15:34:48.247501 (MainThread): Parsing macros/etc.sql
2020-06-26 15:34:48.249239 (MainThread): Parsing macros/catalog.sql
2020-06-26 15:34:48.258199 (MainThread): Parsing macros/adapters.sql
2020-06-26 15:34:48.277953 (MainThread): Parsing macros/materializations/seed.sql
2020-06-26 15:34:48.281067 (MainThread): Parsing macros/materializations/view.sql
2020-06-26 15:34:48.284431 (MainThread): Parsing macros/materializations/table.sql
2020-06-26 15:34:48.297810 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-26 15:34:48.317015 (MainThread): Parsing macros/materializations/snapshot.sql
2020-06-26 15:34:48.342714 (MainThread): Partial parsing not enabled
2020-06-26 15:34:48.384484 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-06-26 15:34:48.384664 (MainThread): Opening a new connection, currently in state init
2020-06-26 15:34:48.418500 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-06-26 15:34:48.418649 (MainThread): Opening a new connection, currently in state closed
2020-06-26 15:34:48.551854 (MainThread): WARNING: Found documentation for resource "creditcards" which was not found or is disabled
2020-06-26 15:34:48.618674 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 1 seed file, 1 source
2020-06-26 15:34:48.619433 (MainThread): 
2020-06-26 15:34:48.619907 (MainThread): Acquiring new bigquery connection "master".
2020-06-26 15:34:48.620011 (MainThread): Opening a new connection, currently in state closed
2020-06-26 15:34:48.624137 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-06-26 15:34:48.624424 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-26 15:34:48.627567 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-06-26 15:34:50.727322 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-06-26 15:34:50.727693 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-06-26 15:34:50.727913 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-06-26 15:34:50.884636 (MainThread): Acquiring new bigquery connection "master".
2020-06-26 15:34:50.884821 (MainThread): Opening a new connection, currently in state closed
2020-06-26 15:34:50.885191 (MainThread): 11:34:50 | Concurrency: 1 threads (target='dev')
2020-06-26 15:34:50.885388 (MainThread): 11:34:50 | 
2020-06-26 15:34:50.889605 (Thread-1): Began running node model.springml_demo_dbt_project.creditcard
2020-06-26 15:34:50.891163 (Thread-1): 11:34:50 | 1 of 2 START view model springml_demo_dataset.creditcard............. [RUN]
2020-06-26 15:34:50.891627 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-06-26 15:34:50.891770 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-06-26 15:34:50.891928 (Thread-1): Compiling model.springml_demo_dbt_project.creditcard
2020-06-26 15:34:50.911256 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.creditcard"
2020-06-26 15:34:50.911757 (Thread-1): finished collecting timing info
2020-06-26 15:34:50.950652 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.creditcard"
2020-06-26 15:34:50.951185 (Thread-1): On model.springml_demo_dbt_project.creditcard: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
  OPTIONS()
  as 

select country,

sum(case when payment_type = creditcard then 1 else 0 end) as Amex_payments,

sum(case when payment_type = creditcard then 1 else 0 end) as Mastercard_payments,

sum(case when payment_type = creditcard then 1 else 0 end) as Visa_payments,

from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
group by country;


2020-06-26 15:34:51.414617 (Thread-1): finished collecting timing info
2020-06-26 15:34:51.415670 (Thread-1): Database Error in model creditcard (models/base/creditcard.sql)
  Unrecognized name: creditcard at [10:30]
  compiled SQL at target/run/springml_demo_dbt_project/models/base/creditcard.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 84, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 225, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 352, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 122, in result
    self._blocking_poll(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3098, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 101, in _blocking_poll
    retry_(self._done_or_raise)()
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 80, in _done_or_raise
    if not self.done():
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3085, in done
    timeout=timeout,
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/client.py", line 1287, in _get_query_results
    retry, method="GET", path=path, query_params=extra_params, timeout=timeout
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/client.py", line 556, in _call_api
    return call()
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/google/cloud/_http.py", line 423, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/prismatic-cider-279015/queries/b6fe0b72-57f6-4e63-8d9d-dc978fedc4ea?maxResults=0&location=US: Unrecognized name: creditcard at [10:30]

(job ID: b6fe0b72-57f6-4e63-8d9d-dc978fedc4ea)

                                                               -----Query Job SQL Follows-----                                                               

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
   5:  OPTIONS()
   6:  as 
   7:
   8:select country,
   9:
  10:sum(case when payment_type = creditcard then 1 else 0 end) as Amex_payments,
  11:
  12:sum(case when payment_type = creditcard then 1 else 0 end) as Mastercard_payments,
  13:
  14:sum(case when payment_type = creditcard then 1 else 0 end) as Visa_payments,
  15:
  16:from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
  17:group by country;
  18:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 234, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 227, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/Cellar/python/3.7.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 88, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 76, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model creditcard (models/base/creditcard.sql)
  Unrecognized name: creditcard at [10:30]
  compiled SQL at target/run/springml_demo_dbt_project/models/base/creditcard.sql
2020-06-26 15:34:51.453680 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27fb4e69-7770-49ea-bce2-83d687404b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11384bb10>]}
2020-06-26 15:34:51.455707 (Thread-1): 11:34:51 | 1 of 2 ERROR creating view model springml_demo_dataset.creditcard.... [ERROR in 0.56s]
2020-06-26 15:34:51.455899 (Thread-1): Finished running node model.springml_demo_dbt_project.creditcard
2020-06-26 15:34:51.456109 (Thread-1): Began running node model.springml_demo_dbt_project.payments
2020-06-26 15:34:51.457697 (Thread-1): 11:34:51 | 2 of 2 START view model springml_demo_dataset.payments............... [RUN]
2020-06-26 15:34:51.458153 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-06-26 15:34:51.458295 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.creditcard).
2020-06-26 15:34:51.458425 (Thread-1): Compiling model.springml_demo_dbt_project.payments
2020-06-26 15:34:51.471427 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.payments"
2020-06-26 15:34:51.471886 (Thread-1): finished collecting timing info
2020-06-26 15:34:51.476132 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.payments"
2020-06-26 15:34:51.476592 (Thread-1): On model.springml_demo_dbt_project.payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
  OPTIONS()
  as select payment_type, 
    count(*) as number_of_payments, 
    sum(price) as total_price 
from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where country like "United States"
group by payment_type;


2020-06-26 15:34:52.126638 (Thread-1): finished collecting timing info
2020-06-26 15:34:52.127440 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27fb4e69-7770-49ea-bce2-83d687404b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11384bd50>]}
2020-06-26 15:34:52.128668 (Thread-1): 11:34:52 | 2 of 2 OK created view model springml_demo_dataset.payments.......... [CREATE VIEW in 0.67s]
2020-06-26 15:34:52.128833 (Thread-1): Finished running node model.springml_demo_dbt_project.payments
2020-06-26 15:34:52.225693 (MainThread): Acquiring new bigquery connection "master".
2020-06-26 15:34:52.225945 (MainThread): Opening a new connection, currently in state closed
2020-06-26 15:34:52.226437 (MainThread): 11:34:52 | 
2020-06-26 15:34:52.226677 (MainThread): 11:34:52 | Finished running 2 view models in 3.61s.
2020-06-26 15:34:52.226975 (MainThread): Connection 'master' was properly closed.
2020-06-26 15:34:52.227312 (MainThread): Connection 'model.springml_demo_dbt_project.payments' was left open.
2020-06-26 15:34:52.238715 (MainThread): 
2020-06-26 15:34:52.238923 (MainThread): Completed with 1 error and 0 warnings:
2020-06-26 15:34:52.239098 (MainThread): 
2020-06-26 15:34:52.239278 (MainThread): Database Error in model creditcard (models/base/creditcard.sql)
2020-06-26 15:34:52.239451 (MainThread):   Unrecognized name: creditcard at [10:30]
2020-06-26 15:34:52.239619 (MainThread):   compiled SQL at target/run/springml_demo_dbt_project/models/base/creditcard.sql
2020-06-26 15:34:52.239812 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2020-06-26 15:34:52.240120 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136d3c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136d3910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113984290>]}
2020-06-26 15:34:52.240344 (MainThread): Flushing usage events
2020-06-26 15:35:48.368109 (MainThread): Running with dbt=0.17.0
2020-06-26 15:35:48.886253 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-26 15:35:48.887663 (MainThread): Tracking: tracking
2020-06-26 15:35:48.901757 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc73c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4d3390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4d3190>]}
2020-06-26 15:35:48.956223 (MainThread): Partial parsing not enabled
2020-06-26 15:35:48.959080 (MainThread): Parsing macros/core.sql
2020-06-26 15:35:48.966721 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-26 15:35:48.976706 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-26 15:35:48.979499 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-26 15:35:49.002800 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-26 15:35:49.039981 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-26 15:35:49.066643 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-26 15:35:49.069878 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-26 15:35:49.078198 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-26 15:35:49.096898 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-26 15:35:49.105853 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-26 15:35:49.113974 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-26 15:35:49.120096 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-26 15:35:49.121609 (MainThread): Parsing macros/etc/query.sql
2020-06-26 15:35:49.123499 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-26 15:35:49.126187 (MainThread): Parsing macros/etc/datetime.sql
2020-06-26 15:35:49.137595 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-26 15:35:49.140448 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-26 15:35:49.143026 (MainThread): Parsing macros/adapters/common.sql
2020-06-26 15:35:49.201234 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-26 15:35:49.203779 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-26 15:35:49.205888 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-26 15:35:49.208005 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-26 15:35:49.211740 (MainThread): Parsing macros/etc.sql
2020-06-26 15:35:49.213038 (MainThread): Parsing macros/catalog.sql
2020-06-26 15:35:49.220825 (MainThread): Parsing macros/adapters.sql
2020-06-26 15:35:49.240432 (MainThread): Parsing macros/materializations/seed.sql
2020-06-26 15:35:49.243428 (MainThread): Parsing macros/materializations/view.sql
2020-06-26 15:35:49.246389 (MainThread): Parsing macros/materializations/table.sql
2020-06-26 15:35:49.259161 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-26 15:35:49.275253 (MainThread): Parsing macros/materializations/snapshot.sql
2020-06-26 15:35:49.300170 (MainThread): Partial parsing not enabled
2020-06-26 15:35:49.342156 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-06-26 15:35:49.342327 (MainThread): Opening a new connection, currently in state init
2020-06-26 15:35:49.374644 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-06-26 15:35:49.374811 (MainThread): Opening a new connection, currently in state closed
2020-06-26 15:35:49.504044 (MainThread): WARNING: Found documentation for resource "creditcards" which was not found or is disabled
2020-06-26 15:35:49.571279 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 1 seed file, 1 source
2020-06-26 15:35:49.571964 (MainThread): 
2020-06-26 15:35:49.572323 (MainThread): Acquiring new bigquery connection "master".
2020-06-26 15:35:49.572416 (MainThread): Opening a new connection, currently in state closed
2020-06-26 15:35:49.576536 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-06-26 15:35:49.576818 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-26 15:35:49.579365 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-06-26 15:35:51.395295 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-06-26 15:35:51.395620 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-06-26 15:35:51.395838 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-06-26 15:35:51.540939 (MainThread): Acquiring new bigquery connection "master".
2020-06-26 15:35:51.541151 (MainThread): Opening a new connection, currently in state closed
2020-06-26 15:35:51.541544 (MainThread): 11:35:51 | Concurrency: 1 threads (target='dev')
2020-06-26 15:35:51.541758 (MainThread): 11:35:51 | 
2020-06-26 15:35:51.544895 (Thread-1): Began running node model.springml_demo_dbt_project.creditcard
2020-06-26 15:35:51.546464 (Thread-1): 11:35:51 | 1 of 2 START view model springml_demo_dataset.creditcard............. [RUN]
2020-06-26 15:35:51.546889 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-06-26 15:35:51.546996 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-06-26 15:35:51.547122 (Thread-1): Compiling model.springml_demo_dbt_project.creditcard
2020-06-26 15:35:51.567996 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.creditcard"
2020-06-26 15:35:51.568495 (Thread-1): finished collecting timing info
2020-06-26 15:35:51.605843 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.creditcard"
2020-06-26 15:35:51.606359 (Thread-1): On model.springml_demo_dbt_project.creditcard: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
  OPTIONS()
  as 

select country,

sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,

sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,

sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,

from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
group by country;


2020-06-26 15:35:52.158094 (Thread-1): finished collecting timing info
2020-06-26 15:35:52.158919 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bbb4cd6-30f1-4a28-8fa9-b527092fdc75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7ffc50>]}
2020-06-26 15:35:52.160184 (Thread-1): 11:35:52 | 1 of 2 OK created view model springml_demo_dataset.creditcard........ [CREATE VIEW in 0.61s]
2020-06-26 15:35:52.160343 (Thread-1): Finished running node model.springml_demo_dbt_project.creditcard
2020-06-26 15:35:52.160552 (Thread-1): Began running node model.springml_demo_dbt_project.payments
2020-06-26 15:35:52.161823 (Thread-1): 11:35:52 | 2 of 2 START view model springml_demo_dataset.payments............... [RUN]
2020-06-26 15:35:52.162179 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-06-26 15:35:52.162282 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.creditcard).
2020-06-26 15:35:52.162384 (Thread-1): Compiling model.springml_demo_dbt_project.payments
2020-06-26 15:35:52.173370 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.payments"
2020-06-26 15:35:52.173874 (Thread-1): finished collecting timing info
2020-06-26 15:35:52.178214 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.payments"
2020-06-26 15:35:52.178670 (Thread-1): On model.springml_demo_dbt_project.payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
  OPTIONS()
  as select payment_type, 
    count(*) as number_of_payments, 
    sum(price) as total_price 
from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where country like "United States"
group by payment_type;


2020-06-26 15:35:52.937028 (Thread-1): finished collecting timing info
2020-06-26 15:35:52.937992 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bbb4cd6-30f1-4a28-8fa9-b527092fdc75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8a4d10>]}
2020-06-26 15:35:52.939544 (Thread-1): 11:35:52 | 2 of 2 OK created view model springml_demo_dataset.payments.......... [CREATE VIEW in 0.78s]
2020-06-26 15:35:52.939784 (Thread-1): Finished running node model.springml_demo_dbt_project.payments
2020-06-26 15:35:52.999536 (MainThread): Acquiring new bigquery connection "master".
2020-06-26 15:35:52.999802 (MainThread): Opening a new connection, currently in state closed
2020-06-26 15:35:53.000319 (MainThread): 11:35:53 | 
2020-06-26 15:35:53.000562 (MainThread): 11:35:53 | Finished running 2 view models in 3.43s.
2020-06-26 15:35:53.000796 (MainThread): Connection 'master' was properly closed.
2020-06-26 15:35:53.000991 (MainThread): Connection 'model.springml_demo_dbt_project.payments' was left open.
2020-06-26 15:35:53.010927 (MainThread): 
2020-06-26 15:35:53.011143 (MainThread): Completed successfully
2020-06-26 15:35:53.011360 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-06-26 15:35:53.011698 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c675a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c683250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c69f090>]}
2020-06-26 15:35:53.011960 (MainThread): Flushing usage events
2020-06-26 15:37:23.233831 (MainThread): Running with dbt=0.17.0
2020-06-26 15:37:23.871712 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-26 15:37:23.873247 (MainThread): Tracking: tracking
2020-06-26 15:37:23.904826 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110638810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11064f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11064f2d0>]}
2020-06-26 15:37:23.958736 (MainThread): Partial parsing not enabled
2020-06-26 15:37:23.962202 (MainThread): Parsing macros/core.sql
2020-06-26 15:37:23.969568 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-26 15:37:23.981370 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-26 15:37:23.984426 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-26 15:37:24.007177 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-26 15:37:24.043929 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-26 15:37:24.070806 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-26 15:37:24.074197 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-26 15:37:24.084676 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-26 15:37:24.102978 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-26 15:37:24.112326 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-26 15:37:24.120762 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-26 15:37:24.127768 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-26 15:37:24.129452 (MainThread): Parsing macros/etc/query.sql
2020-06-26 15:37:24.131577 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-26 15:37:24.134330 (MainThread): Parsing macros/etc/datetime.sql
2020-06-26 15:37:24.145756 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-26 15:37:24.148891 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-26 15:37:24.151847 (MainThread): Parsing macros/adapters/common.sql
2020-06-26 15:37:24.211291 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-26 15:37:24.213410 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-26 15:37:24.215439 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-26 15:37:24.217752 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-26 15:37:24.221410 (MainThread): Parsing macros/etc.sql
2020-06-26 15:37:24.223205 (MainThread): Parsing macros/catalog.sql
2020-06-26 15:37:24.231357 (MainThread): Parsing macros/adapters.sql
2020-06-26 15:37:24.251051 (MainThread): Parsing macros/materializations/seed.sql
2020-06-26 15:37:24.254107 (MainThread): Parsing macros/materializations/view.sql
2020-06-26 15:37:24.257281 (MainThread): Parsing macros/materializations/table.sql
2020-06-26 15:37:24.270376 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-26 15:37:24.287808 (MainThread): Parsing macros/materializations/snapshot.sql
2020-06-26 15:37:24.312417 (MainThread): Partial parsing not enabled
2020-06-26 15:37:24.355150 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-06-26 15:37:24.355326 (MainThread): Opening a new connection, currently in state init
2020-06-26 15:37:24.390711 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-06-26 15:37:24.390878 (MainThread): Opening a new connection, currently in state closed
2020-06-26 15:37:24.528187 (MainThread): WARNING: Found documentation for resource "creditcards" which was not found or is disabled
2020-06-26 15:37:24.596743 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 1 seed file, 1 source
2020-06-26 15:37:24.597501 (MainThread): 
2020-06-26 15:37:24.597980 (MainThread): Acquiring new bigquery connection "master".
2020-06-26 15:37:24.598093 (MainThread): Opening a new connection, currently in state closed
2020-06-26 15:37:24.602188 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-06-26 15:37:24.602350 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-26 15:37:24.606008 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-06-26 15:37:26.534760 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-06-26 15:37:26.535096 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-06-26 15:37:26.537599 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-06-26 15:37:26.672360 (MainThread): Acquiring new bigquery connection "master".
2020-06-26 15:37:26.672573 (MainThread): Opening a new connection, currently in state closed
2020-06-26 15:37:26.672974 (MainThread): 11:37:26 | Concurrency: 1 threads (target='dev')
2020-06-26 15:37:26.673176 (MainThread): 11:37:26 | 
2020-06-26 15:37:26.677138 (Thread-1): Began running node model.springml_demo_dbt_project.creditcard
2020-06-26 15:37:26.678714 (Thread-1): 11:37:26 | 1 of 2 START view model springml_demo_dataset.creditcard............. [RUN]
2020-06-26 15:37:26.679234 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-06-26 15:37:26.679348 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-06-26 15:37:26.679475 (Thread-1): Compiling model.springml_demo_dbt_project.creditcard
2020-06-26 15:37:26.699021 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.creditcard"
2020-06-26 15:37:26.700200 (Thread-1): finished collecting timing info
2020-06-26 15:37:26.738075 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.creditcard"
2020-06-26 15:37:26.738649 (Thread-1): On model.springml_demo_dbt_project.creditcard: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
  OPTIONS()
  as 

select country,

sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,

sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,

sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,

from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
group by country 
order by (Amex_payments+Mastercard_payments+Visa_payments) desc;


2020-06-26 15:37:27.624166 (Thread-1): finished collecting timing info
2020-06-26 15:37:27.625007 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9511ffe1-4254-49d0-9fa5-d8ba66cd5751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110950f50>]}
2020-06-26 15:37:27.626284 (Thread-1): 11:37:27 | 1 of 2 OK created view model springml_demo_dataset.creditcard........ [CREATE VIEW in 0.95s]
2020-06-26 15:37:27.626454 (Thread-1): Finished running node model.springml_demo_dbt_project.creditcard
2020-06-26 15:37:27.626674 (Thread-1): Began running node model.springml_demo_dbt_project.payments
2020-06-26 15:37:27.627831 (Thread-1): 11:37:27 | 2 of 2 START view model springml_demo_dataset.payments............... [RUN]
2020-06-26 15:37:27.628180 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-06-26 15:37:27.628290 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.creditcard).
2020-06-26 15:37:27.628400 (Thread-1): Compiling model.springml_demo_dbt_project.payments
2020-06-26 15:37:27.639271 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.payments"
2020-06-26 15:37:27.639768 (Thread-1): finished collecting timing info
2020-06-26 15:37:27.644092 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.payments"
2020-06-26 15:37:27.644574 (Thread-1): On model.springml_demo_dbt_project.payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
  OPTIONS()
  as select payment_type, 
    count(*) as number_of_payments, 
    sum(price) as total_price 
from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where country like "United States"
group by payment_type;


2020-06-26 15:37:28.227375 (Thread-1): finished collecting timing info
2020-06-26 15:37:28.228266 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9511ffe1-4254-49d0-9fa5-d8ba66cd5751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11082cf10>]}
2020-06-26 15:37:28.229856 (Thread-1): 11:37:28 | 2 of 2 OK created view model springml_demo_dataset.payments.......... [CREATE VIEW in 0.60s]
2020-06-26 15:37:28.230062 (Thread-1): Finished running node model.springml_demo_dbt_project.payments
2020-06-26 15:37:28.311586 (MainThread): Acquiring new bigquery connection "master".
2020-06-26 15:37:28.311904 (MainThread): Opening a new connection, currently in state closed
2020-06-26 15:37:28.312633 (MainThread): 11:37:28 | 
2020-06-26 15:37:28.312856 (MainThread): 11:37:28 | Finished running 2 view models in 3.71s.
2020-06-26 15:37:28.313061 (MainThread): Connection 'master' was properly closed.
2020-06-26 15:37:28.313214 (MainThread): Connection 'model.springml_demo_dbt_project.payments' was left open.
2020-06-26 15:37:28.324213 (MainThread): 
2020-06-26 15:37:28.324634 (MainThread): Completed successfully
2020-06-26 15:37:28.324921 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-06-26 15:37:28.325319 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109cde10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a79610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a79b10>]}
2020-06-26 15:37:28.325663 (MainThread): Flushing usage events
2020-06-26 16:03:06.527775 (MainThread): Running with dbt=0.17.0
2020-06-26 16:03:07.144932 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-06-26 16:03:07.150813 (MainThread): Tracking: tracking
2020-06-26 16:03:07.176025 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae2afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b65f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b65f350>]}
2020-06-26 16:03:07.243905 (MainThread): Partial parsing not enabled
2020-06-26 16:03:07.255292 (MainThread): Parsing macros/core.sql
2020-06-26 16:03:07.263613 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-26 16:03:07.275567 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-26 16:03:07.278536 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-26 16:03:07.301233 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-26 16:03:07.347695 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-26 16:03:07.374905 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-26 16:03:07.378195 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-26 16:03:07.388031 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-26 16:03:07.406639 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-26 16:03:07.416606 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-26 16:03:07.425526 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-26 16:03:07.432945 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-26 16:03:07.435521 (MainThread): Parsing macros/etc/query.sql
2020-06-26 16:03:07.437721 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-26 16:03:07.446852 (MainThread): Parsing macros/etc/datetime.sql
2020-06-26 16:03:07.462133 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-26 16:03:07.465250 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-26 16:03:07.468949 (MainThread): Parsing macros/adapters/common.sql
2020-06-26 16:03:07.540752 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-26 16:03:07.543253 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-26 16:03:07.545115 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-26 16:03:07.547627 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-26 16:03:07.552873 (MainThread): Parsing macros/etc.sql
2020-06-26 16:03:07.554829 (MainThread): Parsing macros/catalog.sql
2020-06-26 16:03:07.567725 (MainThread): Parsing macros/adapters.sql
2020-06-26 16:03:07.602340 (MainThread): Parsing macros/materializations/seed.sql
2020-06-26 16:03:07.606126 (MainThread): Parsing macros/materializations/view.sql
2020-06-26 16:03:07.610033 (MainThread): Parsing macros/materializations/table.sql
2020-06-26 16:03:07.627133 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-26 16:03:07.646462 (MainThread): Parsing macros/materializations/snapshot.sql
2020-06-26 16:03:07.674641 (MainThread): Partial parsing not enabled
2020-06-26 16:03:07.722453 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-06-26 16:03:07.722610 (MainThread): Opening a new connection, currently in state init
2020-06-26 16:03:07.759995 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-06-26 16:03:07.760164 (MainThread): Opening a new connection, currently in state closed
2020-06-26 16:03:07.897529 (MainThread): WARNING: Found documentation for resource "creditcards" which was not found or is disabled
2020-06-26 16:03:07.976233 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 1 seed file, 1 source
2020-06-26 16:03:07.977301 (MainThread): 
2020-06-26 16:03:07.977849 (MainThread): Acquiring new bigquery connection "master".
2020-06-26 16:03:07.977995 (MainThread): Opening a new connection, currently in state closed
2020-06-26 16:03:07.984997 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-06-26 16:03:07.985282 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-26 16:03:07.988719 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-06-26 16:03:10.930979 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-06-26 16:03:10.931357 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-06-26 16:03:10.931566 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-06-26 16:03:11.068460 (MainThread): 12:03:11 | Concurrency: 1 threads (target='dev')
2020-06-26 16:03:11.068718 (MainThread): 12:03:11 | 
2020-06-26 16:03:11.072273 (Thread-1): Began running node model.springml_demo_dbt_project.creditcard
2020-06-26 16:03:11.072786 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-06-26 16:03:11.072925 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-06-26 16:03:11.073097 (Thread-1): Compiling model.springml_demo_dbt_project.creditcard
2020-06-26 16:03:11.093222 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.creditcard"
2020-06-26 16:03:11.095186 (Thread-1): finished collecting timing info
2020-06-26 16:03:11.095710 (Thread-1): finished collecting timing info
2020-06-26 16:03:11.096282 (Thread-1): Finished running node model.springml_demo_dbt_project.creditcard
2020-06-26 16:03:11.096451 (Thread-1): Began running node model.springml_demo_dbt_project.payments
2020-06-26 16:03:11.096753 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-06-26 16:03:11.096862 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.creditcard).
2020-06-26 16:03:11.096962 (Thread-1): Compiling model.springml_demo_dbt_project.payments
2020-06-26 16:03:11.111881 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.payments"
2020-06-26 16:03:11.112346 (Thread-1): finished collecting timing info
2020-06-26 16:03:11.112606 (Thread-1): finished collecting timing info
2020-06-26 16:03:11.113013 (Thread-1): Finished running node model.springml_demo_dbt_project.payments
2020-06-26 16:03:11.113150 (Thread-1): Began running node seed.springml_demo_dbt_project.datafile_sales
2020-06-26 16:03:11.113410 (Thread-1): Acquiring new bigquery connection "seed.springml_demo_dbt_project.datafile_sales".
2020-06-26 16:03:11.113499 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.payments).
2020-06-26 16:03:11.113671 (Thread-1): Compiling seed.springml_demo_dbt_project.datafile_sales
2020-06-26 16:03:11.125907 (Thread-1): finished collecting timing info
2020-06-26 16:03:11.126413 (Thread-1): finished collecting timing info
2020-06-26 16:03:11.126950 (Thread-1): Finished running node seed.springml_demo_dbt_project.datafile_sales
2020-06-26 16:03:11.173347 (MainThread): Connection 'master' was properly closed.
2020-06-26 16:03:11.173760 (MainThread): Connection 'seed.springml_demo_dbt_project.datafile_sales' was left open.
2020-06-26 16:03:11.189412 (MainThread): 12:03:11 | Done.
2020-06-26 16:03:11.219754 (MainThread): Acquiring new bigquery connection "generate_catalog".
2020-06-26 16:03:11.220042 (MainThread): Opening a new connection, currently in state init
2020-06-26 16:03:11.220208 (MainThread): 12:03:11 | Building catalog
2020-06-26 16:03:11.231700 (MainThread): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-06-26 16:03:12.108763 (ThreadPoolExecutor-2_0): Acquiring new bigquery connection "prismatic-cider-279015.information_schema".
2020-06-26 16:03:12.109234 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state init
2020-06-26 16:03:12.129720 (ThreadPoolExecutor-2_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-06-26 16:03:12.695021 (ThreadPoolExecutor-2_0): On prismatic-cider-279015.information_schema: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "connection_name": "prismatic-cider-279015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `prismatic-cider-279015`.`springml_demo_dataset`.__TABLES__
        where (upper(dataset_id) = upper('springml_demo_dataset'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,
            cast(null as string) as column_comment,

            is_partitioning_column,
            clustering_ordinal_position

        from `prismatic-cider-279015`.`springml_demo_dataset`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name

        from `prismatic-cider-279015`.`springml_demo_dataset`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS
        where data_type not like 'STRUCT%'

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2020-06-26 16:03:20.970503 (MainThread): 12:03:20 | Catalog written to /Users/medhapatil/springml/springml_demo_dbt/target/catalog.json
2020-06-26 16:03:20.971101 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb2a050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb2a0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb2a150>]}
2020-06-26 16:03:20.971445 (MainThread): Flushing usage events
2020-06-26 16:03:21.394367 (MainThread): Connection 'generate_catalog' was left open.
2020-06-26 16:03:21.394575 (MainThread): Connection 'prismatic-cider-279015.information_schema' was left open.
2020-06-26 16:03:28.309935 (MainThread): Running with dbt=0.17.0
2020-06-26 16:03:28.836402 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8001, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-06-26 16:03:28.837378 (MainThread): Tracking: tracking
2020-06-26 16:03:28.851057 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5bdb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5d2510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5d2310>]}
2020-06-26 16:03:28.855072 (MainThread): Serving docs at 0.0.0.0:8001
2020-06-26 16:03:28.855383 (MainThread): To access from your browser, navigate to:  http://localhost:8001
2020-06-26 16:03:28.855512 (MainThread): Press Ctrl+C to exit.


2020-06-26 16:21:56.199844 (MainThread): Flushing usage events
2020-06-26 16:21:56.670099 (MainThread): ctrl-c
2020-07-07 13:46:59.953627 (MainThread): Running with dbt=0.17.0
2020-07-07 13:47:00.922225 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-07 13:47:00.946728 (MainThread): Tracking: tracking
2020-07-07 13:47:00.993231 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa5c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa60ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa60cd0>]}
2020-07-07 13:47:01.055528 (MainThread): Partial parsing not enabled
2020-07-07 13:47:01.058432 (MainThread): Parsing macros/core.sql
2020-07-07 13:47:01.067962 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-07 13:47:01.078513 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-07 13:47:01.081507 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-07 13:47:01.107307 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-07 13:47:01.147097 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-07 13:47:01.175321 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-07 13:47:01.178551 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-07 13:47:01.187843 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-07 13:47:01.206242 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-07 13:47:01.215524 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-07 13:47:01.223811 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-07 13:47:01.231578 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-07 13:47:01.233191 (MainThread): Parsing macros/etc/query.sql
2020-07-07 13:47:01.235182 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-07 13:47:01.237777 (MainThread): Parsing macros/etc/datetime.sql
2020-07-07 13:47:01.249931 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-07 13:47:01.252635 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-07 13:47:01.255019 (MainThread): Parsing macros/adapters/common.sql
2020-07-07 13:47:01.317446 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-07 13:47:01.319166 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-07 13:47:01.320755 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-07 13:47:01.322513 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-07 13:47:01.326184 (MainThread): Parsing macros/etc.sql
2020-07-07 13:47:01.327573 (MainThread): Parsing macros/catalog.sql
2020-07-07 13:47:01.336289 (MainThread): Parsing macros/adapters.sql
2020-07-07 13:47:01.356835 (MainThread): Parsing macros/materializations/seed.sql
2020-07-07 13:47:01.359662 (MainThread): Parsing macros/materializations/view.sql
2020-07-07 13:47:01.363031 (MainThread): Parsing macros/materializations/table.sql
2020-07-07 13:47:01.376456 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-07 13:47:01.394148 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-07 13:47:01.428315 (MainThread): Partial parsing not enabled
2020-07-07 13:47:01.505659 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-07 13:47:01.505815 (MainThread): Opening a new connection, currently in state init
2020-07-07 13:47:01.548372 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-07 13:47:01.548554 (MainThread): Opening a new connection, currently in state closed
2020-07-07 13:47:01.711587 (MainThread): WARNING: Found documentation for resource "creditcards" which was not found or is disabled
2020-07-07 13:47:01.799750 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 1 seed file, 1 source
2020-07-07 13:47:01.800494 (MainThread): 
2020-07-07 13:47:01.800892 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 13:47:01.800990 (MainThread): Opening a new connection, currently in state closed
2020-07-07 13:47:01.804540 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-07 13:47:01.804730 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-07 13:47:01.808697 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-07 13:47:05.495974 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-07 13:47:05.496315 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-07 13:47:05.496506 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-07 13:47:05.701048 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 13:47:05.701282 (MainThread): Opening a new connection, currently in state closed
2020-07-07 13:47:05.701828 (MainThread): 09:47:05 | Concurrency: 1 threads (target='dev')
2020-07-07 13:47:05.702071 (MainThread): 09:47:05 | 
2020-07-07 13:47:05.706266 (Thread-1): Began running node model.springml_demo_dbt_project.creditcard
2020-07-07 13:47:05.708152 (Thread-1): 09:47:05 | 1 of 2 START view model springml_demo_dataset.creditcard............. [RUN]
2020-07-07 13:47:05.708641 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-07 13:47:05.708764 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-07 13:47:05.708890 (Thread-1): Compiling model.springml_demo_dbt_project.creditcard
2020-07-07 13:47:05.731289 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-07 13:47:05.733295 (Thread-1): finished collecting timing info
2020-07-07 13:47:05.789003 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-07 13:47:05.790444 (Thread-1): On model.springml_demo_dbt_project.creditcard: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
  OPTIONS()
  as 

select country,

sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,

sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,

sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,

from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
group by country 
order by (Amex_payments + Mastercard_payments + Visa_payments) desc;


2020-07-07 13:47:06.265057 (Thread-1): Unhandled error while running:
/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
  OPTIONS()
  as 

select country,

sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,

sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,

sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,

from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
group by country 
order by (Amex_payments + Mastercard_payments + Visa_payments) desc;


2020-07-07 13:47:06.265304 (Thread-1): 404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US

(job ID: 179d374a-d63c-4104-bad1-13d2387fd616)

                                                               -----Query Job SQL Follows-----                                                               

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
   5:  OPTIONS()
   6:  as 
   7:
   8:select country,
   9:
  10:sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,
  11:
  12:sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,
  13:
  14:sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,
  15:
  16:from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
  17:group by country 
  18:order by (Amex_payments + Mastercard_payments + Visa_payments) desc;
  19:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
2020-07-07 13:47:06.265812 (Thread-1): finished collecting timing info
2020-07-07 13:47:06.266911 (Thread-1): Runtime Error in model creditcard (models/base/creditcard.sql)
  404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
  
  (job ID: 179d374a-d63c-4104-bad1-13d2387fd616)
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 84, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 225, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 352, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3207, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 812, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 127, in result
    raise self._exception
google.api_core.exceptions.NotFound: 404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US

(job ID: 179d374a-d63c-4104-bad1-13d2387fd616)

                                                               -----Query Job SQL Follows-----                                                               

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
   5:  OPTIONS()
   6:  as 
   7:
   8:select country,
   9:
  10:sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,
  11:
  12:sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,
  13:
  14:sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,
  15:
  16:from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
  17:group by country 
  18:order by (Amex_payments + Mastercard_payments + Visa_payments) desc;
  19:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 234, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 227, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/Cellar/python/3.7.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error in model creditcard (models/base/creditcard.sql)
  404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
  
  (job ID: 179d374a-d63c-4104-bad1-13d2387fd616)
2020-07-07 13:47:06.313297 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c2f9c73-315b-4f69-9a9f-6be43b82836d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae38f10>]}
2020-07-07 13:47:06.316270 (Thread-1): 09:47:06 | 1 of 2 ERROR creating view model springml_demo_dataset.creditcard.... [ERROR in 0.60s]
2020-07-07 13:47:06.316526 (Thread-1): Finished running node model.springml_demo_dbt_project.creditcard
2020-07-07 13:47:06.316799 (Thread-1): Began running node model.springml_demo_dbt_project.payments
2020-07-07 13:47:06.318221 (Thread-1): 09:47:06 | 2 of 2 START view model springml_demo_dataset.payments............... [RUN]
2020-07-07 13:47:06.319146 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-07 13:47:06.319307 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.creditcard).
2020-07-07 13:47:06.319416 (Thread-1): Compiling model.springml_demo_dbt_project.payments
2020-07-07 13:47:06.332874 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.payments"
2020-07-07 13:47:06.333366 (Thread-1): finished collecting timing info
2020-07-07 13:47:06.337854 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.payments"
2020-07-07 13:47:06.338439 (Thread-1): On model.springml_demo_dbt_project.payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
  OPTIONS()
  as select payment_type, 
    count(*) as number_of_payments, 
    sum(price) as total_price 
from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where country like "United States"
group by payment_type;


2020-07-07 13:47:06.582786 (Thread-1): Unhandled error while running:
/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
  OPTIONS()
  as select payment_type, 
    count(*) as number_of_payments, 
    sum(price) as total_price 
from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where country like "United States"
group by payment_type;


2020-07-07 13:47:06.604562 (Thread-1): 404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US

(job ID: a9b4af62-9480-4b1c-9ec7-b76b9810f18e)

                                                              -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
   5:  OPTIONS()
   6:  as select payment_type, 
   7:    count(*) as number_of_payments, 
   8:    sum(price) as total_price 
   9:from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
  10:where country like "United States"
  11:group by payment_type;
  12:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
2020-07-07 13:47:06.620063 (Thread-1): finished collecting timing info
2020-07-07 13:47:06.620996 (Thread-1): Runtime Error in model payments (models/base/payments.sql)
  404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
  
  (job ID: a9b4af62-9480-4b1c-9ec7-b76b9810f18e)
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 84, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 225, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 352, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3207, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 812, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 127, in result
    raise self._exception
google.api_core.exceptions.NotFound: 404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US

(job ID: a9b4af62-9480-4b1c-9ec7-b76b9810f18e)

                                                              -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
   5:  OPTIONS()
   6:  as select payment_type, 
   7:    count(*) as number_of_payments, 
   8:    sum(price) as total_price 
   9:from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
  10:where country like "United States"
  11:group by payment_type;
  12:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 234, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 227, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/Cellar/python/3.7.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error in model payments (models/base/payments.sql)
  404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
  
  (job ID: a9b4af62-9480-4b1c-9ec7-b76b9810f18e)
2020-07-07 13:47:06.622278 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c2f9c73-315b-4f69-9a9f-6be43b82836d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afbdfd0>]}
2020-07-07 13:47:06.624819 (Thread-1): 09:47:06 | 2 of 2 ERROR creating view model springml_demo_dataset.payments...... [ERROR in 0.30s]
2020-07-07 13:47:06.625108 (Thread-1): Finished running node model.springml_demo_dbt_project.payments
2020-07-07 13:47:06.741676 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 13:47:06.741920 (MainThread): Opening a new connection, currently in state closed
2020-07-07 13:47:06.742426 (MainThread): 09:47:06 | 
2020-07-07 13:47:06.742647 (MainThread): 09:47:06 | Finished running 2 view models in 4.94s.
2020-07-07 13:47:06.742848 (MainThread): Connection 'master' was properly closed.
2020-07-07 13:47:06.742983 (MainThread): Connection 'model.springml_demo_dbt_project.payments' was left open.
2020-07-07 13:47:06.756116 (MainThread): 
2020-07-07 13:47:06.756447 (MainThread): Completed with 2 errors and 0 warnings:
2020-07-07 13:47:06.756652 (MainThread): 
2020-07-07 13:47:06.756829 (MainThread): Runtime Error in model creditcard (models/base/creditcard.sql)
2020-07-07 13:47:06.757474 (MainThread):   404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
2020-07-07 13:47:06.757789 (MainThread):   
2020-07-07 13:47:06.757973 (MainThread):   (job ID: 179d374a-d63c-4104-bad1-13d2387fd616)
2020-07-07 13:47:06.758229 (MainThread): 
2020-07-07 13:47:06.758409 (MainThread): Runtime Error in model payments (models/base/payments.sql)
2020-07-07 13:47:06.758617 (MainThread):   404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
2020-07-07 13:47:06.758797 (MainThread):   
2020-07-07 13:47:06.758991 (MainThread):   (job ID: a9b4af62-9480-4b1c-9ec7-b76b9810f18e)
2020-07-07 13:47:06.759175 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
2020-07-07 13:47:06.759761 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae382d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aefae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afbd890>]}
2020-07-07 13:47:06.760141 (MainThread): Flushing usage events
2020-07-07 13:47:54.038431 (MainThread): Running with dbt=0.17.0
2020-07-07 13:47:54.529446 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-07 13:47:54.539489 (MainThread): Tracking: tracking
2020-07-07 13:47:54.556219 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109971610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a163910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1b0f50>]}
2020-07-07 13:47:54.638167 (MainThread): Partial parsing not enabled
2020-07-07 13:47:54.641159 (MainThread): Parsing macros/core.sql
2020-07-07 13:47:54.653063 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-07 13:47:54.664964 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-07 13:47:54.668386 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-07 13:47:54.691440 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-07 13:47:54.728821 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-07 13:47:54.759455 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-07 13:47:54.764021 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-07 13:47:54.774761 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-07 13:47:54.792461 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-07 13:47:54.801213 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-07 13:47:54.809132 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-07 13:47:54.815317 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-07 13:47:54.816909 (MainThread): Parsing macros/etc/query.sql
2020-07-07 13:47:54.818791 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-07 13:47:54.821352 (MainThread): Parsing macros/etc/datetime.sql
2020-07-07 13:47:54.833292 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-07 13:47:54.836133 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-07 13:47:54.838665 (MainThread): Parsing macros/adapters/common.sql
2020-07-07 13:47:54.896657 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-07 13:47:54.899874 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-07 13:47:54.902148 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-07 13:47:54.904628 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-07 13:47:54.908777 (MainThread): Parsing macros/etc.sql
2020-07-07 13:47:54.910283 (MainThread): Parsing macros/catalog.sql
2020-07-07 13:47:54.919632 (MainThread): Parsing macros/adapters.sql
2020-07-07 13:47:54.941567 (MainThread): Parsing macros/materializations/seed.sql
2020-07-07 13:47:54.945065 (MainThread): Parsing macros/materializations/view.sql
2020-07-07 13:47:54.948395 (MainThread): Parsing macros/materializations/table.sql
2020-07-07 13:47:54.967847 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-07 13:47:54.984514 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-07 13:47:55.009026 (MainThread): Partial parsing not enabled
2020-07-07 13:47:55.067651 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-07 13:47:55.067853 (MainThread): Opening a new connection, currently in state init
2020-07-07 13:47:55.102435 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-07 13:47:55.102591 (MainThread): Opening a new connection, currently in state closed
2020-07-07 13:47:55.234132 (MainThread): WARNING: Found documentation for resource "creditcards" which was not found or is disabled
2020-07-07 13:47:55.340681 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 1 seed file, 1 source
2020-07-07 13:47:55.341975 (MainThread): 
2020-07-07 13:47:55.342513 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 13:47:55.342673 (MainThread): Opening a new connection, currently in state closed
2020-07-07 13:47:55.362031 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-07 13:47:55.362262 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-07 13:47:55.364349 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-07 13:47:57.347145 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-07 13:47:57.349149 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-07 13:47:57.349491 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-07 13:47:57.468237 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 13:47:57.468529 (MainThread): Opening a new connection, currently in state closed
2020-07-07 13:47:57.469010 (MainThread): 09:47:57 | Concurrency: 1 threads (target='dev')
2020-07-07 13:47:57.469288 (MainThread): 09:47:57 | 
2020-07-07 13:47:57.473110 (Thread-1): Began running node model.springml_demo_dbt_project.creditcard
2020-07-07 13:47:57.474930 (Thread-1): 09:47:57 | 1 of 2 START view model springml_demo_dataset.creditcard............. [RUN]
2020-07-07 13:47:57.475419 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-07 13:47:57.475577 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-07 13:47:57.475741 (Thread-1): Compiling model.springml_demo_dbt_project.creditcard
2020-07-07 13:47:57.494962 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-07 13:47:57.495519 (Thread-1): finished collecting timing info
2020-07-07 13:47:57.534272 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-07 13:47:57.534786 (Thread-1): On model.springml_demo_dbt_project.creditcard: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
  OPTIONS()
  as 

select country,

sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,

sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,

sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,

from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
group by country 
order by (Amex_payments + Mastercard_payments + Visa_payments) desc;


2020-07-07 13:47:57.770048 (Thread-1): Unhandled error while running:
/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
  OPTIONS()
  as 

select country,

sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,

sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,

sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,

from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
group by country 
order by (Amex_payments + Mastercard_payments + Visa_payments) desc;


2020-07-07 13:47:57.770294 (Thread-1): 404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US

(job ID: b23a3500-5754-4d98-b5ec-a86b10306ecd)

                                                               -----Query Job SQL Follows-----                                                               

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
   5:  OPTIONS()
   6:  as 
   7:
   8:select country,
   9:
  10:sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,
  11:
  12:sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,
  13:
  14:sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,
  15:
  16:from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
  17:group by country 
  18:order by (Amex_payments + Mastercard_payments + Visa_payments) desc;
  19:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
2020-07-07 13:47:57.770590 (Thread-1): finished collecting timing info
2020-07-07 13:47:57.771333 (Thread-1): Runtime Error in model creditcard (models/base/creditcard.sql)
  404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
  
  (job ID: b23a3500-5754-4d98-b5ec-a86b10306ecd)
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 84, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 225, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 352, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3207, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 812, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 127, in result
    raise self._exception
google.api_core.exceptions.NotFound: 404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US

(job ID: b23a3500-5754-4d98-b5ec-a86b10306ecd)

                                                               -----Query Job SQL Follows-----                                                               

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
   5:  OPTIONS()
   6:  as 
   7:
   8:select country,
   9:
  10:sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,
  11:
  12:sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,
  13:
  14:sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,
  15:
  16:from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
  17:group by country 
  18:order by (Amex_payments + Mastercard_payments + Visa_payments) desc;
  19:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 234, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 227, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/Cellar/python/3.7.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error in model creditcard (models/base/creditcard.sql)
  404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
  
  (job ID: b23a3500-5754-4d98-b5ec-a86b10306ecd)
2020-07-07 13:47:57.792041 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c65e263-1dcc-41bd-bd1c-fd9965a99470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5677d0>]}
2020-07-07 13:47:57.793810 (Thread-1): 09:47:57 | 1 of 2 ERROR creating view model springml_demo_dataset.creditcard.... [ERROR in 0.32s]
2020-07-07 13:47:57.794040 (Thread-1): Finished running node model.springml_demo_dbt_project.creditcard
2020-07-07 13:47:57.794262 (Thread-1): Began running node model.springml_demo_dbt_project.payments
2020-07-07 13:47:57.795828 (Thread-1): 09:47:57 | 2 of 2 START view model springml_demo_dataset.payments............... [RUN]
2020-07-07 13:47:57.796495 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-07 13:47:57.796622 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.creditcard).
2020-07-07 13:47:57.796736 (Thread-1): Compiling model.springml_demo_dbt_project.payments
2020-07-07 13:47:57.808881 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.payments"
2020-07-07 13:47:57.809326 (Thread-1): finished collecting timing info
2020-07-07 13:47:57.813518 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.payments"
2020-07-07 13:47:57.813928 (Thread-1): On model.springml_demo_dbt_project.payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
  OPTIONS()
  as select payment_type, 
    count(*) as number_of_payments, 
    sum(price) as total_price 
from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where country like "United States"
group by payment_type;


2020-07-07 13:47:58.078780 (Thread-1): Unhandled error while running:
/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
  OPTIONS()
  as select payment_type, 
    count(*) as number_of_payments, 
    sum(price) as total_price 
from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where country like "United States"
group by payment_type;


2020-07-07 13:47:58.079006 (Thread-1): 404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US

(job ID: dd119265-cdb6-4b44-959b-f386743968f8)

                                                              -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
   5:  OPTIONS()
   6:  as select payment_type, 
   7:    count(*) as number_of_payments, 
   8:    sum(price) as total_price 
   9:from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
  10:where country like "United States"
  11:group by payment_type;
  12:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
2020-07-07 13:47:58.079257 (Thread-1): finished collecting timing info
2020-07-07 13:47:58.079914 (Thread-1): Runtime Error in model payments (models/base/payments.sql)
  404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
  
  (job ID: dd119265-cdb6-4b44-959b-f386743968f8)
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 84, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 225, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 352, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3207, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 812, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 127, in result
    raise self._exception
google.api_core.exceptions.NotFound: 404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US

(job ID: dd119265-cdb6-4b44-959b-f386743968f8)

                                                              -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
   5:  OPTIONS()
   6:  as select payment_type, 
   7:    count(*) as number_of_payments, 
   8:    sum(price) as total_price 
   9:from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
  10:where country like "United States"
  11:group by payment_type;
  12:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 234, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 227, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/Cellar/python/3.7.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error in model payments (models/base/payments.sql)
  404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
  
  (job ID: dd119265-cdb6-4b44-959b-f386743968f8)
2020-07-07 13:47:58.080871 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c65e263-1dcc-41bd-bd1c-fd9965a99470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af1ee10>]}
2020-07-07 13:47:58.082622 (Thread-1): 09:47:58 | 2 of 2 ERROR creating view model springml_demo_dataset.payments...... [ERROR in 0.28s]
2020-07-07 13:47:58.083071 (Thread-1): Finished running node model.springml_demo_dbt_project.payments
2020-07-07 13:47:58.189162 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 13:47:58.189411 (MainThread): Opening a new connection, currently in state closed
2020-07-07 13:47:58.189883 (MainThread): 09:47:58 | 
2020-07-07 13:47:58.190108 (MainThread): 09:47:58 | Finished running 2 view models in 2.85s.
2020-07-07 13:47:58.190396 (MainThread): Connection 'master' was properly closed.
2020-07-07 13:47:58.190631 (MainThread): Connection 'model.springml_demo_dbt_project.payments' was left open.
2020-07-07 13:47:58.199586 (MainThread): 
2020-07-07 13:47:58.199765 (MainThread): Completed with 2 errors and 0 warnings:
2020-07-07 13:47:58.199919 (MainThread): 
2020-07-07 13:47:58.200069 (MainThread): Runtime Error in model creditcard (models/base/creditcard.sql)
2020-07-07 13:47:58.200209 (MainThread):   404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
2020-07-07 13:47:58.200338 (MainThread):   
2020-07-07 13:47:58.200463 (MainThread):   (job ID: b23a3500-5754-4d98-b5ec-a86b10306ecd)
2020-07-07 13:47:58.200595 (MainThread): 
2020-07-07 13:47:58.200732 (MainThread): Runtime Error in model payments (models/base/payments.sql)
2020-07-07 13:47:58.200858 (MainThread):   404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
2020-07-07 13:47:58.200981 (MainThread):   
2020-07-07 13:47:58.201099 (MainThread):   (job ID: dd119265-cdb6-4b44-959b-f386743968f8)
2020-07-07 13:47:58.201234 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
2020-07-07 13:47:58.201498 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a54fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af1a490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae62810>]}
2020-07-07 13:47:58.201719 (MainThread): Flushing usage events
2020-07-07 13:50:48.547579 (MainThread): Running with dbt=0.17.0
2020-07-07 13:50:49.203676 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-07 13:50:49.205310 (MainThread): Tracking: tracking
2020-07-07 13:50:49.224259 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3ed110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3f1f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3f1d90>]}
2020-07-07 13:50:49.278389 (MainThread): Partial parsing not enabled
2020-07-07 13:50:49.282958 (MainThread): Parsing macros/core.sql
2020-07-07 13:50:49.292252 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-07 13:50:49.302999 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-07 13:50:49.306042 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-07 13:50:49.328572 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-07 13:50:49.365154 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-07 13:50:49.391221 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-07 13:50:49.395011 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-07 13:50:49.405114 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-07 13:50:49.422260 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-07 13:50:49.431102 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-07 13:50:49.440140 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-07 13:50:49.446440 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-07 13:50:49.448148 (MainThread): Parsing macros/etc/query.sql
2020-07-07 13:50:49.450077 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-07 13:50:49.452694 (MainThread): Parsing macros/etc/datetime.sql
2020-07-07 13:50:49.463822 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-07 13:50:49.466665 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-07 13:50:49.469228 (MainThread): Parsing macros/adapters/common.sql
2020-07-07 13:50:49.527592 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-07 13:50:49.530851 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-07 13:50:49.533084 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-07 13:50:49.535489 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-07 13:50:49.539903 (MainThread): Parsing macros/etc.sql
2020-07-07 13:50:49.541365 (MainThread): Parsing macros/catalog.sql
2020-07-07 13:50:49.549694 (MainThread): Parsing macros/adapters.sql
2020-07-07 13:50:49.569189 (MainThread): Parsing macros/materializations/seed.sql
2020-07-07 13:50:49.572003 (MainThread): Parsing macros/materializations/view.sql
2020-07-07 13:50:49.574933 (MainThread): Parsing macros/materializations/table.sql
2020-07-07 13:50:49.587629 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-07 13:50:49.603900 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-07 13:50:49.629888 (MainThread): Partial parsing not enabled
2020-07-07 13:50:49.672470 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-07 13:50:49.672653 (MainThread): Opening a new connection, currently in state init
2020-07-07 13:50:49.708993 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-07 13:50:49.709169 (MainThread): Opening a new connection, currently in state closed
2020-07-07 13:50:49.839421 (MainThread): WARNING: Found documentation for resource "creditcards" which was not found or is disabled
2020-07-07 13:50:49.906197 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 1 seed file, 1 source
2020-07-07 13:50:49.906947 (MainThread): 
2020-07-07 13:50:49.907389 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 13:50:49.907491 (MainThread): Opening a new connection, currently in state closed
2020-07-07 13:50:49.911495 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-07 13:50:49.911775 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-07 13:50:53.293479 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-07 13:50:53.293745 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-07 13:50:53.293953 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-07 13:50:53.427610 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 13:50:53.427846 (MainThread): Opening a new connection, currently in state closed
2020-07-07 13:50:53.428261 (MainThread): 09:50:53 | Concurrency: 1 threads (target='dev')
2020-07-07 13:50:53.428489 (MainThread): 09:50:53 | 
2020-07-07 13:50:53.432427 (Thread-1): Began running node model.springml_demo_dbt_project.creditcard
2020-07-07 13:50:53.434248 (Thread-1): 09:50:53 | 1 of 2 START view model springml_demo_dataset.creditcard............. [RUN]
2020-07-07 13:50:53.434715 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-07 13:50:53.434866 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-07 13:50:53.435011 (Thread-1): Compiling model.springml_demo_dbt_project.creditcard
2020-07-07 13:50:53.454262 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-07 13:50:53.454788 (Thread-1): finished collecting timing info
2020-07-07 13:50:53.489612 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-07 13:50:53.490117 (Thread-1): On model.springml_demo_dbt_project.creditcard: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
  OPTIONS()
  as 

select country,

sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,

sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,

sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,

from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
group by country 
order by (Amex_payments + Mastercard_payments + Visa_payments) desc;


2020-07-07 13:50:54.003737 (Thread-1): Unhandled error while running:
/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
  OPTIONS()
  as 

select country,

sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,

sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,

sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,

from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
group by country 
order by (Amex_payments + Mastercard_payments + Visa_payments) desc;


2020-07-07 13:50:54.003990 (Thread-1): 404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US

(job ID: aed546ed-2d86-4ec7-a201-d14f4705fdbb)

                                                               -----Query Job SQL Follows-----                                                               

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
   5:  OPTIONS()
   6:  as 
   7:
   8:select country,
   9:
  10:sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,
  11:
  12:sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,
  13:
  14:sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,
  15:
  16:from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
  17:group by country 
  18:order by (Amex_payments + Mastercard_payments + Visa_payments) desc;
  19:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
2020-07-07 13:50:54.004293 (Thread-1): finished collecting timing info
2020-07-07 13:50:54.005009 (Thread-1): Runtime Error in model creditcard (models/base/creditcard.sql)
  404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
  
  (job ID: aed546ed-2d86-4ec7-a201-d14f4705fdbb)
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 84, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 225, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 352, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3207, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 812, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 127, in result
    raise self._exception
google.api_core.exceptions.NotFound: 404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US

(job ID: aed546ed-2d86-4ec7-a201-d14f4705fdbb)

                                                               -----Query Job SQL Follows-----                                                               

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
   5:  OPTIONS()
   6:  as 
   7:
   8:select country,
   9:
  10:sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,
  11:
  12:sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,
  13:
  14:sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,
  15:
  16:from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
  17:group by country 
  18:order by (Amex_payments + Mastercard_payments + Visa_payments) desc;
  19:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 234, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 227, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/Cellar/python/3.7.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error in model creditcard (models/base/creditcard.sql)
  404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
  
  (job ID: aed546ed-2d86-4ec7-a201-d14f4705fdbb)
2020-07-07 13:50:54.028113 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53e04c29-403c-401c-b05e-5f0f09c04e09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c46b550>]}
2020-07-07 13:50:54.029959 (Thread-1): 09:50:54 | 1 of 2 ERROR creating view model springml_demo_dataset.creditcard.... [ERROR in 0.59s]
2020-07-07 13:50:54.030161 (Thread-1): Finished running node model.springml_demo_dbt_project.creditcard
2020-07-07 13:50:54.030418 (Thread-1): Began running node model.springml_demo_dbt_project.payments
2020-07-07 13:50:54.031929 (Thread-1): 09:50:54 | 2 of 2 START view model springml_demo_dataset.payments............... [RUN]
2020-07-07 13:50:54.032345 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-07 13:50:54.032478 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.creditcard).
2020-07-07 13:50:54.032603 (Thread-1): Compiling model.springml_demo_dbt_project.payments
2020-07-07 13:50:54.045141 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.payments"
2020-07-07 13:50:54.045636 (Thread-1): finished collecting timing info
2020-07-07 13:50:54.050214 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.payments"
2020-07-07 13:50:54.050697 (Thread-1): On model.springml_demo_dbt_project.payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
  OPTIONS()
  as select payment_type, 
    count(*) as number_of_payments, 
    sum(price) as total_price 
from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where country like "United States"
group by payment_type;


2020-07-07 13:50:54.317444 (Thread-1): Unhandled error while running:
/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
  OPTIONS()
  as select payment_type, 
    count(*) as number_of_payments, 
    sum(price) as total_price 
from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where country like "United States"
group by payment_type;


2020-07-07 13:50:54.317677 (Thread-1): 404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US

(job ID: b65deaf5-2659-4f60-902a-99382ca98834)

                                                              -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
   5:  OPTIONS()
   6:  as select payment_type, 
   7:    count(*) as number_of_payments, 
   8:    sum(price) as total_price 
   9:from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
  10:where country like "United States"
  11:group by payment_type;
  12:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
2020-07-07 13:50:54.317944 (Thread-1): finished collecting timing info
2020-07-07 13:50:54.318742 (Thread-1): Runtime Error in model payments (models/base/payments.sql)
  404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
  
  (job ID: b65deaf5-2659-4f60-902a-99382ca98834)
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 84, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 225, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 352, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3207, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 812, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 127, in result
    raise self._exception
google.api_core.exceptions.NotFound: 404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US

(job ID: b65deaf5-2659-4f60-902a-99382ca98834)

                                                              -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
   5:  OPTIONS()
   6:  as select payment_type, 
   7:    count(*) as number_of_payments, 
   8:    sum(price) as total_price 
   9:from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
  10:where country like "United States"
  11:group by payment_type;
  12:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 234, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 227, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/Cellar/python/3.7.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error in model payments (models/base/payments.sql)
  404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
  
  (job ID: b65deaf5-2659-4f60-902a-99382ca98834)
2020-07-07 13:50:54.319806 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53e04c29-403c-401c-b05e-5f0f09c04e09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9435d0>]}
2020-07-07 13:50:54.321319 (Thread-1): 09:50:54 | 2 of 2 ERROR creating view model springml_demo_dataset.payments...... [ERROR in 0.29s]
2020-07-07 13:50:54.321527 (Thread-1): Finished running node model.springml_demo_dbt_project.payments
2020-07-07 13:50:54.365573 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 13:50:54.365779 (MainThread): Opening a new connection, currently in state closed
2020-07-07 13:50:54.366166 (MainThread): 09:50:54 | 
2020-07-07 13:50:54.366343 (MainThread): 09:50:54 | Finished running 2 view models in 4.46s.
2020-07-07 13:50:54.366593 (MainThread): Connection 'master' was properly closed.
2020-07-07 13:50:54.366753 (MainThread): Connection 'model.springml_demo_dbt_project.payments' was left open.
2020-07-07 13:50:54.373537 (MainThread): 
2020-07-07 13:50:54.373692 (MainThread): Completed with 2 errors and 0 warnings:
2020-07-07 13:50:54.373838 (MainThread): 
2020-07-07 13:50:54.373981 (MainThread): Runtime Error in model creditcard (models/base/creditcard.sql)
2020-07-07 13:50:54.374115 (MainThread):   404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
2020-07-07 13:50:54.374240 (MainThread):   
2020-07-07 13:50:54.374360 (MainThread):   (job ID: aed546ed-2d86-4ec7-a201-d14f4705fdbb)
2020-07-07 13:50:54.374489 (MainThread): 
2020-07-07 13:50:54.374620 (MainThread): Runtime Error in model payments (models/base/payments.sql)
2020-07-07 13:50:54.374776 (MainThread):   404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
2020-07-07 13:50:54.374930 (MainThread):   
2020-07-07 13:50:54.375073 (MainThread):   (job ID: b65deaf5-2659-4f60-902a-99382ca98834)
2020-07-07 13:50:54.375210 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
2020-07-07 13:50:54.375493 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c951d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c951bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6a7610>]}
2020-07-07 13:50:54.375717 (MainThread): Flushing usage events
2020-07-07 13:53:48.978720 (MainThread): Running with dbt=0.17.0
2020-07-07 13:53:49.463816 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-07 13:53:49.472252 (MainThread): Tracking: tracking
2020-07-07 13:53:49.490668 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e192610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db9c290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e196c90>]}
2020-07-07 13:53:49.544763 (MainThread): Partial parsing not enabled
2020-07-07 13:53:49.547450 (MainThread): Parsing macros/core.sql
2020-07-07 13:53:49.555051 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-07 13:53:49.567756 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-07 13:53:49.571014 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-07 13:53:49.595147 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-07 13:53:49.631797 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-07 13:53:49.663528 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-07 13:53:49.668143 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-07 13:53:49.678874 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-07 13:53:49.696684 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-07 13:53:49.705446 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-07 13:53:49.713670 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-07 13:53:49.719950 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-07 13:53:49.721606 (MainThread): Parsing macros/etc/query.sql
2020-07-07 13:53:49.723544 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-07 13:53:49.726183 (MainThread): Parsing macros/etc/datetime.sql
2020-07-07 13:53:49.737302 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-07 13:53:49.740270 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-07 13:53:49.742814 (MainThread): Parsing macros/adapters/common.sql
2020-07-07 13:53:49.802036 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-07 13:53:49.804756 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-07 13:53:49.807320 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-07 13:53:49.809835 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-07 13:53:49.814307 (MainThread): Parsing macros/etc.sql
2020-07-07 13:53:49.815646 (MainThread): Parsing macros/catalog.sql
2020-07-07 13:53:49.824091 (MainThread): Parsing macros/adapters.sql
2020-07-07 13:53:49.843427 (MainThread): Parsing macros/materializations/seed.sql
2020-07-07 13:53:49.846254 (MainThread): Parsing macros/materializations/view.sql
2020-07-07 13:53:49.849025 (MainThread): Parsing macros/materializations/table.sql
2020-07-07 13:53:49.861923 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-07 13:53:49.878048 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-07 13:53:49.910621 (MainThread): Partial parsing not enabled
2020-07-07 13:53:49.969285 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-07 13:53:49.969464 (MainThread): Opening a new connection, currently in state init
2020-07-07 13:53:50.003836 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-07 13:53:50.003996 (MainThread): Opening a new connection, currently in state closed
2020-07-07 13:53:50.139503 (MainThread): WARNING: Found documentation for resource "creditcards" which was not found or is disabled
2020-07-07 13:53:50.206167 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 1 seed file, 1 source
2020-07-07 13:53:50.206819 (MainThread): 
2020-07-07 13:53:50.207167 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 13:53:50.207264 (MainThread): Opening a new connection, currently in state closed
2020-07-07 13:53:50.211363 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-07 13:53:50.211647 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-07 13:53:52.153934 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-07 13:53:52.154197 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-07 13:53:52.154405 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-07 13:53:52.302672 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 13:53:52.302916 (MainThread): Opening a new connection, currently in state closed
2020-07-07 13:53:52.303263 (MainThread): 09:53:52 | Concurrency: 1 threads (target='dev')
2020-07-07 13:53:52.303445 (MainThread): 09:53:52 | 
2020-07-07 13:53:52.307037 (Thread-1): Began running node model.springml_demo_dbt_project.creditcard
2020-07-07 13:53:52.308844 (Thread-1): 09:53:52 | 1 of 2 START view model springml_demo_dataset.creditcard............. [RUN]
2020-07-07 13:53:52.309319 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-07 13:53:52.309469 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-07 13:53:52.309615 (Thread-1): Compiling model.springml_demo_dbt_project.creditcard
2020-07-07 13:53:52.328571 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-07 13:53:52.330056 (Thread-1): finished collecting timing info
2020-07-07 13:53:52.366207 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-07 13:53:52.366773 (Thread-1): On model.springml_demo_dbt_project.creditcard: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
  OPTIONS()
  as 

select country,

sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,

sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,

sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,

from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
group by country 
order by (Amex_payments + Mastercard_payments + Visa_payments) desc;


2020-07-07 13:53:52.782113 (Thread-1): Unhandled error while running:
/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
  OPTIONS()
  as 

select country,

sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,

sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,

sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,

from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
group by country 
order by (Amex_payments + Mastercard_payments + Visa_payments) desc;


2020-07-07 13:53:52.782368 (Thread-1): 404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US

(job ID: 57083524-9989-4e23-82d0-fea0bbd0009f)

                                                               -----Query Job SQL Follows-----                                                               

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
   5:  OPTIONS()
   6:  as 
   7:
   8:select country,
   9:
  10:sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,
  11:
  12:sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,
  13:
  14:sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,
  15:
  16:from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
  17:group by country 
  18:order by (Amex_payments + Mastercard_payments + Visa_payments) desc;
  19:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
2020-07-07 13:53:52.782656 (Thread-1): finished collecting timing info
2020-07-07 13:53:52.783380 (Thread-1): Runtime Error in model creditcard (models/base/creditcard.sql)
  404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
  
  (job ID: 57083524-9989-4e23-82d0-fea0bbd0009f)
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 84, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 225, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 352, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3207, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 812, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 127, in result
    raise self._exception
google.api_core.exceptions.NotFound: 404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US

(job ID: 57083524-9989-4e23-82d0-fea0bbd0009f)

                                                               -----Query Job SQL Follows-----                                                               

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
   5:  OPTIONS()
   6:  as 
   7:
   8:select country,
   9:
  10:sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,
  11:
  12:sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,
  13:
  14:sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,
  15:
  16:from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
  17:group by country 
  18:order by (Amex_payments + Mastercard_payments + Visa_payments) desc;
  19:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 234, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 227, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/Cellar/python/3.7.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error in model creditcard (models/base/creditcard.sql)
  404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
  
  (job ID: 57083524-9989-4e23-82d0-fea0bbd0009f)
2020-07-07 13:53:52.827129 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdf5789e-9a0f-4adf-8c72-3c323cc9cd1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e36f410>]}
2020-07-07 13:53:52.828964 (Thread-1): 09:53:52 | 1 of 2 ERROR creating view model springml_demo_dataset.creditcard.... [ERROR in 0.52s]
2020-07-07 13:53:52.829171 (Thread-1): Finished running node model.springml_demo_dbt_project.creditcard
2020-07-07 13:53:52.829436 (Thread-1): Began running node model.springml_demo_dbt_project.payments
2020-07-07 13:53:52.830970 (Thread-1): 09:53:52 | 2 of 2 START view model springml_demo_dataset.payments............... [RUN]
2020-07-07 13:53:52.831405 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-07 13:53:52.831539 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.creditcard).
2020-07-07 13:53:52.831667 (Thread-1): Compiling model.springml_demo_dbt_project.payments
2020-07-07 13:53:52.844346 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.payments"
2020-07-07 13:53:52.844858 (Thread-1): finished collecting timing info
2020-07-07 13:53:52.849127 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.payments"
2020-07-07 13:53:52.849582 (Thread-1): On model.springml_demo_dbt_project.payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
  OPTIONS()
  as select payment_type, 
    count(*) as number_of_payments, 
    sum(price) as total_price 
from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where country like "United States"
group by payment_type;


2020-07-07 13:53:53.147634 (Thread-1): Unhandled error while running:
/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
  OPTIONS()
  as select payment_type, 
    count(*) as number_of_payments, 
    sum(price) as total_price 
from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where country like "United States"
group by payment_type;


2020-07-07 13:53:53.147951 (Thread-1): 404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US

(job ID: be66cc8a-ccfe-4754-b36e-9ff3649adaad)

                                                              -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
   5:  OPTIONS()
   6:  as select payment_type, 
   7:    count(*) as number_of_payments, 
   8:    sum(price) as total_price 
   9:from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
  10:where country like "United States"
  11:group by payment_type;
  12:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
2020-07-07 13:53:53.148195 (Thread-1): finished collecting timing info
2020-07-07 13:53:53.148829 (Thread-1): Runtime Error in model payments (models/base/payments.sql)
  404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
  
  (job ID: be66cc8a-ccfe-4754-b36e-9ff3649adaad)
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 84, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 225, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 352, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3207, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 812, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 127, in result
    raise self._exception
google.api_core.exceptions.NotFound: 404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US

(job ID: be66cc8a-ccfe-4754-b36e-9ff3649adaad)

                                                              -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
   5:  OPTIONS()
   6:  as select payment_type, 
   7:    count(*) as number_of_payments, 
   8:    sum(price) as total_price 
   9:from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
  10:where country like "United States"
  11:group by payment_type;
  12:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 234, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 227, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/Cellar/python/3.7.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error in model payments (models/base/payments.sql)
  404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
  
  (job ID: be66cc8a-ccfe-4754-b36e-9ff3649adaad)
2020-07-07 13:53:53.150130 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdf5789e-9a0f-4adf-8c72-3c323cc9cd1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef16790>]}
2020-07-07 13:53:53.151709 (Thread-1): 09:53:53 | 2 of 2 ERROR creating view model springml_demo_dataset.payments...... [ERROR in 0.32s]
2020-07-07 13:53:53.151930 (Thread-1): Finished running node model.springml_demo_dbt_project.payments
2020-07-07 13:53:53.228139 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 13:53:53.228398 (MainThread): Opening a new connection, currently in state closed
2020-07-07 13:53:53.228875 (MainThread): 09:53:53 | 
2020-07-07 13:53:53.229096 (MainThread): 09:53:53 | Finished running 2 view models in 3.02s.
2020-07-07 13:53:53.229298 (MainThread): Connection 'master' was properly closed.
2020-07-07 13:53:53.229456 (MainThread): Connection 'model.springml_demo_dbt_project.payments' was left open.
2020-07-07 13:53:53.240761 (MainThread): 
2020-07-07 13:53:53.241162 (MainThread): Completed with 2 errors and 0 warnings:
2020-07-07 13:53:53.241466 (MainThread): 
2020-07-07 13:53:53.241789 (MainThread): Runtime Error in model creditcard (models/base/creditcard.sql)
2020-07-07 13:53:53.241997 (MainThread):   404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
2020-07-07 13:53:53.242168 (MainThread):   
2020-07-07 13:53:53.242336 (MainThread):   (job ID: 57083524-9989-4e23-82d0-fea0bbd0009f)
2020-07-07 13:53:53.242519 (MainThread): 
2020-07-07 13:53:53.242707 (MainThread): Runtime Error in model payments (models/base/payments.sql)
2020-07-07 13:53:53.242878 (MainThread):   404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
2020-07-07 13:53:53.243074 (MainThread):   
2020-07-07 13:53:53.243279 (MainThread):   (job ID: be66cc8a-ccfe-4754-b36e-9ff3649adaad)
2020-07-07 13:53:53.243417 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
2020-07-07 13:53:53.243669 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef242d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee4be90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef24a10>]}
2020-07-07 13:53:53.243987 (MainThread): Flushing usage events
2020-07-07 14:02:23.733091 (MainThread): Running with dbt=0.17.0
2020-07-07 14:02:24.244478 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-07 14:02:24.246111 (MainThread): Tracking: tracking
2020-07-07 14:02:24.283758 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103d1750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103d5f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103d5d50>]}
2020-07-07 14:02:24.337376 (MainThread): Partial parsing not enabled
2020-07-07 14:02:24.342090 (MainThread): Parsing macros/core.sql
2020-07-07 14:02:24.350814 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-07 14:02:24.361501 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-07 14:02:24.364496 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-07 14:02:24.384873 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-07 14:02:24.419968 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-07 14:02:24.446749 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-07 14:02:24.451358 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-07 14:02:24.461928 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-07 14:02:24.479532 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-07 14:02:24.491987 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-07 14:02:24.501195 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-07 14:02:24.510809 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-07 14:02:24.512757 (MainThread): Parsing macros/etc/query.sql
2020-07-07 14:02:24.514808 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-07 14:02:24.517666 (MainThread): Parsing macros/etc/datetime.sql
2020-07-07 14:02:24.529015 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-07 14:02:24.531820 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-07 14:02:24.534373 (MainThread): Parsing macros/adapters/common.sql
2020-07-07 14:02:24.596815 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-07 14:02:24.599078 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-07 14:02:24.600995 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-07 14:02:24.603451 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-07 14:02:24.607438 (MainThread): Parsing macros/etc.sql
2020-07-07 14:02:24.608854 (MainThread): Parsing macros/catalog.sql
2020-07-07 14:02:24.616940 (MainThread): Parsing macros/adapters.sql
2020-07-07 14:02:24.643003 (MainThread): Parsing macros/materializations/seed.sql
2020-07-07 14:02:24.646289 (MainThread): Parsing macros/materializations/view.sql
2020-07-07 14:02:24.649356 (MainThread): Parsing macros/materializations/table.sql
2020-07-07 14:02:24.665635 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-07 14:02:24.689310 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-07 14:02:24.721413 (MainThread): Partial parsing not enabled
2020-07-07 14:02:24.767313 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-07 14:02:24.767473 (MainThread): Opening a new connection, currently in state init
2020-07-07 14:02:24.803611 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-07 14:02:24.803777 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:02:24.934092 (MainThread): WARNING: Found documentation for resource "creditcards" which was not found or is disabled
2020-07-07 14:02:25.011935 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 1 seed file, 1 source
2020-07-07 14:02:25.012697 (MainThread): 
2020-07-07 14:02:25.013105 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 14:02:25.013208 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:02:25.017263 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-07 14:02:25.017550 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-07 14:02:25.521817 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-07 14:02:25.522090 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-07 14:02:25.522312 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-07 14:02:25.660450 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 14:02:25.660622 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:02:25.660888 (MainThread): 10:02:25 | Concurrency: 1 threads (target='dev')
2020-07-07 14:02:25.661022 (MainThread): 10:02:25 | 
2020-07-07 14:02:25.680912 (Thread-1): Began running node model.springml_demo_dbt_project.creditcard
2020-07-07 14:02:25.683963 (Thread-1): 10:02:25 | 1 of 2 START view model springml_demo_dataset.creditcard............. [RUN]
2020-07-07 14:02:25.684443 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-07 14:02:25.684603 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-07 14:02:25.684780 (Thread-1): Compiling model.springml_demo_dbt_project.creditcard
2020-07-07 14:02:25.757897 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-07 14:02:25.758730 (Thread-1): finished collecting timing info
2020-07-07 14:02:25.878572 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-07 14:02:25.881197 (Thread-1): On model.springml_demo_dbt_project.creditcard: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
  OPTIONS()
  as 

select country,

sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,

sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,

sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,

from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
group by country 
order by (Amex_payments + Mastercard_payments + Visa_payments) desc;


2020-07-07 14:02:27.009107 (Thread-1): finished collecting timing info
2020-07-07 14:02:27.009924 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '713baff8-b14d-419a-8752-77d742f058e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105a07d0>]}
2020-07-07 14:02:27.011162 (Thread-1): 10:02:27 | 1 of 2 OK created view model springml_demo_dataset.creditcard........ [CREATE VIEW in 1.33s]
2020-07-07 14:02:27.011323 (Thread-1): Finished running node model.springml_demo_dbt_project.creditcard
2020-07-07 14:02:27.011597 (Thread-1): Began running node model.springml_demo_dbt_project.payments
2020-07-07 14:02:27.012826 (Thread-1): 10:02:27 | 2 of 2 START view model springml_demo_dataset.payments............... [RUN]
2020-07-07 14:02:27.013179 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-07 14:02:27.013286 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.creditcard).
2020-07-07 14:02:27.013391 (Thread-1): Compiling model.springml_demo_dbt_project.payments
2020-07-07 14:02:27.024056 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.payments"
2020-07-07 14:02:27.024546 (Thread-1): finished collecting timing info
2020-07-07 14:02:27.029366 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.payments"
2020-07-07 14:02:27.030230 (Thread-1): On model.springml_demo_dbt_project.payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
  OPTIONS()
  as select payment_type, 
    count(*) as number_of_payments, 
    sum(price) as total_price 
from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where country like "United States"
group by payment_type;


2020-07-07 14:02:27.979154 (Thread-1): finished collecting timing info
2020-07-07 14:02:27.980861 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '713baff8-b14d-419a-8752-77d742f058e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105ac750>]}
2020-07-07 14:02:27.982142 (Thread-1): 10:02:27 | 2 of 2 OK created view model springml_demo_dataset.payments.......... [CREATE VIEW in 0.97s]
2020-07-07 14:02:27.982455 (Thread-1): Finished running node model.springml_demo_dbt_project.payments
2020-07-07 14:02:28.040301 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 14:02:28.040484 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:02:28.040808 (MainThread): 10:02:28 | 
2020-07-07 14:02:28.040970 (MainThread): 10:02:28 | Finished running 2 view models in 3.03s.
2020-07-07 14:02:28.041154 (MainThread): Connection 'master' was properly closed.
2020-07-07 14:02:28.041277 (MainThread): Connection 'model.springml_demo_dbt_project.payments' was left open.
2020-07-07 14:02:28.050328 (MainThread): 
2020-07-07 14:02:28.050517 (MainThread): Completed successfully
2020-07-07 14:02:28.050668 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-07-07 14:02:28.050888 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108591d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110756e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110855810>]}
2020-07-07 14:02:28.051083 (MainThread): Flushing usage events
2020-07-07 14:08:06.240893 (MainThread): Running with dbt=0.17.0
2020-07-07 14:08:06.837879 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-07 14:08:06.839576 (MainThread): Tracking: tracking
2020-07-07 14:08:06.868192 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054755d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105479ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105479cd0>]}
2020-07-07 14:08:06.922268 (MainThread): Partial parsing not enabled
2020-07-07 14:08:06.926048 (MainThread): Parsing macros/core.sql
2020-07-07 14:08:06.935033 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-07 14:08:06.946135 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-07 14:08:06.948702 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-07 14:08:06.971459 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-07 14:08:07.007859 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-07 14:08:07.037062 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-07 14:08:07.040332 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-07 14:08:07.048753 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-07 14:08:07.071046 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-07 14:08:07.083795 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-07 14:08:07.092853 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-07 14:08:07.099700 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-07 14:08:07.101181 (MainThread): Parsing macros/etc/query.sql
2020-07-07 14:08:07.103002 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-07 14:08:07.105452 (MainThread): Parsing macros/etc/datetime.sql
2020-07-07 14:08:07.116344 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-07 14:08:07.119024 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-07 14:08:07.121298 (MainThread): Parsing macros/adapters/common.sql
2020-07-07 14:08:07.182810 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-07 14:08:07.185490 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-07 14:08:07.187442 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-07 14:08:07.189592 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-07 14:08:07.193185 (MainThread): Parsing macros/etc.sql
2020-07-07 14:08:07.194466 (MainThread): Parsing macros/catalog.sql
2020-07-07 14:08:07.202207 (MainThread): Parsing macros/adapters.sql
2020-07-07 14:08:07.227096 (MainThread): Parsing macros/materializations/seed.sql
2020-07-07 14:08:07.230452 (MainThread): Parsing macros/materializations/view.sql
2020-07-07 14:08:07.233283 (MainThread): Parsing macros/materializations/table.sql
2020-07-07 14:08:07.245962 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-07 14:08:07.261887 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-07 14:08:07.287401 (MainThread): Partial parsing not enabled
2020-07-07 14:08:07.332297 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-07 14:08:07.332476 (MainThread): Opening a new connection, currently in state init
2020-07-07 14:08:07.368600 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-07 14:08:07.368762 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:08:07.504152 (MainThread): WARNING: Found documentation for resource "creditcards" which was not found or is disabled
2020-07-07 14:08:07.570801 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 1 seed file, 1 source
2020-07-07 14:08:07.571784 (MainThread): 
2020-07-07 14:08:07.572274 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 14:08:07.572386 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:08:07.577271 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-07 14:08:07.577663 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-07 14:08:07.577910 (ThreadPoolExecutor-0_0): Please log into GCP to continue
2020-07-07 14:08:07.578063 (ThreadPoolExecutor-0_0): Executing "gcloud --version"
2020-07-07 14:08:09.976316 (ThreadPoolExecutor-0_0): STDOUT: "b'Google Cloud SDK 298.0.0\nbq 2.0.58\ncore 2020.06.19\ngsutil 4.51\n'"
2020-07-07 14:08:09.976603 (ThreadPoolExecutor-0_0): STDERR: "b'Updates are available for some Cloud SDK components.  To install them,\nplease run:\n  $ gcloud components update'"
2020-07-07 14:08:09.976723 (ThreadPoolExecutor-0_0): Executing "gcloud auth application-default login"
2020-07-07 14:08:27.318154 (ThreadPoolExecutor-0_0): STDOUT: "b''"
2020-07-07 14:08:27.318703 (ThreadPoolExecutor-0_0): STDERR: "b'Your browser has been opened to visit:\n\n    https://accounts.google.com/o/oauth2/auth?client_id=764086051850-6qr4p6gpi6hn506pt8ejuq83di341hur.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8085%2F&scope=openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fcloud-platform+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Faccounts.reauth&code_challenge=eVn6LKl3maBgb17iUD-_2Y4ccPO1eBUFX8RSH4iBJIc&code_challenge_method=S256&access_type=offline&response_type=code&prompt=select_account\n\n\n\nCredentials saved to file: [/Users/medhapatil/.config/gcloud/application_default_credentials.json]\n\nThese credentials will be used by any library that requests Application Default Credentials (ADC).\n\nQuota project "newbigquery-279022" was added to ADC which can be used by Google client libraries for billing and quota. Note that some services may still bill the project owning the resource.\n'"
2020-07-07 14:08:27.320180 (MainThread): Connection 'master' was properly closed.
2020-07-07 14:08:27.320329 (MainThread): Connection 'list_prismatic-cider-279015' was properly closed.
2020-07-07 14:08:27.320650 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056749d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105641790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105671090>]}
2020-07-07 14:08:27.321164 (MainThread): Flushing usage events
2020-07-07 14:08:30.170786 (MainThread): Encountered an error:
2020-07-07 14:08:30.171001 (MainThread): File  was not found.
2020-07-07 14:08:30.186735 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 165, in open
    handle = cls.get_bigquery_client(connection.credentials)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 147, in get_bigquery_client
    creds = cls.get_bigquery_credentials(profile_credentials)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 130, in get_bigquery_credentials
    credentials, project_id = google.auth.default(scopes=cls.SCOPE)
  File "/usr/local/lib/python3.7/site-packages/google/auth/_default.py", line 308, in default
    credentials, project_id = checker()
  File "/usr/local/lib/python3.7/site-packages/google/auth/_default.py", line 166, in _get_explicit_environ_credentials
    os.environ[environment_vars.CREDENTIALS]
  File "/usr/local/lib/python3.7/site-packages/google/auth/_default.py", line 92, in _load_credentials_from_file
    "File {} was not found.".format(filename)
google.auth.exceptions.DefaultCredentialsError: File  was not found.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 212, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.7/site-packages/dbt/task/runnable.py", line 409, in run
    result = self.execute_with_hooks(selected_uids)
  File "/usr/local/lib/python3.7/site-packages/dbt/task/runnable.py", line 369, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/usr/local/lib/python3.7/site-packages/dbt/task/run.py", line 202, in before_run
    super().before_run(adapter, selected_uids)
  File "/usr/local/lib/python3.7/site-packages/dbt/task/runnable.py", line 355, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/usr/local/lib/python3.7/site-packages/dbt/task/runnable.py", line 489, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/usr/local/Cellar/python/3.7.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/concurrent/futures/_base.py", line 428, in result
    return self.__get_result()
  File "/usr/local/Cellar/python/3.7.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/concurrent/futures/_base.py", line 384, in __get_result
    raise self._exception
  File "/usr/local/Cellar/python/3.7.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/task/runnable.py", line 470, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/impl.py", line 156, in list_schemas
    client = conn.handle
  File "/usr/local/lib/python3.7/site-packages/dbt/contracts/connection.py", line 69, in handle
    self._handle.resolve(self)
  File "/usr/local/lib/python3.7/site-packages/dbt/contracts/connection.py", line 90, in resolve
    return self.opener(connection)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 171, in open
    handle = cls.get_bigquery_client(connection.credentials)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 147, in get_bigquery_client
    creds = cls.get_bigquery_credentials(profile_credentials)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 130, in get_bigquery_credentials
    credentials, project_id = google.auth.default(scopes=cls.SCOPE)
  File "/usr/local/lib/python3.7/site-packages/google/auth/_default.py", line 308, in default
    credentials, project_id = checker()
  File "/usr/local/lib/python3.7/site-packages/google/auth/_default.py", line 166, in _get_explicit_environ_credentials
    os.environ[environment_vars.CREDENTIALS]
  File "/usr/local/lib/python3.7/site-packages/google/auth/_default.py", line 92, in _load_credentials_from_file
    "File {} was not found.".format(filename)
google.auth.exceptions.DefaultCredentialsError: File  was not found.

2020-07-07 14:08:38.862725 (MainThread): Running with dbt=0.17.0
2020-07-07 14:08:39.342492 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-07 14:08:39.343718 (MainThread): Tracking: tracking
2020-07-07 14:08:39.356908 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ba1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052beed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052becd0>]}
2020-07-07 14:08:39.415242 (MainThread): Partial parsing not enabled
2020-07-07 14:08:39.417761 (MainThread): Parsing macros/core.sql
2020-07-07 14:08:39.426960 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-07 14:08:39.439004 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-07 14:08:39.442542 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-07 14:08:39.466452 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-07 14:08:39.506469 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-07 14:08:39.535488 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-07 14:08:39.538863 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-07 14:08:39.547612 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-07 14:08:39.567129 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-07 14:08:39.575993 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-07 14:08:39.584212 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-07 14:08:39.590824 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-07 14:08:39.592789 (MainThread): Parsing macros/etc/query.sql
2020-07-07 14:08:39.594835 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-07 14:08:39.597569 (MainThread): Parsing macros/etc/datetime.sql
2020-07-07 14:08:39.609960 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-07 14:08:39.613532 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-07 14:08:39.616998 (MainThread): Parsing macros/adapters/common.sql
2020-07-07 14:08:39.677095 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-07 14:08:39.679753 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-07 14:08:39.681516 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-07 14:08:39.683725 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-07 14:08:39.687707 (MainThread): Parsing macros/etc.sql
2020-07-07 14:08:39.689497 (MainThread): Parsing macros/catalog.sql
2020-07-07 14:08:39.700014 (MainThread): Parsing macros/adapters.sql
2020-07-07 14:08:39.725620 (MainThread): Parsing macros/materializations/seed.sql
2020-07-07 14:08:39.729185 (MainThread): Parsing macros/materializations/view.sql
2020-07-07 14:08:39.732628 (MainThread): Parsing macros/materializations/table.sql
2020-07-07 14:08:39.747068 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-07 14:08:39.764025 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-07 14:08:39.789019 (MainThread): Partial parsing not enabled
2020-07-07 14:08:39.831395 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-07 14:08:39.831571 (MainThread): Opening a new connection, currently in state init
2020-07-07 14:08:39.866113 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-07 14:08:39.866285 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:08:40.002423 (MainThread): WARNING: Found documentation for resource "creditcards" which was not found or is disabled
2020-07-07 14:08:40.072965 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 1 seed file, 1 source
2020-07-07 14:08:40.073844 (MainThread): 
2020-07-07 14:08:40.074325 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 14:08:40.074464 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:08:40.083848 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-07 14:08:40.084186 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-07 14:08:40.084381 (ThreadPoolExecutor-0_0): Please log into GCP to continue
2020-07-07 14:08:40.084548 (ThreadPoolExecutor-0_0): Executing "gcloud --version"
2020-07-07 14:08:41.715898 (ThreadPoolExecutor-0_0): STDOUT: "b'Google Cloud SDK 298.0.0\nbq 2.0.58\ncore 2020.06.19\ngsutil 4.51\n'"
2020-07-07 14:08:41.716174 (ThreadPoolExecutor-0_0): STDERR: "b'Updates are available for some Cloud SDK components.  To install them,\nplease run:\n  $ gcloud components update'"
2020-07-07 14:08:41.716295 (ThreadPoolExecutor-0_0): Executing "gcloud auth application-default login"
2020-07-07 14:08:47.886734 (ThreadPoolExecutor-0_0): STDOUT: "b''"
2020-07-07 14:08:47.887372 (ThreadPoolExecutor-0_0): STDERR: "b'Your browser has been opened to visit:\n\n    https://accounts.google.com/o/oauth2/auth?client_id=764086051850-6qr4p6gpi6hn506pt8ejuq83di341hur.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8085%2F&scope=openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fcloud-platform+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Faccounts.reauth&code_challenge=c2SvEpokp7DHXh61sa8RP_sSfYg3--SprOgCAQgSh4A&code_challenge_method=S256&access_type=offline&response_type=code&prompt=select_account\n\n\n\n\nCommand killed by keyboard interrupt\n\n'"
2020-07-07 14:08:47.887536 (ThreadPoolExecutor-0_0): command return code=-2
2020-07-07 14:08:47.889048 (MainThread): Connection 'master' was properly closed.
2020-07-07 14:08:47.889233 (MainThread): Connection 'list_prismatic-cider-279015' was properly closed.
2020-07-07 14:08:47.889378 (MainThread): Flushing usage events
2020-07-07 14:08:48.189698 (MainThread): ctrl-c
2020-07-07 14:09:27.086301 (MainThread): Running with dbt=0.17.0
2020-07-07 14:09:27.497076 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-07 14:09:27.498051 (MainThread): Tracking: tracking
2020-07-07 14:09:27.512854 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad62a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6c3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6c3b90>]}
2020-07-07 14:09:27.569695 (MainThread): Partial parsing not enabled
2020-07-07 14:09:27.572959 (MainThread): Parsing macros/core.sql
2020-07-07 14:09:27.580265 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-07 14:09:27.595185 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-07 14:09:27.598316 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-07 14:09:27.621950 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-07 14:09:27.660746 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-07 14:09:27.688006 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-07 14:09:27.691203 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-07 14:09:27.699694 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-07 14:09:27.720292 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-07 14:09:27.730070 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-07 14:09:27.740454 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-07 14:09:27.747077 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-07 14:09:27.748693 (MainThread): Parsing macros/etc/query.sql
2020-07-07 14:09:27.750521 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-07 14:09:27.753068 (MainThread): Parsing macros/etc/datetime.sql
2020-07-07 14:09:27.764692 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-07 14:09:27.768541 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-07 14:09:27.772274 (MainThread): Parsing macros/adapters/common.sql
2020-07-07 14:09:27.834835 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-07 14:09:27.837066 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-07 14:09:27.839270 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-07 14:09:27.841088 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-07 14:09:27.844195 (MainThread): Parsing macros/etc.sql
2020-07-07 14:09:27.845631 (MainThread): Parsing macros/catalog.sql
2020-07-07 14:09:27.853589 (MainThread): Parsing macros/adapters.sql
2020-07-07 14:09:27.874836 (MainThread): Parsing macros/materializations/seed.sql
2020-07-07 14:09:27.877571 (MainThread): Parsing macros/materializations/view.sql
2020-07-07 14:09:27.880333 (MainThread): Parsing macros/materializations/table.sql
2020-07-07 14:09:27.894043 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-07 14:09:27.911285 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-07 14:09:27.970252 (MainThread): Partial parsing not enabled
2020-07-07 14:09:28.054304 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-07 14:09:28.054457 (MainThread): Opening a new connection, currently in state init
2020-07-07 14:09:28.090445 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-07 14:09:28.090598 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:09:28.242119 (MainThread): WARNING: Found documentation for resource "creditcards" which was not found or is disabled
2020-07-07 14:09:28.320008 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 1 seed file, 1 source
2020-07-07 14:09:28.321522 (MainThread): 
2020-07-07 14:09:28.322066 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 14:09:28.322187 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:09:28.327821 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-07 14:09:28.328165 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-07 14:09:30.235900 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-07 14:09:30.236178 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-07 14:09:30.236334 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-07 14:09:30.754360 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 14:09:30.755408 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:09:30.756025 (MainThread): 10:09:30 | Concurrency: 1 threads (target='dev')
2020-07-07 14:09:30.756315 (MainThread): 10:09:30 | 
2020-07-07 14:09:30.759235 (Thread-1): Began running node model.springml_demo_dbt_project.creditcard
2020-07-07 14:09:30.760791 (Thread-1): 10:09:30 | 1 of 2 START view model springml_demo_dataset.creditcard............. [RUN]
2020-07-07 14:09:30.761237 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-07 14:09:30.761357 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-07 14:09:30.761478 (Thread-1): Compiling model.springml_demo_dbt_project.creditcard
2020-07-07 14:09:30.779596 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-07 14:09:30.781832 (Thread-1): finished collecting timing info
2020-07-07 14:09:30.820032 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-07 14:09:30.820591 (Thread-1): On model.springml_demo_dbt_project.creditcard: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
  OPTIONS()
  as 

select country,

sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,

sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,

sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,

from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
group by country 
order by (Amex_payments + Mastercard_payments + Visa_payments) desc;


2020-07-07 14:09:32.975882 (Thread-1): finished collecting timing info
2020-07-07 14:09:32.977262 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f999735f-c6f6-4920-81db-c0de54340dec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afb8e10>]}
2020-07-07 14:09:32.979327 (Thread-1): 10:09:32 | 1 of 2 OK created view model springml_demo_dataset.creditcard........ [CREATE VIEW in 2.22s]
2020-07-07 14:09:32.979594 (Thread-1): Finished running node model.springml_demo_dbt_project.creditcard
2020-07-07 14:09:32.979875 (Thread-1): Began running node model.springml_demo_dbt_project.payments
2020-07-07 14:09:32.981292 (Thread-1): 10:09:32 | 2 of 2 START view model springml_demo_dataset.payments............... [RUN]
2020-07-07 14:09:32.981843 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-07 14:09:32.981982 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.creditcard).
2020-07-07 14:09:32.982099 (Thread-1): Compiling model.springml_demo_dbt_project.payments
2020-07-07 14:09:33.010043 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.payments"
2020-07-07 14:09:33.011524 (Thread-1): finished collecting timing info
2020-07-07 14:09:33.030803 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.payments"
2020-07-07 14:09:33.032207 (Thread-1): On model.springml_demo_dbt_project.payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
  OPTIONS()
  as select payment_type, 
    count(*) as number_of_payments, 
    sum(price) as total_price 
from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where country like "United States"
group by payment_type;


2020-07-07 14:09:34.014961 (Thread-1): finished collecting timing info
2020-07-07 14:09:34.015960 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f999735f-c6f6-4920-81db-c0de54340dec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb41f50>]}
2020-07-07 14:09:34.017479 (Thread-1): 10:09:34 | 2 of 2 OK created view model springml_demo_dataset.payments.......... [CREATE VIEW in 1.03s]
2020-07-07 14:09:34.017689 (Thread-1): Finished running node model.springml_demo_dbt_project.payments
2020-07-07 14:09:34.058844 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 14:09:34.059094 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:09:34.059539 (MainThread): 10:09:34 | 
2020-07-07 14:09:34.059719 (MainThread): 10:09:34 | Finished running 2 view models in 5.74s.
2020-07-07 14:09:34.059880 (MainThread): Connection 'master' was properly closed.
2020-07-07 14:09:34.060003 (MainThread): Connection 'model.springml_demo_dbt_project.payments' was left open.
2020-07-07 14:09:34.069770 (MainThread): 
2020-07-07 14:09:34.070087 (MainThread): Completed successfully
2020-07-07 14:09:34.070457 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-07-07 14:09:34.070893 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb35510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb45b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb45e50>]}
2020-07-07 14:09:34.071188 (MainThread): Flushing usage events
2020-07-07 14:16:39.731638 (MainThread): Running with dbt=0.17.0
2020-07-07 14:16:40.204203 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-07-07 14:16:40.207512 (MainThread): Tracking: tracking
2020-07-07 14:16:40.223970 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e209950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d101690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1c90d0>]}
2020-07-07 14:16:40.251967 (MainThread): Partial parsing not enabled
2020-07-07 14:16:40.254917 (MainThread): Parsing macros/core.sql
2020-07-07 14:16:40.290314 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-07 14:16:40.300722 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-07 14:16:40.303591 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-07 14:16:40.331882 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-07 14:16:40.366974 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-07 14:16:40.398044 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-07 14:16:40.402653 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-07 14:16:40.413216 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-07 14:16:40.430863 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-07 14:16:40.443659 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-07 14:16:40.454250 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-07 14:16:40.461365 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-07 14:16:40.463198 (MainThread): Parsing macros/etc/query.sql
2020-07-07 14:16:40.465065 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-07 14:16:40.467658 (MainThread): Parsing macros/etc/datetime.sql
2020-07-07 14:16:40.478879 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-07 14:16:40.481949 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-07 14:16:40.484854 (MainThread): Parsing macros/adapters/common.sql
2020-07-07 14:16:40.543632 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-07 14:16:40.545585 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-07 14:16:40.547292 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-07 14:16:40.549258 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-07 14:16:40.552547 (MainThread): Parsing macros/etc.sql
2020-07-07 14:16:40.553581 (MainThread): Parsing macros/catalog.sql
2020-07-07 14:16:40.560899 (MainThread): Parsing macros/adapters.sql
2020-07-07 14:16:40.580869 (MainThread): Parsing macros/materializations/seed.sql
2020-07-07 14:16:40.583851 (MainThread): Parsing macros/materializations/view.sql
2020-07-07 14:16:40.586860 (MainThread): Parsing macros/materializations/table.sql
2020-07-07 14:16:40.600232 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-07 14:16:40.616126 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-07 14:16:40.641964 (MainThread): Partial parsing not enabled
2020-07-07 14:16:40.699095 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-07 14:16:40.699309 (MainThread): Opening a new connection, currently in state init
2020-07-07 14:16:40.736083 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-07 14:16:40.736237 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:16:40.790107 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3ff990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e402650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e402890>]}
2020-07-07 14:16:40.790405 (MainThread): Flushing usage events
2020-07-07 14:16:43.547962 (MainThread): Connection 'model.springml_demo_dbt_project.creditcard' was properly closed.
2020-07-07 14:16:43.548553 (MainThread): Encountered an error:
2020-07-07 14:16:43.548787 (MainThread): Compilation Error
  Invalid test config given in models/base/schema.yml:
  	test definition dictionary must have exactly one key, got [('accepted_values', None), ('values', ['Mastercard', 'Amex', 'Visa', 'Diners'])] instead (2 keys)
  	@: UnparsedNodeUpdate(original_file_path='model...ne)
2020-07-07 14:16:43.572153 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/schemas.py", line 355, in _parse_generic_test
    render_ctx=render_ctx,
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/schema_test_builders.py", line 192, in __init__
    test_name, test_args = self.extract_test_args(test, column_name)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/schema_test_builders.py", line 243, in extract_test_args
    ' {} instead ({} keys)'.format(test, len(test))
  File "/usr/local/lib/python3.7/site-packages/dbt/exceptions.py", line 392, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  test definition dictionary must have exactly one key, got [('accepted_values', None), ('values', ['Mastercard', 'Amex', 'Visa', 'Diners'])] instead (2 keys)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 212, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.7/site-packages/dbt/task/runnable.py", line 389, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.7/site-packages/dbt/task/runnable.py", line 103, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.7/site-packages/dbt/task/runnable.py", line 71, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.7/site-packages/dbt/task/runnable.py", line 60, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.7/site-packages/dbt/perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 641, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 356, in load_all
    loader.load(internal_manifest=internal_manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 212, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 186, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 142, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/schemas.py", line 534, in parse_file
    self.parse_tests(test_block)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/schemas.py", line 500, in parse_tests
    self.parse_column_tests(block, column)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/schemas.py", line 229, in parse_column_tests
    self.parse_test(block, test, column)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/schemas.py", line 496, in parse_test
    self.parse_node(block)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/schemas.py", line 446, in parse_node
    column_name=block.column_name,
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/schemas.py", line 364, in _parse_generic_test
    raise CompilationException(msg) from exc
dbt.exceptions.CompilationException: Compilation Error
  Invalid test config given in models/base/schema.yml:
  	test definition dictionary must have exactly one key, got [('accepted_values', None), ('values', ['Mastercard', 'Amex', 'Visa', 'Diners'])] instead (2 keys)
  	@: UnparsedNodeUpdate(original_file_path='model...ne)

2020-07-07 14:17:43.733446 (MainThread): Running with dbt=0.17.0
2020-07-07 14:17:44.261669 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-07-07 14:17:44.263243 (MainThread): Tracking: tracking
2020-07-07 14:17:44.280719 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2dd650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0b1ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2e1f10>]}
2020-07-07 14:17:44.308863 (MainThread): Partial parsing not enabled
2020-07-07 14:17:44.311904 (MainThread): Parsing macros/core.sql
2020-07-07 14:17:44.352768 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-07 14:17:44.365788 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-07 14:17:44.368989 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-07 14:17:44.400911 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-07 14:17:44.442458 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-07 14:17:44.470663 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-07 14:17:44.473557 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-07 14:17:44.485681 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-07 14:17:44.505879 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-07 14:17:44.517071 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-07 14:17:44.525208 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-07 14:17:44.531529 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-07 14:17:44.533198 (MainThread): Parsing macros/etc/query.sql
2020-07-07 14:17:44.535022 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-07 14:17:44.537926 (MainThread): Parsing macros/etc/datetime.sql
2020-07-07 14:17:44.553660 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-07 14:17:44.557422 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-07 14:17:44.561087 (MainThread): Parsing macros/adapters/common.sql
2020-07-07 14:17:44.639403 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-07 14:17:44.640964 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-07 14:17:44.642686 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-07 14:17:44.644272 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-07 14:17:44.649773 (MainThread): Parsing macros/etc.sql
2020-07-07 14:17:44.651312 (MainThread): Parsing macros/catalog.sql
2020-07-07 14:17:44.660824 (MainThread): Parsing macros/adapters.sql
2020-07-07 14:17:44.689856 (MainThread): Parsing macros/materializations/seed.sql
2020-07-07 14:17:44.697344 (MainThread): Parsing macros/materializations/view.sql
2020-07-07 14:17:44.701780 (MainThread): Parsing macros/materializations/table.sql
2020-07-07 14:17:44.722822 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-07 14:17:44.751942 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-07 14:17:44.785803 (MainThread): Partial parsing not enabled
2020-07-07 14:17:44.841956 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-07 14:17:44.842114 (MainThread): Opening a new connection, currently in state init
2020-07-07 14:17:44.879839 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-07 14:17:44.880001 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:17:45.164784 (MainThread): WARNING: Found documentation for resource "creditcards" which was not found or is disabled
2020-07-07 14:17:45.165121 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.unique_creditcards_country' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-07 14:17:45.165274 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_country' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-07 14:17:45.165465 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Amex_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-07 14:17:45.165660 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Mastercard_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-07 14:17:45.165795 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Visa_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-07 14:17:45.267489 (MainThread): Found 2 models, 3 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 1 seed file, 1 source
2020-07-07 14:17:45.268764 (MainThread): 
2020-07-07 14:17:45.269408 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 14:17:45.269579 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:17:45.286945 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-07 14:17:45.287183 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-07-07 14:17:45.288965 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-07 14:17:45.883854 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 14:17:45.884070 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:17:45.884400 (MainThread): 10:17:45 | Concurrency: 1 threads (target='dev')
2020-07-07 14:17:45.884591 (MainThread): 10:17:45 | 
2020-07-07 14:17:45.888585 (Thread-1): Began running node test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners
2020-07-07 14:17:45.888875 (Thread-1): 10:17:45 | 1 of 3 START test accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners [RUN]
2020-07-07 14:17:45.889309 (Thread-1): Acquiring new bigquery connection "test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners".
2020-07-07 14:17:45.889447 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-07 14:17:45.889587 (Thread-1): Compiling test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners
2020-07-07 14:17:45.911451 (Thread-1): Writing injected SQL for node "test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners"
2020-07-07 14:17:45.912142 (Thread-1): finished collecting timing info
2020-07-07 14:17:45.912454 (Thread-1): On test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners"} */





with all_values as (

    select distinct
        payment_type as value_field

    from `prismatic-cider-279015`.`springml_demo_dataset`.`payments`

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'Mastercard','Amex','Visa','Diners'
    )
)

select count(*) as validation_errors
from validation_errors


2020-07-07 14:17:48.410607 (Thread-1): finished collecting timing info
2020-07-07 14:17:48.411462 (Thread-1): 10:17:48 | 1 of 3 PASS accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners [PASS in 2.52s]
2020-07-07 14:17:48.411737 (Thread-1): Finished running node test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners
2020-07-07 14:17:48.411999 (Thread-1): Began running node test.springml_demo_dbt_project.not_null_payments_number_of_payments
2020-07-07 14:17:48.412235 (Thread-1): 10:17:48 | 2 of 3 START test not_null_payments_number_of_payments............... [RUN]
2020-07-07 14:17:48.412690 (Thread-1): Acquiring new bigquery connection "test.springml_demo_dbt_project.not_null_payments_number_of_payments".
2020-07-07 14:17:48.412978 (Thread-1): Re-using an available connection from the pool (formerly test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners).
2020-07-07 14:17:48.413147 (Thread-1): Compiling test.springml_demo_dbt_project.not_null_payments_number_of_payments
2020-07-07 14:17:48.424553 (Thread-1): Writing injected SQL for node "test.springml_demo_dbt_project.not_null_payments_number_of_payments"
2020-07-07 14:17:48.425113 (Thread-1): finished collecting timing info
2020-07-07 14:17:48.425430 (Thread-1): On test.springml_demo_dbt_project.not_null_payments_number_of_payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "test.springml_demo_dbt_project.not_null_payments_number_of_payments"} */




select count(*) as validation_errors
from `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
where number_of_payments is null


2020-07-07 14:17:49.986837 (Thread-1): finished collecting timing info
2020-07-07 14:17:49.987964 (Thread-1): 10:17:49 | 2 of 3 PASS not_null_payments_number_of_payments..................... [PASS in 1.58s]
2020-07-07 14:17:49.988161 (Thread-1): Finished running node test.springml_demo_dbt_project.not_null_payments_number_of_payments
2020-07-07 14:17:49.988416 (Thread-1): Began running node test.springml_demo_dbt_project.not_null_payments_total_price
2020-07-07 14:17:49.988712 (Thread-1): 10:17:49 | 3 of 3 START test not_null_payments_total_price...................... [RUN]
2020-07-07 14:17:49.989111 (Thread-1): Acquiring new bigquery connection "test.springml_demo_dbt_project.not_null_payments_total_price".
2020-07-07 14:17:49.989241 (Thread-1): Re-using an available connection from the pool (formerly test.springml_demo_dbt_project.not_null_payments_number_of_payments).
2020-07-07 14:17:49.989369 (Thread-1): Compiling test.springml_demo_dbt_project.not_null_payments_total_price
2020-07-07 14:17:50.000317 (Thread-1): Writing injected SQL for node "test.springml_demo_dbt_project.not_null_payments_total_price"
2020-07-07 14:17:50.000862 (Thread-1): finished collecting timing info
2020-07-07 14:17:50.001175 (Thread-1): On test.springml_demo_dbt_project.not_null_payments_total_price: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "test.springml_demo_dbt_project.not_null_payments_total_price"} */




select count(*) as validation_errors
from `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
where total_price is null


2020-07-07 14:17:52.785616 (Thread-1): finished collecting timing info
2020-07-07 14:17:52.786479 (Thread-1): 10:17:52 | 3 of 3 PASS not_null_payments_total_price............................ [PASS in 2.80s]
2020-07-07 14:17:52.786744 (Thread-1): Finished running node test.springml_demo_dbt_project.not_null_payments_total_price
2020-07-07 14:17:52.814658 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 14:17:52.814913 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:17:52.815364 (MainThread): 10:17:52 | 
2020-07-07 14:17:52.815609 (MainThread): 10:17:52 | Finished running 3 tests in 7.55s.
2020-07-07 14:17:52.815945 (MainThread): Connection 'master' was properly closed.
2020-07-07 14:17:52.816179 (MainThread): Connection 'test.springml_demo_dbt_project.not_null_payments_total_price' was left open.
2020-07-07 14:17:52.831789 (MainThread): 
2020-07-07 14:17:52.832145 (MainThread): Completed successfully
2020-07-07 14:17:52.832599 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2020-07-07 14:17:52.833185 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6d2850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5f5990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5f5790>]}
2020-07-07 14:17:52.833426 (MainThread): Flushing usage events
2020-07-07 14:18:48.928038 (MainThread): Running with dbt=0.17.0
2020-07-07 14:18:49.450076 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-07-07 14:18:49.451133 (MainThread): Tracking: tracking
2020-07-07 14:18:49.464365 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fe4110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fe8f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fe8d90>]}
2020-07-07 14:18:49.520965 (MainThread): Partial parsing not enabled
2020-07-07 14:18:49.523717 (MainThread): Parsing macros/core.sql
2020-07-07 14:18:49.532694 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-07 14:18:49.546098 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-07 14:18:49.549346 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-07 14:18:49.575530 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-07 14:18:49.617123 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-07 14:18:49.644738 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-07 14:18:49.648981 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-07 14:18:49.659132 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-07 14:18:49.677209 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-07 14:18:49.686387 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-07 14:18:49.694487 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-07 14:18:49.701747 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-07 14:18:49.703450 (MainThread): Parsing macros/etc/query.sql
2020-07-07 14:18:49.705594 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-07 14:18:49.708231 (MainThread): Parsing macros/etc/datetime.sql
2020-07-07 14:18:49.721190 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-07 14:18:49.724501 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-07 14:18:49.727396 (MainThread): Parsing macros/adapters/common.sql
2020-07-07 14:18:49.790513 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-07 14:18:49.793215 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-07 14:18:49.795479 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-07 14:18:49.798136 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-07 14:18:49.802144 (MainThread): Parsing macros/etc.sql
2020-07-07 14:18:49.804001 (MainThread): Parsing macros/catalog.sql
2020-07-07 14:18:49.812491 (MainThread): Parsing macros/adapters.sql
2020-07-07 14:18:49.832509 (MainThread): Parsing macros/materializations/seed.sql
2020-07-07 14:18:49.836414 (MainThread): Parsing macros/materializations/view.sql
2020-07-07 14:18:49.840260 (MainThread): Parsing macros/materializations/table.sql
2020-07-07 14:18:49.854143 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-07 14:18:49.869655 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-07 14:18:49.894032 (MainThread): Partial parsing not enabled
2020-07-07 14:18:49.933646 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-07 14:18:49.933817 (MainThread): Opening a new connection, currently in state init
2020-07-07 14:18:49.966039 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-07 14:18:49.966204 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:18:50.220272 (MainThread): WARNING: Found documentation for resource "creditcards" which was not found or is disabled
2020-07-07 14:18:50.220563 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.unique_creditcards_country' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-07 14:18:50.220708 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_country' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-07 14:18:50.220836 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Amex_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-07 14:18:50.220960 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Mastercard_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-07 14:18:50.221093 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Visa_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-07 14:18:50.329769 (MainThread): Found 2 models, 3 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 1 seed file, 1 source
2020-07-07 14:18:50.330672 (MainThread): 
2020-07-07 14:18:50.331103 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 14:18:50.331211 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:18:50.346046 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-07 14:18:50.346275 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-07-07 14:18:50.347013 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-07 14:18:59.200219 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 14:18:59.202168 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:18:59.202810 (MainThread): 10:18:59 | Concurrency: 1 threads (target='dev')
2020-07-07 14:18:59.203110 (MainThread): 10:18:59 | 
2020-07-07 14:18:59.205840 (Thread-1): Began running node test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners
2020-07-07 14:18:59.206131 (Thread-1): 10:18:59 | 1 of 3 START test accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners [RUN]
2020-07-07 14:18:59.206596 (Thread-1): Acquiring new bigquery connection "test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners".
2020-07-07 14:18:59.206751 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-07 14:18:59.206891 (Thread-1): Compiling test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners
2020-07-07 14:18:59.231965 (Thread-1): Writing injected SQL for node "test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners"
2020-07-07 14:18:59.233425 (Thread-1): finished collecting timing info
2020-07-07 14:18:59.233936 (Thread-1): On test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners"} */





with all_values as (

    select distinct
        payment_type as value_field

    from `prismatic-cider-279015`.`springml_demo_dataset`.`payments`

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'Mastercard','Amex','Visa','Diners'
    )
)

select count(*) as validation_errors
from validation_errors


2020-07-07 14:18:59.310986 (MainThread): 10:18:59 | The bigquery adapter does not support query cancellation. Some queries may still be running!
2020-07-07 14:18:59.311488 (MainThread): Connection 'master' was properly closed.
2020-07-07 14:18:59.311701 (MainThread): Connection 'test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners' was left open.
2020-07-07 14:18:59.311862 (MainThread): Flushing usage events
2020-07-07 14:19:01.343150 (MainThread): ctrl-c
2020-07-07 14:19:07.174995 (MainThread): Running with dbt=0.17.0
2020-07-07 14:19:07.710752 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-07 14:19:07.721394 (MainThread): Tracking: tracking
2020-07-07 14:19:07.752573 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109980650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093a5bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109984dd0>]}
2020-07-07 14:19:07.809830 (MainThread): Partial parsing not enabled
2020-07-07 14:19:07.812623 (MainThread): Parsing macros/core.sql
2020-07-07 14:19:07.826449 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-07 14:19:07.838323 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-07 14:19:07.841358 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-07 14:19:07.863355 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-07 14:19:07.899460 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-07 14:19:07.930060 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-07 14:19:07.933874 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-07 14:19:07.943313 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-07 14:19:07.966809 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-07 14:19:07.976343 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-07 14:19:07.988270 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-07 14:19:07.995464 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-07 14:19:07.997082 (MainThread): Parsing macros/etc/query.sql
2020-07-07 14:19:07.998932 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-07 14:19:08.001519 (MainThread): Parsing macros/etc/datetime.sql
2020-07-07 14:19:08.013119 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-07 14:19:08.016913 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-07 14:19:08.019844 (MainThread): Parsing macros/adapters/common.sql
2020-07-07 14:19:08.078711 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-07 14:19:08.081034 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-07 14:19:08.082960 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-07 14:19:08.084915 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-07 14:19:08.088322 (MainThread): Parsing macros/etc.sql
2020-07-07 14:19:08.089615 (MainThread): Parsing macros/catalog.sql
2020-07-07 14:19:08.097286 (MainThread): Parsing macros/adapters.sql
2020-07-07 14:19:08.120177 (MainThread): Parsing macros/materializations/seed.sql
2020-07-07 14:19:08.124936 (MainThread): Parsing macros/materializations/view.sql
2020-07-07 14:19:08.128885 (MainThread): Parsing macros/materializations/table.sql
2020-07-07 14:19:08.143131 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-07 14:19:08.158916 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-07 14:19:08.184040 (MainThread): Partial parsing not enabled
2020-07-07 14:19:08.236375 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-07 14:19:08.236567 (MainThread): Opening a new connection, currently in state init
2020-07-07 14:19:08.273385 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-07 14:19:08.273541 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:19:08.584517 (MainThread): WARNING: Found documentation for resource "creditcards" which was not found or is disabled
2020-07-07 14:19:08.584799 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.unique_creditcards_country' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-07 14:19:08.584942 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_country' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-07 14:19:08.585104 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Amex_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-07 14:19:08.585307 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Mastercard_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-07 14:19:08.585468 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Visa_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-07 14:19:08.685851 (MainThread): Found 2 models, 3 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 1 seed file, 1 source
2020-07-07 14:19:08.686782 (MainThread): 
2020-07-07 14:19:08.687167 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 14:19:08.687273 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:19:08.691103 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-07 14:19:08.691351 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-07 14:19:09.653699 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-07 14:19:09.653936 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-07 14:19:09.654128 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-07 14:19:10.011364 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 14:19:10.011558 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:19:10.011904 (MainThread): 10:19:10 | Concurrency: 1 threads (target='dev')
2020-07-07 14:19:10.012085 (MainThread): 10:19:10 | 
2020-07-07 14:19:10.015795 (Thread-1): Began running node model.springml_demo_dbt_project.creditcard
2020-07-07 14:19:10.017361 (Thread-1): 10:19:10 | 1 of 2 START view model springml_demo_dataset.creditcard............. [RUN]
2020-07-07 14:19:10.017904 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-07 14:19:10.018199 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-07 14:19:10.018344 (Thread-1): Compiling model.springml_demo_dbt_project.creditcard
2020-07-07 14:19:10.036466 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-07 14:19:10.036989 (Thread-1): finished collecting timing info
2020-07-07 14:19:10.072244 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-07 14:19:10.073801 (Thread-1): On model.springml_demo_dbt_project.creditcard: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
  OPTIONS()
  as 

select country,

sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,

sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,

sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,

from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
group by country 
order by (Amex_payments + Mastercard_payments + Visa_payments) desc;


2020-07-07 14:19:10.643647 (Thread-1): finished collecting timing info
2020-07-07 14:19:10.644423 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ee015ee-738c-4d50-9fc5-c56f5210ff21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109da2550>]}
2020-07-07 14:19:10.645646 (Thread-1): 10:19:10 | 1 of 2 OK created view model springml_demo_dataset.creditcard........ [CREATE VIEW in 0.63s]
2020-07-07 14:19:10.645804 (Thread-1): Finished running node model.springml_demo_dbt_project.creditcard
2020-07-07 14:19:10.645973 (Thread-1): Began running node model.springml_demo_dbt_project.payments
2020-07-07 14:19:10.647266 (Thread-1): 10:19:10 | 2 of 2 START view model springml_demo_dataset.payments............... [RUN]
2020-07-07 14:19:10.647629 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-07 14:19:10.647746 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.creditcard).
2020-07-07 14:19:10.647849 (Thread-1): Compiling model.springml_demo_dbt_project.payments
2020-07-07 14:19:10.658456 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.payments"
2020-07-07 14:19:10.660723 (Thread-1): finished collecting timing info
2020-07-07 14:19:10.665308 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.payments"
2020-07-07 14:19:10.665768 (Thread-1): On model.springml_demo_dbt_project.payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
  OPTIONS()
  as select payment_type, 
    count(*) as number_of_payments, 
    sum(price) as total_price 
from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where country like "United States"
group by payment_type;


2020-07-07 14:19:11.340955 (Thread-1): finished collecting timing info
2020-07-07 14:19:11.341823 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ee015ee-738c-4d50-9fc5-c56f5210ff21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109da2550>]}
2020-07-07 14:19:11.343157 (Thread-1): 10:19:11 | 2 of 2 OK created view model springml_demo_dataset.payments.......... [CREATE VIEW in 0.69s]
2020-07-07 14:19:11.343356 (Thread-1): Finished running node model.springml_demo_dbt_project.payments
2020-07-07 14:19:11.357630 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 14:19:11.357876 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:19:11.358350 (MainThread): 10:19:11 | 
2020-07-07 14:19:11.358564 (MainThread): 10:19:11 | Finished running 2 view models in 2.67s.
2020-07-07 14:19:11.358759 (MainThread): Connection 'master' was properly closed.
2020-07-07 14:19:11.358911 (MainThread): Connection 'model.springml_demo_dbt_project.payments' was left open.
2020-07-07 14:19:11.368286 (MainThread): 
2020-07-07 14:19:11.368464 (MainThread): Completed successfully
2020-07-07 14:19:11.368708 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-07-07 14:19:11.369001 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cb7510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ecc190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d76d10>]}
2020-07-07 14:19:11.369241 (MainThread): Flushing usage events
2020-07-07 14:19:14.371442 (MainThread): Running with dbt=0.17.0
2020-07-07 14:19:14.591075 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-07-07 14:19:14.592187 (MainThread): Tracking: tracking
2020-07-07 14:19:14.607170 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104edc110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ee0f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ee0d50>]}
2020-07-07 14:19:14.662409 (MainThread): Partial parsing not enabled
2020-07-07 14:19:14.664177 (MainThread): Parsing macros/core.sql
2020-07-07 14:19:14.669437 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-07 14:19:14.678514 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-07 14:19:14.680517 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-07 14:19:14.701775 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-07 14:19:14.737796 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-07 14:19:14.764397 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-07 14:19:14.766663 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-07 14:19:14.774583 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-07 14:19:14.790875 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-07 14:19:14.799100 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-07 14:19:14.806628 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-07 14:19:14.812360 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-07 14:19:14.813467 (MainThread): Parsing macros/etc/query.sql
2020-07-07 14:19:14.815100 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-07 14:19:14.817075 (MainThread): Parsing macros/etc/datetime.sql
2020-07-07 14:19:14.827554 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-07 14:19:14.829876 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-07 14:19:14.831788 (MainThread): Parsing macros/adapters/common.sql
2020-07-07 14:19:14.888038 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-07 14:19:14.889453 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-07 14:19:14.890527 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-07 14:19:14.891792 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-07 14:19:14.894553 (MainThread): Parsing macros/etc.sql
2020-07-07 14:19:14.895328 (MainThread): Parsing macros/catalog.sql
2020-07-07 14:19:14.902148 (MainThread): Parsing macros/adapters.sql
2020-07-07 14:19:14.921206 (MainThread): Parsing macros/materializations/seed.sql
2020-07-07 14:19:14.923608 (MainThread): Parsing macros/materializations/view.sql
2020-07-07 14:19:14.925960 (MainThread): Parsing macros/materializations/table.sql
2020-07-07 14:19:14.937880 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-07 14:19:14.953130 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-07 14:19:14.977110 (MainThread): Partial parsing not enabled
2020-07-07 14:19:15.016941 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-07 14:19:15.017109 (MainThread): Opening a new connection, currently in state init
2020-07-07 14:19:15.049330 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-07 14:19:15.049498 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:19:15.303089 (MainThread): WARNING: Found documentation for resource "creditcards" which was not found or is disabled
2020-07-07 14:19:15.303371 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.unique_creditcards_country' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-07 14:19:15.303521 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_country' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-07 14:19:15.303648 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Amex_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-07 14:19:15.303767 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Mastercard_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-07 14:19:15.303908 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Visa_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-07 14:19:15.402632 (MainThread): Found 2 models, 3 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 1 seed file, 1 source
2020-07-07 14:19:15.403732 (MainThread): 
2020-07-07 14:19:15.404184 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 14:19:15.404305 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:19:15.421860 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-07 14:19:15.422088 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-07-07 14:19:15.422809 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-07 14:19:16.459148 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 14:19:16.459374 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:19:16.459745 (MainThread): 10:19:16 | Concurrency: 1 threads (target='dev')
2020-07-07 14:19:16.459963 (MainThread): 10:19:16 | 
2020-07-07 14:19:16.462700 (Thread-1): Began running node test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners
2020-07-07 14:19:16.463000 (Thread-1): 10:19:16 | 1 of 3 START test accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners [RUN]
2020-07-07 14:19:16.463411 (Thread-1): Acquiring new bigquery connection "test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners".
2020-07-07 14:19:16.463529 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-07 14:19:16.463671 (Thread-1): Compiling test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners
2020-07-07 14:19:16.487313 (Thread-1): Writing injected SQL for node "test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners"
2020-07-07 14:19:16.487760 (Thread-1): finished collecting timing info
2020-07-07 14:19:16.488053 (Thread-1): On test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners"} */





with all_values as (

    select distinct
        payment_type as value_field

    from `prismatic-cider-279015`.`springml_demo_dataset`.`payments`

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'Mastercard','Amex','Visa','Diners'
    )
)

select count(*) as validation_errors
from validation_errors


2020-07-07 14:19:18.787106 (Thread-1): finished collecting timing info
2020-07-07 14:19:18.789985 (Thread-1): 10:19:18 | 1 of 3 PASS accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners [PASS in 2.33s]
2020-07-07 14:19:18.790350 (Thread-1): Finished running node test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners
2020-07-07 14:19:18.790706 (Thread-1): Began running node test.springml_demo_dbt_project.not_null_payments_number_of_payments
2020-07-07 14:19:18.790958 (Thread-1): 10:19:18 | 2 of 3 START test not_null_payments_number_of_payments............... [RUN]
2020-07-07 14:19:18.791435 (Thread-1): Acquiring new bigquery connection "test.springml_demo_dbt_project.not_null_payments_number_of_payments".
2020-07-07 14:19:18.791600 (Thread-1): Re-using an available connection from the pool (formerly test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners).
2020-07-07 14:19:18.791768 (Thread-1): Compiling test.springml_demo_dbt_project.not_null_payments_number_of_payments
2020-07-07 14:19:18.803624 (Thread-1): Writing injected SQL for node "test.springml_demo_dbt_project.not_null_payments_number_of_payments"
2020-07-07 14:19:18.804170 (Thread-1): finished collecting timing info
2020-07-07 14:19:18.804500 (Thread-1): On test.springml_demo_dbt_project.not_null_payments_number_of_payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "test.springml_demo_dbt_project.not_null_payments_number_of_payments"} */




select count(*) as validation_errors
from `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
where number_of_payments is null


2020-07-07 14:19:20.970100 (Thread-1): finished collecting timing info
2020-07-07 14:19:20.970962 (Thread-1): 10:19:20 | 2 of 3 PASS not_null_payments_number_of_payments..................... [PASS in 2.18s]
2020-07-07 14:19:20.971201 (Thread-1): Finished running node test.springml_demo_dbt_project.not_null_payments_number_of_payments
2020-07-07 14:19:20.971457 (Thread-1): Began running node test.springml_demo_dbt_project.not_null_payments_total_price
2020-07-07 14:19:20.971685 (Thread-1): 10:19:20 | 3 of 3 START test not_null_payments_total_price...................... [RUN]
2020-07-07 14:19:20.972107 (Thread-1): Acquiring new bigquery connection "test.springml_demo_dbt_project.not_null_payments_total_price".
2020-07-07 14:19:20.972268 (Thread-1): Re-using an available connection from the pool (formerly test.springml_demo_dbt_project.not_null_payments_number_of_payments).
2020-07-07 14:19:20.972431 (Thread-1): Compiling test.springml_demo_dbt_project.not_null_payments_total_price
2020-07-07 14:19:20.984320 (Thread-1): Writing injected SQL for node "test.springml_demo_dbt_project.not_null_payments_total_price"
2020-07-07 14:19:20.984898 (Thread-1): finished collecting timing info
2020-07-07 14:19:20.985224 (Thread-1): On test.springml_demo_dbt_project.not_null_payments_total_price: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "test.springml_demo_dbt_project.not_null_payments_total_price"} */




select count(*) as validation_errors
from `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
where total_price is null


2020-07-07 14:19:23.668988 (Thread-1): finished collecting timing info
2020-07-07 14:19:23.669926 (Thread-1): 10:19:23 | 3 of 3 PASS not_null_payments_total_price............................ [PASS in 2.70s]
2020-07-07 14:19:23.670171 (Thread-1): Finished running node test.springml_demo_dbt_project.not_null_payments_total_price
2020-07-07 14:19:23.705652 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 14:19:23.705975 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:19:23.706505 (MainThread): 10:19:23 | 
2020-07-07 14:19:23.706765 (MainThread): 10:19:23 | Finished running 3 tests in 8.30s.
2020-07-07 14:19:23.707048 (MainThread): Connection 'master' was properly closed.
2020-07-07 14:19:23.707272 (MainThread): Connection 'test.springml_demo_dbt_project.not_null_payments_total_price' was left open.
2020-07-07 14:19:23.721972 (MainThread): 
2020-07-07 14:19:23.722173 (MainThread): Completed successfully
2020-07-07 14:19:23.722321 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2020-07-07 14:19:23.722567 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10520e390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105213a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10512e410>]}
2020-07-07 14:19:23.722807 (MainThread): Flushing usage events
2020-07-07 14:38:53.327242 (MainThread): Running with dbt=0.17.0
2020-07-07 14:38:53.929941 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-07 14:38:53.933534 (MainThread): Tracking: tracking
2020-07-07 14:38:53.960345 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fb9510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fbdf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fbdd10>]}
2020-07-07 14:38:54.016808 (MainThread): Partial parsing not enabled
2020-07-07 14:38:54.035099 (MainThread): Parsing macros/core.sql
2020-07-07 14:38:54.052069 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-07 14:38:54.063100 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-07 14:38:54.065718 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-07 14:38:54.086340 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-07 14:38:54.121632 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-07 14:38:54.148670 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-07 14:38:54.153173 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-07 14:38:54.163817 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-07 14:38:54.181005 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-07 14:38:54.189743 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-07 14:38:54.197975 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-07 14:38:54.204274 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-07 14:38:54.205956 (MainThread): Parsing macros/etc/query.sql
2020-07-07 14:38:54.207812 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-07 14:38:54.210408 (MainThread): Parsing macros/etc/datetime.sql
2020-07-07 14:38:54.221524 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-07 14:38:54.224427 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-07 14:38:54.227801 (MainThread): Parsing macros/adapters/common.sql
2020-07-07 14:38:54.286958 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-07 14:38:54.289473 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-07 14:38:54.291390 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-07 14:38:54.293874 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-07 14:38:54.298076 (MainThread): Parsing macros/etc.sql
2020-07-07 14:38:54.300028 (MainThread): Parsing macros/catalog.sql
2020-07-07 14:38:54.309964 (MainThread): Parsing macros/adapters.sql
2020-07-07 14:38:54.330315 (MainThread): Parsing macros/materializations/seed.sql
2020-07-07 14:38:54.333200 (MainThread): Parsing macros/materializations/view.sql
2020-07-07 14:38:54.336204 (MainThread): Parsing macros/materializations/table.sql
2020-07-07 14:38:54.348799 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-07 14:38:54.364612 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-07 14:38:54.403914 (MainThread): Partial parsing not enabled
2020-07-07 14:38:54.467985 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-07 14:38:54.468176 (MainThread): Opening a new connection, currently in state init
2020-07-07 14:38:54.504909 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-07 14:38:54.505108 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:38:54.531715 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-07 14:38:54.531878 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:38:54.791966 (MainThread): WARNING: Found documentation for resource "creditcards" which was not found or is disabled
2020-07-07 14:38:54.792268 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.unique_creditcards_country' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-07 14:38:54.792417 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_country' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-07 14:38:54.792579 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Amex_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-07 14:38:54.792742 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Mastercard_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-07 14:38:54.792879 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Visa_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-07 14:38:54.897508 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 1 seed file, 1 source
2020-07-07 14:38:54.898779 (MainThread): 
2020-07-07 14:38:54.899218 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 14:38:54.899321 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:38:54.903518 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-07 14:38:54.903752 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-07 14:38:54.905766 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-07 14:38:57.777999 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-07 14:38:57.778264 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-07 14:38:57.778436 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-07 14:38:57.923227 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 14:38:57.923423 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:38:57.923814 (MainThread): 10:38:57 | Concurrency: 1 threads (target='dev')
2020-07-07 14:38:57.924006 (MainThread): 10:38:57 | 
2020-07-07 14:38:57.928215 (Thread-1): Began running node model.springml_demo_dbt_project.creditcard
2020-07-07 14:38:57.929785 (Thread-1): 10:38:57 | 1 of 2 START view model springml_demo_dataset.creditcard............. [RUN]
2020-07-07 14:38:57.930264 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-07 14:38:57.930409 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-07 14:38:57.930539 (Thread-1): Compiling model.springml_demo_dbt_project.creditcard
2020-07-07 14:38:57.949520 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-07 14:38:57.951885 (Thread-1): finished collecting timing info
2020-07-07 14:38:57.994841 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-07 14:38:57.995340 (Thread-1): On model.springml_demo_dbt_project.creditcard: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
  OPTIONS()
  as 

select country,

sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,

sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,

sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,

from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where not (Amex_payments = 0 
and	Mastercard_payments = 0 
and	 Visa_payments = 0)
group by country 
order by (Amex_payments + Mastercard_payments + Visa_payments) desc;


2020-07-07 14:38:58.810672 (Thread-1): finished collecting timing info
2020-07-07 14:38:58.811505 (Thread-1): Database Error in model creditcard (models/base/creditcard.sql)
  Unrecognized name: Amex_payments at [17:12]
  compiled SQL at target/run/springml_demo_dbt_project/models/base/creditcard.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 84, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 225, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 352, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3207, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 812, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 122, in result
    self._blocking_poll(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3103, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 101, in _blocking_poll
    retry_(self._done_or_raise)()
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 80, in _done_or_raise
    if not self.done():
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3089, in done
    timeout=transport_timeout,
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/client.py", line 1289, in _get_query_results
    retry, method="GET", path=path, query_params=extra_params, timeout=timeout
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/client.py", line 558, in _call_api
    return call()
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/google/cloud/_http.py", line 423, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/prismatic-cider-279015/queries/fe8a56e4-57b5-467e-9db0-d7f5e5c8dbbf?maxResults=0&location=US: Unrecognized name: Amex_payments at [17:12]

(job ID: fe8a56e4-57b5-467e-9db0-d7f5e5c8dbbf)

                                                               -----Query Job SQL Follows-----                                                               

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
   5:  OPTIONS()
   6:  as 
   7:
   8:select country,
   9:
  10:sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,
  11:
  12:sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,
  13:
  14:sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,
  15:
  16:from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
  17:where not (Amex_payments = 0 
  18:and	Mastercard_payments = 0 
  19:and	 Visa_payments = 0)
  20:group by country 
  21:order by (Amex_payments + Mastercard_payments + Visa_payments) desc;
  22:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 234, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 227, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/Cellar/python/3.7.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 88, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 76, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model creditcard (models/base/creditcard.sql)
  Unrecognized name: Amex_payments at [17:12]
  compiled SQL at target/run/springml_demo_dbt_project/models/base/creditcard.sql
2020-07-07 14:38:58.838705 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bee911c1-5a24-418b-ae44-8478f0504f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106199810>]}
2020-07-07 14:38:58.840440 (Thread-1): 10:38:58 | 1 of 2 ERROR creating view model springml_demo_dataset.creditcard.... [ERROR in 0.91s]
2020-07-07 14:38:58.840645 (Thread-1): Finished running node model.springml_demo_dbt_project.creditcard
2020-07-07 14:38:58.840910 (Thread-1): Began running node model.springml_demo_dbt_project.payments
2020-07-07 14:38:58.842501 (Thread-1): 10:38:58 | 2 of 2 START view model springml_demo_dataset.payments............... [RUN]
2020-07-07 14:38:58.842932 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-07 14:38:58.843062 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.creditcard).
2020-07-07 14:38:58.843187 (Thread-1): Compiling model.springml_demo_dbt_project.payments
2020-07-07 14:38:58.855558 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.payments"
2020-07-07 14:38:58.855991 (Thread-1): finished collecting timing info
2020-07-07 14:38:58.860276 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.payments"
2020-07-07 14:38:58.860710 (Thread-1): On model.springml_demo_dbt_project.payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
  OPTIONS()
  as select payment_type, 
    count(*) as number_of_payments, 
    sum(price) as total_price 
from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where country like "United States"
group by payment_type;


2020-07-07 14:38:59.583418 (Thread-1): finished collecting timing info
2020-07-07 14:38:59.584283 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bee911c1-5a24-418b-ae44-8478f0504f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064a3310>]}
2020-07-07 14:38:59.585503 (Thread-1): 10:38:59 | 2 of 2 OK created view model springml_demo_dataset.payments.......... [CREATE VIEW in 0.74s]
2020-07-07 14:38:59.585662 (Thread-1): Finished running node model.springml_demo_dbt_project.payments
2020-07-07 14:38:59.685170 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 14:38:59.685405 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:38:59.685841 (MainThread): 10:38:59 | 
2020-07-07 14:38:59.686026 (MainThread): 10:38:59 | Finished running 2 view models in 4.79s.
2020-07-07 14:38:59.686204 (MainThread): Connection 'master' was properly closed.
2020-07-07 14:38:59.686370 (MainThread): Connection 'model.springml_demo_dbt_project.payments' was left open.
2020-07-07 14:38:59.696491 (MainThread): 
2020-07-07 14:38:59.696725 (MainThread): Completed with 1 error and 0 warnings:
2020-07-07 14:38:59.696866 (MainThread): 
2020-07-07 14:38:59.697005 (MainThread): Database Error in model creditcard (models/base/creditcard.sql)
2020-07-07 14:38:59.697137 (MainThread):   Unrecognized name: Amex_payments at [17:12]
2020-07-07 14:38:59.697254 (MainThread):   compiled SQL at target/run/springml_demo_dbt_project/models/base/creditcard.sql
2020-07-07 14:38:59.697386 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2020-07-07 14:38:59.697612 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10622acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061ffe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061ffb10>]}
2020-07-07 14:38:59.697809 (MainThread): Flushing usage events
2020-07-07 14:40:56.813151 (MainThread): Running with dbt=0.17.0
2020-07-07 14:40:57.177333 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-07 14:40:57.178687 (MainThread): Tracking: tracking
2020-07-07 14:40:57.191765 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcd7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcdbed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcdbcd0>]}
2020-07-07 14:40:57.245491 (MainThread): Partial parsing not enabled
2020-07-07 14:40:57.248232 (MainThread): Parsing macros/core.sql
2020-07-07 14:40:57.257657 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-07 14:40:57.269391 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-07 14:40:57.273748 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-07 14:40:57.300072 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-07 14:40:57.337013 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-07 14:40:57.367979 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-07 14:40:57.370920 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-07 14:40:57.380240 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-07 14:40:57.397534 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-07 14:40:57.410215 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-07 14:40:57.419053 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-07 14:40:57.425521 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-07 14:40:57.427682 (MainThread): Parsing macros/etc/query.sql
2020-07-07 14:40:57.429903 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-07 14:40:57.432640 (MainThread): Parsing macros/etc/datetime.sql
2020-07-07 14:40:57.444413 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-07 14:40:57.447666 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-07 14:40:57.450515 (MainThread): Parsing macros/adapters/common.sql
2020-07-07 14:40:57.509696 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-07 14:40:57.512024 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-07 14:40:57.513954 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-07 14:40:57.516044 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-07 14:40:57.519605 (MainThread): Parsing macros/etc.sql
2020-07-07 14:40:57.521006 (MainThread): Parsing macros/catalog.sql
2020-07-07 14:40:57.528520 (MainThread): Parsing macros/adapters.sql
2020-07-07 14:40:57.548901 (MainThread): Parsing macros/materializations/seed.sql
2020-07-07 14:40:57.552135 (MainThread): Parsing macros/materializations/view.sql
2020-07-07 14:40:57.555336 (MainThread): Parsing macros/materializations/table.sql
2020-07-07 14:40:57.574254 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-07 14:40:57.590471 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-07 14:40:57.614767 (MainThread): Partial parsing not enabled
2020-07-07 14:40:57.656341 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-07 14:40:57.656529 (MainThread): Opening a new connection, currently in state init
2020-07-07 14:40:57.688509 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-07 14:40:57.688672 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:40:57.714693 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-07 14:40:57.714889 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:40:57.982149 (MainThread): WARNING: Found documentation for resource "creditcards" which was not found or is disabled
2020-07-07 14:40:57.982452 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.unique_creditcards_country' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-07 14:40:57.982598 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_country' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-07 14:40:57.982725 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Amex_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-07 14:40:57.982846 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Mastercard_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-07 14:40:57.982975 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Visa_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-07 14:40:58.083580 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 1 seed file, 1 source
2020-07-07 14:40:58.084979 (MainThread): 
2020-07-07 14:40:58.085540 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 14:40:58.085667 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:40:58.090113 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-07 14:40:58.090366 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-07 14:40:58.092962 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-07 14:41:00.770490 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-07 14:41:00.770821 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-07 14:41:00.770994 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-07 14:41:00.895400 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 14:41:00.895596 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:41:00.895982 (MainThread): 10:41:00 | Concurrency: 1 threads (target='dev')
2020-07-07 14:41:00.896184 (MainThread): 10:41:00 | 
2020-07-07 14:41:00.900387 (Thread-1): Began running node model.springml_demo_dbt_project.creditcard
2020-07-07 14:41:00.902006 (Thread-1): 10:41:00 | 1 of 2 START view model springml_demo_dataset.creditcard............. [RUN]
2020-07-07 14:41:00.902586 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-07 14:41:00.902733 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-07 14:41:00.902896 (Thread-1): Compiling model.springml_demo_dbt_project.creditcard
2020-07-07 14:41:00.921683 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-07 14:41:00.923810 (Thread-1): finished collecting timing info
2020-07-07 14:41:00.962777 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-07 14:41:00.963346 (Thread-1): On model.springml_demo_dbt_project.creditcard: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
  OPTIONS()
  as 

select country,

sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,

sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,

sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,

from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
group by country 
having not (Amex_payments = 0 
and	Mastercard_payments = 0 
and	 Visa_payments = 0)
order by (Amex_payments + Mastercard_payments + Visa_payments) desc;


2020-07-07 14:41:01.586554 (Thread-1): finished collecting timing info
2020-07-07 14:41:01.587358 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ab8bf66-382b-4418-9a28-7080348c7db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e00d3d0>]}
2020-07-07 14:41:01.588636 (Thread-1): 10:41:01 | 1 of 2 OK created view model springml_demo_dataset.creditcard........ [CREATE VIEW in 0.68s]
2020-07-07 14:41:01.588832 (Thread-1): Finished running node model.springml_demo_dbt_project.creditcard
2020-07-07 14:41:01.589020 (Thread-1): Began running node model.springml_demo_dbt_project.payments
2020-07-07 14:41:01.590315 (Thread-1): 10:41:01 | 2 of 2 START view model springml_demo_dataset.payments............... [RUN]
2020-07-07 14:41:01.590904 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-07 14:41:01.591141 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.creditcard).
2020-07-07 14:41:01.591317 (Thread-1): Compiling model.springml_demo_dbt_project.payments
2020-07-07 14:41:01.603143 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.payments"
2020-07-07 14:41:01.603608 (Thread-1): finished collecting timing info
2020-07-07 14:41:01.608018 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.payments"
2020-07-07 14:41:01.608500 (Thread-1): On model.springml_demo_dbt_project.payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
  OPTIONS()
  as select payment_type, 
    count(*) as number_of_payments, 
    sum(price) as total_price 
from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where country like "United States"
group by payment_type;


2020-07-07 14:41:02.495930 (Thread-1): finished collecting timing info
2020-07-07 14:41:02.503272 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ab8bf66-382b-4418-9a28-7080348c7db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df0fbd0>]}
2020-07-07 14:41:02.505222 (Thread-1): 10:41:02 | 2 of 2 OK created view model springml_demo_dataset.payments.......... [CREATE VIEW in 0.91s]
2020-07-07 14:41:02.505484 (Thread-1): Finished running node model.springml_demo_dbt_project.payments
2020-07-07 14:41:02.540955 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 14:41:02.541381 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:41:02.542210 (MainThread): 10:41:02 | 
2020-07-07 14:41:02.542560 (MainThread): 10:41:02 | Finished running 2 view models in 4.46s.
2020-07-07 14:41:02.542853 (MainThread): Connection 'master' was properly closed.
2020-07-07 14:41:02.543086 (MainThread): Connection 'model.springml_demo_dbt_project.payments' was left open.
2020-07-07 14:41:02.554489 (MainThread): 
2020-07-07 14:41:02.554698 (MainThread): Completed successfully
2020-07-07 14:41:02.554886 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-07-07 14:41:02.555201 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1d6990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df0f790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df0ff50>]}
2020-07-07 14:41:02.555424 (MainThread): Flushing usage events
2020-07-07 14:41:08.920882 (MainThread): Running with dbt=0.17.0
2020-07-07 14:41:09.431312 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-07-07 14:41:09.432240 (MainThread): Tracking: tracking
2020-07-07 14:41:09.452120 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105131910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050fea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105135e10>]}
2020-07-07 14:41:09.505402 (MainThread): Partial parsing not enabled
2020-07-07 14:41:09.509203 (MainThread): Parsing macros/core.sql
2020-07-07 14:41:09.517260 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-07 14:41:09.527729 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-07 14:41:09.530474 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-07 14:41:09.552259 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-07 14:41:09.587674 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-07 14:41:09.614266 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-07 14:41:09.618823 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-07 14:41:09.629295 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-07 14:41:09.646432 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-07 14:41:09.656354 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-07 14:41:09.664895 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-07 14:41:09.671355 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-07 14:41:09.673935 (MainThread): Parsing macros/etc/query.sql
2020-07-07 14:41:09.676311 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-07 14:41:09.680441 (MainThread): Parsing macros/etc/datetime.sql
2020-07-07 14:41:09.694359 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-07 14:41:09.697236 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-07 14:41:09.699798 (MainThread): Parsing macros/adapters/common.sql
2020-07-07 14:41:09.767026 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-07 14:41:09.768480 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-07 14:41:09.769573 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-07 14:41:09.770843 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-07 14:41:09.774574 (MainThread): Parsing macros/etc.sql
2020-07-07 14:41:09.775612 (MainThread): Parsing macros/catalog.sql
2020-07-07 14:41:09.783413 (MainThread): Parsing macros/adapters.sql
2020-07-07 14:41:09.802633 (MainThread): Parsing macros/materializations/seed.sql
2020-07-07 14:41:09.805033 (MainThread): Parsing macros/materializations/view.sql
2020-07-07 14:41:09.807391 (MainThread): Parsing macros/materializations/table.sql
2020-07-07 14:41:09.819430 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-07 14:41:09.834751 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-07 14:41:09.859228 (MainThread): Partial parsing not enabled
2020-07-07 14:41:09.914034 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-07 14:41:09.914233 (MainThread): Opening a new connection, currently in state init
2020-07-07 14:41:09.949654 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-07 14:41:09.949839 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:41:09.970826 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-07 14:41:09.970997 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:41:10.225748 (MainThread): WARNING: Found documentation for resource "creditcards" which was not found or is disabled
2020-07-07 14:41:10.226037 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.unique_creditcards_country' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-07 14:41:10.226184 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_country' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-07 14:41:10.226353 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Amex_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-07 14:41:10.226557 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Mastercard_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-07 14:41:10.226691 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Visa_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-07 14:41:10.327090 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 1 seed file, 1 source
2020-07-07 14:41:10.328022 (MainThread): 
2020-07-07 14:41:10.328382 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 14:41:10.328482 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:41:10.344716 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-07 14:41:10.344962 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-07-07 14:41:10.346009 (ThreadPoolExecutor-1_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-07 14:41:11.331951 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-07 14:41:11.767373 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 14:41:11.767602 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:41:11.768004 (MainThread): 10:41:11 | Concurrency: 1 threads (target='dev')
2020-07-07 14:41:11.768235 (MainThread): 10:41:11 | 
2020-07-07 14:41:11.770676 (Thread-1): Began running node test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners
2020-07-07 14:41:11.770919 (Thread-1): 10:41:11 | 1 of 4 START test accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners [RUN]
2020-07-07 14:41:11.771354 (Thread-1): Acquiring new bigquery connection "test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners".
2020-07-07 14:41:11.771474 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-07 14:41:11.771611 (Thread-1): Compiling test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners
2020-07-07 14:41:11.794895 (Thread-1): Writing injected SQL for node "test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners"
2020-07-07 14:41:11.795359 (Thread-1): finished collecting timing info
2020-07-07 14:41:11.795669 (Thread-1): On test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners"} */





with all_values as (

    select distinct
        payment_type as value_field

    from `prismatic-cider-279015`.`springml_demo_dataset`.`payments`

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'Mastercard','Amex','Visa','Diners'
    )
)

select count(*) as validation_errors
from validation_errors


2020-07-07 14:41:13.194825 (Thread-1): finished collecting timing info
2020-07-07 14:41:13.195694 (Thread-1): 10:41:13 | 1 of 4 PASS accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners [PASS in 1.42s]
2020-07-07 14:41:13.195978 (Thread-1): Finished running node test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners
2020-07-07 14:41:13.196238 (Thread-1): Began running node test.springml_demo_dbt_project.creditcardtest
2020-07-07 14:41:13.196590 (Thread-1): 10:41:13 | 2 of 4 START test creditcardtest..................................... [RUN]
2020-07-07 14:41:13.197063 (Thread-1): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-07 14:41:13.197206 (Thread-1): Re-using an available connection from the pool (formerly test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners).
2020-07-07 14:41:13.197340 (Thread-1): Compiling test.springml_demo_dbt_project.creditcardtest
2020-07-07 14:41:13.215114 (Thread-1): Writing injected SQL for node "test.springml_demo_dbt_project.creditcardtest"
2020-07-07 14:41:13.215850 (Thread-1): finished collecting timing info
2020-07-07 14:41:13.216325 (Thread-1): On test.springml_demo_dbt_project.creditcardtest: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "test.springml_demo_dbt_project.creditcardtest"} */
select count(*) as errors from (
-- Making sure that there are no countries that have zero payments in all three credit cards

select country
from `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
where Amex_payments = 0 
and	Mastercard_payments = 0 
and	 Visa_payments = 0
) sbq
2020-07-07 14:41:14.733956 (Thread-1): finished collecting timing info
2020-07-07 14:41:14.735299 (Thread-1): 10:41:14 | 2 of 4 PASS creditcardtest........................................... [PASS in 1.54s]
2020-07-07 14:41:14.735733 (Thread-1): Finished running node test.springml_demo_dbt_project.creditcardtest
2020-07-07 14:41:14.736183 (Thread-1): Began running node test.springml_demo_dbt_project.not_null_payments_number_of_payments
2020-07-07 14:41:14.736525 (Thread-1): 10:41:14 | 3 of 4 START test not_null_payments_number_of_payments............... [RUN]
2020-07-07 14:41:14.737157 (Thread-1): Acquiring new bigquery connection "test.springml_demo_dbt_project.not_null_payments_number_of_payments".
2020-07-07 14:41:14.737495 (Thread-1): Re-using an available connection from the pool (formerly test.springml_demo_dbt_project.creditcardtest).
2020-07-07 14:41:14.737811 (Thread-1): Compiling test.springml_demo_dbt_project.not_null_payments_number_of_payments
2020-07-07 14:41:14.752347 (Thread-1): Writing injected SQL for node "test.springml_demo_dbt_project.not_null_payments_number_of_payments"
2020-07-07 14:41:14.754687 (Thread-1): finished collecting timing info
2020-07-07 14:41:14.755209 (Thread-1): On test.springml_demo_dbt_project.not_null_payments_number_of_payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "test.springml_demo_dbt_project.not_null_payments_number_of_payments"} */




select count(*) as validation_errors
from `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
where number_of_payments is null


2020-07-07 14:41:16.224872 (Thread-1): finished collecting timing info
2020-07-07 14:41:16.225671 (Thread-1): 10:41:16 | 3 of 4 PASS not_null_payments_number_of_payments..................... [PASS in 1.49s]
2020-07-07 14:41:16.225943 (Thread-1): Finished running node test.springml_demo_dbt_project.not_null_payments_number_of_payments
2020-07-07 14:41:16.226271 (Thread-1): Began running node test.springml_demo_dbt_project.not_null_payments_total_price
2020-07-07 14:41:16.226625 (Thread-1): 10:41:16 | 4 of 4 START test not_null_payments_total_price...................... [RUN]
2020-07-07 14:41:16.227193 (Thread-1): Acquiring new bigquery connection "test.springml_demo_dbt_project.not_null_payments_total_price".
2020-07-07 14:41:16.227366 (Thread-1): Re-using an available connection from the pool (formerly test.springml_demo_dbt_project.not_null_payments_number_of_payments).
2020-07-07 14:41:16.227520 (Thread-1): Compiling test.springml_demo_dbt_project.not_null_payments_total_price
2020-07-07 14:41:16.237841 (Thread-1): Writing injected SQL for node "test.springml_demo_dbt_project.not_null_payments_total_price"
2020-07-07 14:41:16.238297 (Thread-1): finished collecting timing info
2020-07-07 14:41:16.238582 (Thread-1): On test.springml_demo_dbt_project.not_null_payments_total_price: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "test.springml_demo_dbt_project.not_null_payments_total_price"} */




select count(*) as validation_errors
from `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
where total_price is null


2020-07-07 14:41:17.699702 (Thread-1): finished collecting timing info
2020-07-07 14:41:17.700510 (Thread-1): 10:41:17 | 4 of 4 PASS not_null_payments_total_price............................ [PASS in 1.47s]
2020-07-07 14:41:17.700812 (Thread-1): Finished running node test.springml_demo_dbt_project.not_null_payments_total_price
2020-07-07 14:41:17.721809 (MainThread): Acquiring new bigquery connection "master".
2020-07-07 14:41:17.722090 (MainThread): Opening a new connection, currently in state closed
2020-07-07 14:41:17.722537 (MainThread): 10:41:17 | 
2020-07-07 14:41:17.722758 (MainThread): 10:41:17 | Finished running 4 tests in 7.39s.
2020-07-07 14:41:17.722961 (MainThread): Connection 'master' was properly closed.
2020-07-07 14:41:17.723119 (MainThread): Connection 'test.springml_demo_dbt_project.not_null_payments_total_price' was left open.
2020-07-07 14:41:17.742022 (MainThread): 
2020-07-07 14:41:17.742211 (MainThread): Completed successfully
2020-07-07 14:41:17.742345 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-07-07 14:41:17.742600 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105440d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ec4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054745d0>]}
2020-07-07 14:41:17.743016 (MainThread): Flushing usage events
2020-07-08 05:54:19.447613 (MainThread): Running with dbt=0.17.0
2020-07-08 05:54:24.447315 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-08 05:54:24.449105 (MainThread): Tracking: tracking
2020-07-08 05:54:24.481013 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f880e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f891890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f891690>]}
2020-07-08 05:54:24.506933 (MainThread): Partial parsing not enabled
2020-07-08 05:54:24.510335 (MainThread): Parsing macros/core.sql
2020-07-08 05:54:24.520130 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-08 05:54:24.530702 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-08 05:54:24.533652 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-08 05:54:24.555611 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-08 05:54:24.594502 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-08 05:54:24.620896 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-08 05:54:24.624222 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-08 05:54:24.632632 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-08 05:54:24.649688 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-08 05:54:24.662383 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-08 05:54:24.671410 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-08 05:54:24.677736 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-08 05:54:24.679416 (MainThread): Parsing macros/etc/query.sql
2020-07-08 05:54:24.681417 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-08 05:54:24.684235 (MainThread): Parsing macros/etc/datetime.sql
2020-07-08 05:54:24.696146 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-08 05:54:24.699024 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-08 05:54:24.701569 (MainThread): Parsing macros/adapters/common.sql
2020-07-08 05:54:24.760438 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-08 05:54:24.762812 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-08 05:54:24.764767 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-08 05:54:24.766735 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-08 05:54:24.770143 (MainThread): Parsing macros/etc.sql
2020-07-08 05:54:24.771488 (MainThread): Parsing macros/catalog.sql
2020-07-08 05:54:24.778930 (MainThread): Parsing macros/adapters.sql
2020-07-08 05:54:24.799784 (MainThread): Parsing macros/materializations/seed.sql
2020-07-08 05:54:24.802868 (MainThread): Parsing macros/materializations/view.sql
2020-07-08 05:54:24.805590 (MainThread): Parsing macros/materializations/table.sql
2020-07-08 05:54:24.818506 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-08 05:54:24.834333 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-08 05:54:24.866926 (MainThread): Partial parsing not enabled
2020-07-08 05:54:24.918325 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-08 05:54:24.918526 (MainThread): Opening a new connection, currently in state init
2020-07-08 05:54:24.953577 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-08 05:54:24.953734 (MainThread): Opening a new connection, currently in state closed
2020-07-08 05:54:24.977021 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-08 05:54:24.977196 (MainThread): Opening a new connection, currently in state closed
2020-07-08 05:54:25.301327 (MainThread): WARNING: Found documentation for resource "creditcards" which was not found or is disabled
2020-07-08 05:54:25.302113 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.unique_creditcards_country' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-08 05:54:25.302392 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_country' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-08 05:54:25.302573 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Amex_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-08 05:54:25.302776 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Mastercard_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-08 05:54:25.302977 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Visa_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-08 05:54:25.403701 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 1 seed file, 1 source
2020-07-08 05:54:25.404873 (MainThread): 
2020-07-08 05:54:25.405357 (MainThread): Acquiring new bigquery connection "master".
2020-07-08 05:54:25.405484 (MainThread): Opening a new connection, currently in state closed
2020-07-08 05:54:25.409891 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-08 05:54:25.410176 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-08 05:54:25.417735 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-08 05:54:29.281541 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-08 05:54:29.281809 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-08 05:54:29.281982 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-08 05:54:29.413627 (MainThread): Acquiring new bigquery connection "master".
2020-07-08 05:54:29.413842 (MainThread): Opening a new connection, currently in state closed
2020-07-08 05:54:29.414256 (MainThread): 01:54:29 | Concurrency: 1 threads (target='dev')
2020-07-08 05:54:29.414472 (MainThread): 01:54:29 | 
2020-07-08 05:54:29.418673 (Thread-1): Began running node model.springml_demo_dbt_project.creditcard
2020-07-08 05:54:29.420283 (Thread-1): 01:54:29 | 1 of 2 START view model springml_demo_dataset.creditcard............. [RUN]
2020-07-08 05:54:29.420740 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-08 05:54:29.420874 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-08 05:54:29.421032 (Thread-1): Compiling model.springml_demo_dbt_project.creditcard
2020-07-08 05:54:29.440184 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-08 05:54:29.442275 (Thread-1): finished collecting timing info
2020-07-08 05:54:29.480845 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-08 05:54:29.481480 (Thread-1): On model.springml_demo_dbt_project.creditcard: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
  OPTIONS()
  as 

select country,

sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,

sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,

sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,

from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
group by country 
having not (Amex_payments = 0 
and	Mastercard_payments = 0 
and	 Visa_payments = 0)
order by (Amex_payments + Mastercard_payments + Visa_payments) desc;


2020-07-08 05:54:30.569068 (Thread-1): finished collecting timing info
2020-07-08 05:54:30.569889 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b9f98f3-20c3-46c2-b2ca-284328729326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d32f5d0>]}
2020-07-08 05:54:30.571189 (Thread-1): 01:54:30 | 1 of 2 OK created view model springml_demo_dataset.creditcard........ [CREATE VIEW in 1.15s]
2020-07-08 05:54:30.571361 (Thread-1): Finished running node model.springml_demo_dbt_project.creditcard
2020-07-08 05:54:30.571549 (Thread-1): Began running node model.springml_demo_dbt_project.payments
2020-07-08 05:54:30.572818 (Thread-1): 01:54:30 | 2 of 2 START view model springml_demo_dataset.payments............... [RUN]
2020-07-08 05:54:30.573168 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-08 05:54:30.573279 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.creditcard).
2020-07-08 05:54:30.573384 (Thread-1): Compiling model.springml_demo_dbt_project.payments
2020-07-08 05:54:30.584101 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.payments"
2020-07-08 05:54:30.584590 (Thread-1): finished collecting timing info
2020-07-08 05:54:30.588910 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.payments"
2020-07-08 05:54:30.589325 (Thread-1): On model.springml_demo_dbt_project.payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
  OPTIONS()
  as select payment_type, 
    count(*) as number_of_payments, 
    sum(price) as total_price 
from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where country like "United States"
group by payment_type;


2020-07-08 05:54:31.053613 (Thread-1): finished collecting timing info
2020-07-08 05:54:31.054504 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b9f98f3-20c3-46c2-b2ca-284328729326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbaae50>]}
2020-07-08 05:54:31.055974 (Thread-1): 01:54:31 | 2 of 2 OK created view model springml_demo_dataset.payments.......... [CREATE VIEW in 0.48s]
2020-07-08 05:54:31.056168 (Thread-1): Finished running node model.springml_demo_dbt_project.payments
2020-07-08 05:54:31.062302 (MainThread): Acquiring new bigquery connection "master".
2020-07-08 05:54:31.062559 (MainThread): Opening a new connection, currently in state closed
2020-07-08 05:54:31.063049 (MainThread): 01:54:31 | 
2020-07-08 05:54:31.063276 (MainThread): 01:54:31 | Finished running 2 view models in 5.66s.
2020-07-08 05:54:31.063490 (MainThread): Connection 'master' was properly closed.
2020-07-08 05:54:31.063655 (MainThread): Connection 'model.springml_demo_dbt_project.payments' was left open.
2020-07-08 05:54:31.075085 (MainThread): 
2020-07-08 05:54:31.075438 (MainThread): Completed successfully
2020-07-08 05:54:31.075907 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-07-08 05:54:31.076331 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbaae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fad5350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb45cd0>]}
2020-07-08 05:54:31.076578 (MainThread): Flushing usage events
2020-07-08 05:54:47.271790 (MainThread): Running with dbt=0.17.0
2020-07-08 05:54:47.940363 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-07-08 05:54:47.941513 (MainThread): Tracking: tracking
2020-07-08 05:54:47.954191 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b80b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dd97890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dd97690>]}
2020-07-08 05:54:47.981147 (MainThread): Partial parsing not enabled
2020-07-08 05:54:47.983288 (MainThread): Parsing macros/core.sql
2020-07-08 05:54:47.988832 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-08 05:54:47.998363 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-08 05:54:48.000453 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-08 05:54:48.022417 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-08 05:54:48.059306 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-08 05:54:48.084749 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-08 05:54:48.087032 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-08 05:54:48.094751 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-08 05:54:48.111097 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-08 05:54:48.119342 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-08 05:54:48.126949 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-08 05:54:48.132749 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-08 05:54:48.133862 (MainThread): Parsing macros/etc/query.sql
2020-07-08 05:54:48.135131 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-08 05:54:48.137098 (MainThread): Parsing macros/etc/datetime.sql
2020-07-08 05:54:48.147768 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-08 05:54:48.150140 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-08 05:54:48.152078 (MainThread): Parsing macros/adapters/common.sql
2020-07-08 05:54:48.210379 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-08 05:54:48.211878 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-08 05:54:48.212972 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-08 05:54:48.214249 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-08 05:54:48.216962 (MainThread): Parsing macros/etc.sql
2020-07-08 05:54:48.217849 (MainThread): Parsing macros/catalog.sql
2020-07-08 05:54:48.224867 (MainThread): Parsing macros/adapters.sql
2020-07-08 05:54:48.244103 (MainThread): Parsing macros/materializations/seed.sql
2020-07-08 05:54:48.246489 (MainThread): Parsing macros/materializations/view.sql
2020-07-08 05:54:48.248872 (MainThread): Parsing macros/materializations/table.sql
2020-07-08 05:54:48.261807 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-08 05:54:48.277397 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-08 05:54:48.301406 (MainThread): Partial parsing not enabled
2020-07-08 05:54:48.344842 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-08 05:54:48.345027 (MainThread): Opening a new connection, currently in state init
2020-07-08 05:54:48.380102 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-08 05:54:48.380276 (MainThread): Opening a new connection, currently in state closed
2020-07-08 05:54:48.400960 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-08 05:54:48.401122 (MainThread): Opening a new connection, currently in state closed
2020-07-08 05:54:48.692133 (MainThread): WARNING: Found documentation for resource "creditcards" which was not found or is disabled
2020-07-08 05:54:48.692433 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.unique_creditcards_country' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-08 05:54:48.692598 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_country' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-08 05:54:48.692834 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Amex_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-08 05:54:48.693022 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Mastercard_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-08 05:54:48.693202 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Visa_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-08 05:54:48.792178 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 1 seed file, 1 source
2020-07-08 05:54:48.793134 (MainThread): 
2020-07-08 05:54:48.793549 (MainThread): Acquiring new bigquery connection "master".
2020-07-08 05:54:48.793656 (MainThread): Opening a new connection, currently in state closed
2020-07-08 05:54:48.810019 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-08 05:54:48.810264 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-07-08 05:54:48.811345 (ThreadPoolExecutor-1_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-08 05:54:49.276942 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-08 05:54:49.627795 (MainThread): Acquiring new bigquery connection "master".
2020-07-08 05:54:49.627997 (MainThread): Opening a new connection, currently in state closed
2020-07-08 05:54:49.628367 (MainThread): 01:54:49 | Concurrency: 1 threads (target='dev')
2020-07-08 05:54:49.628575 (MainThread): 01:54:49 | 
2020-07-08 05:54:49.630880 (Thread-1): Began running node test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners
2020-07-08 05:54:49.631124 (Thread-1): 01:54:49 | 1 of 4 START test accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners [RUN]
2020-07-08 05:54:49.631548 (Thread-1): Acquiring new bigquery connection "test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners".
2020-07-08 05:54:49.631669 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-08 05:54:49.631808 (Thread-1): Compiling test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners
2020-07-08 05:54:49.654915 (Thread-1): Writing injected SQL for node "test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners"
2020-07-08 05:54:49.658060 (Thread-1): finished collecting timing info
2020-07-08 05:54:49.658636 (Thread-1): On test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners"} */





with all_values as (

    select distinct
        payment_type as value_field

    from `prismatic-cider-279015`.`springml_demo_dataset`.`payments`

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'Mastercard','Amex','Visa','Diners'
    )
)

select count(*) as validation_errors
from validation_errors


2020-07-08 05:54:51.103920 (Thread-1): finished collecting timing info
2020-07-08 05:54:51.104803 (Thread-1): 01:54:51 | 1 of 4 PASS accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners [PASS in 1.47s]
2020-07-08 05:54:51.105040 (Thread-1): Finished running node test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners
2020-07-08 05:54:51.105262 (Thread-1): Began running node test.springml_demo_dbt_project.creditcardtest
2020-07-08 05:54:51.105462 (Thread-1): 01:54:51 | 2 of 4 START test creditcardtest..................................... [RUN]
2020-07-08 05:54:51.105820 (Thread-1): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-08 05:54:51.105954 (Thread-1): Re-using an available connection from the pool (formerly test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners).
2020-07-08 05:54:51.106084 (Thread-1): Compiling test.springml_demo_dbt_project.creditcardtest
2020-07-08 05:54:51.122658 (Thread-1): Writing injected SQL for node "test.springml_demo_dbt_project.creditcardtest"
2020-07-08 05:54:51.126433 (Thread-1): finished collecting timing info
2020-07-08 05:54:51.127110 (Thread-1): On test.springml_demo_dbt_project.creditcardtest: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "test.springml_demo_dbt_project.creditcardtest"} */
select count(*) as errors from (
-- Making sure that there are no countries that have zero payments in all three credit cards

select country
from `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
where Amex_payments = 0 and	Mastercard_payments = 0 and	 Visa_payments = 0
) sbq
2020-07-08 05:54:52.397136 (Thread-1): finished collecting timing info
2020-07-08 05:54:52.397832 (Thread-1): 01:54:52 | 2 of 4 PASS creditcardtest........................................... [PASS in 1.29s]
2020-07-08 05:54:52.398027 (Thread-1): Finished running node test.springml_demo_dbt_project.creditcardtest
2020-07-08 05:54:52.398285 (Thread-1): Began running node test.springml_demo_dbt_project.not_null_payments_number_of_payments
2020-07-08 05:54:52.398592 (Thread-1): 01:54:52 | 3 of 4 START test not_null_payments_number_of_payments............... [RUN]
2020-07-08 05:54:52.398985 (Thread-1): Acquiring new bigquery connection "test.springml_demo_dbt_project.not_null_payments_number_of_payments".
2020-07-08 05:54:52.399090 (Thread-1): Re-using an available connection from the pool (formerly test.springml_demo_dbt_project.creditcardtest).
2020-07-08 05:54:52.399193 (Thread-1): Compiling test.springml_demo_dbt_project.not_null_payments_number_of_payments
2020-07-08 05:54:52.408859 (Thread-1): Writing injected SQL for node "test.springml_demo_dbt_project.not_null_payments_number_of_payments"
2020-07-08 05:54:52.409360 (Thread-1): finished collecting timing info
2020-07-08 05:54:52.409637 (Thread-1): On test.springml_demo_dbt_project.not_null_payments_number_of_payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "test.springml_demo_dbt_project.not_null_payments_number_of_payments"} */




select count(*) as validation_errors
from `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
where number_of_payments is null


2020-07-08 05:54:53.663856 (Thread-1): finished collecting timing info
2020-07-08 05:54:53.664687 (Thread-1): 01:54:53 | 3 of 4 PASS not_null_payments_number_of_payments..................... [PASS in 1.27s]
2020-07-08 05:54:53.664931 (Thread-1): Finished running node test.springml_demo_dbt_project.not_null_payments_number_of_payments
2020-07-08 05:54:53.665192 (Thread-1): Began running node test.springml_demo_dbt_project.not_null_payments_total_price
2020-07-08 05:54:53.665401 (Thread-1): 01:54:53 | 4 of 4 START test not_null_payments_total_price...................... [RUN]
2020-07-08 05:54:53.665766 (Thread-1): Acquiring new bigquery connection "test.springml_demo_dbt_project.not_null_payments_total_price".
2020-07-08 05:54:53.665896 (Thread-1): Re-using an available connection from the pool (formerly test.springml_demo_dbt_project.not_null_payments_number_of_payments).
2020-07-08 05:54:53.666023 (Thread-1): Compiling test.springml_demo_dbt_project.not_null_payments_total_price
2020-07-08 05:54:53.677169 (Thread-1): Writing injected SQL for node "test.springml_demo_dbt_project.not_null_payments_total_price"
2020-07-08 05:54:53.677727 (Thread-1): finished collecting timing info
2020-07-08 05:54:53.678054 (Thread-1): On test.springml_demo_dbt_project.not_null_payments_total_price: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "test.springml_demo_dbt_project.not_null_payments_total_price"} */




select count(*) as validation_errors
from `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
where total_price is null


2020-07-08 05:54:54.789646 (Thread-1): finished collecting timing info
2020-07-08 05:54:54.790488 (Thread-1): 01:54:54 | 4 of 4 PASS not_null_payments_total_price............................ [PASS in 1.12s]
2020-07-08 05:54:54.790726 (Thread-1): Finished running node test.springml_demo_dbt_project.not_null_payments_total_price
2020-07-08 05:54:54.793352 (MainThread): Acquiring new bigquery connection "master".
2020-07-08 05:54:54.793562 (MainThread): Opening a new connection, currently in state closed
2020-07-08 05:54:54.793916 (MainThread): 01:54:54 | 
2020-07-08 05:54:54.794098 (MainThread): 01:54:54 | Finished running 4 tests in 6.00s.
2020-07-08 05:54:54.794265 (MainThread): Connection 'master' was properly closed.
2020-07-08 05:54:54.794496 (MainThread): Connection 'test.springml_demo_dbt_project.not_null_payments_total_price' was left open.
2020-07-08 05:54:54.808772 (MainThread): 
2020-07-08 05:54:54.808937 (MainThread): Completed successfully
2020-07-08 05:54:54.809110 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-07-08 05:54:54.809390 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b80b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11de2b690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11df559d0>]}
2020-07-08 05:54:54.809644 (MainThread): Flushing usage events
2020-07-08 06:21:02.761759 (MainThread): Running with dbt=0.17.0
2020-07-08 06:21:04.421805 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-07-08 06:21:04.424020 (MainThread): Tracking: tracking
2020-07-08 06:21:04.468289 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11915e190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b6ea890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b6ea690>]}
2020-07-08 06:21:04.520485 (MainThread): Partial parsing not enabled
2020-07-08 06:21:04.524384 (MainThread): Parsing macros/core.sql
2020-07-08 06:21:04.533346 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-08 06:21:04.544472 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-08 06:21:04.550029 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-08 06:21:04.579571 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-08 06:21:04.620406 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-08 06:21:04.648555 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-08 06:21:04.652224 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-08 06:21:04.664083 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-08 06:21:04.684716 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-08 06:21:04.696275 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-08 06:21:04.705111 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-08 06:21:04.711505 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-08 06:21:04.713847 (MainThread): Parsing macros/etc/query.sql
2020-07-08 06:21:04.715816 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-08 06:21:04.718580 (MainThread): Parsing macros/etc/datetime.sql
2020-07-08 06:21:04.730748 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-08 06:21:04.734311 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-08 06:21:04.737525 (MainThread): Parsing macros/adapters/common.sql
2020-07-08 06:21:04.799667 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-08 06:21:04.802382 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-08 06:21:04.804450 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-08 06:21:04.806826 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-08 06:21:04.811242 (MainThread): Parsing macros/etc.sql
2020-07-08 06:21:04.813052 (MainThread): Parsing macros/catalog.sql
2020-07-08 06:21:04.822430 (MainThread): Parsing macros/adapters.sql
2020-07-08 06:21:04.848595 (MainThread): Parsing macros/materializations/seed.sql
2020-07-08 06:21:04.852334 (MainThread): Parsing macros/materializations/view.sql
2020-07-08 06:21:04.856838 (MainThread): Parsing macros/materializations/table.sql
2020-07-08 06:21:04.872874 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-08 06:21:04.890018 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-08 06:21:04.915619 (MainThread): Partial parsing not enabled
2020-07-08 06:21:04.976754 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-08 06:21:04.976914 (MainThread): Opening a new connection, currently in state init
2020-07-08 06:21:05.015195 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-08 06:21:05.015348 (MainThread): Opening a new connection, currently in state closed
2020-07-08 06:21:05.041978 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-08 06:21:05.042156 (MainThread): Opening a new connection, currently in state closed
2020-07-08 06:21:05.364920 (MainThread): WARNING: Found documentation for resource "creditcards" which was not found or is disabled
2020-07-08 06:21:05.365230 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.unique_creditcards_country' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-08 06:21:05.365375 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_country' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-08 06:21:05.365574 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Amex_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-08 06:21:05.365836 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Mastercard_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-08 06:21:05.366024 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Visa_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-08 06:21:05.468998 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 1 seed file, 1 source
2020-07-08 06:21:05.470535 (MainThread): 
2020-07-08 06:21:05.471026 (MainThread): Acquiring new bigquery connection "master".
2020-07-08 06:21:05.471223 (MainThread): Opening a new connection, currently in state closed
2020-07-08 06:21:05.477235 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-08 06:21:05.477498 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-08 06:21:05.481252 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-08 06:21:07.573064 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-08 06:21:07.573340 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-08 06:21:07.573528 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-08 06:21:07.697312 (MainThread): 02:21:07 | Concurrency: 1 threads (target='dev')
2020-07-08 06:21:07.697643 (MainThread): 02:21:07 | 
2020-07-08 06:21:07.706004 (Thread-1): Began running node model.springml_demo_dbt_project.creditcard
2020-07-08 06:21:07.706535 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-08 06:21:07.706686 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-08 06:21:07.706846 (Thread-1): Compiling model.springml_demo_dbt_project.creditcard
2020-07-08 06:21:07.729225 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-08 06:21:07.730003 (Thread-1): finished collecting timing info
2020-07-08 06:21:07.730380 (Thread-1): finished collecting timing info
2020-07-08 06:21:07.730954 (Thread-1): Finished running node model.springml_demo_dbt_project.creditcard
2020-07-08 06:21:07.731115 (Thread-1): Began running node model.springml_demo_dbt_project.payments
2020-07-08 06:21:07.731834 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-08 06:21:07.732748 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.creditcard).
2020-07-08 06:21:07.733182 (Thread-1): Compiling model.springml_demo_dbt_project.payments
2020-07-08 06:21:07.746412 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.payments"
2020-07-08 06:21:07.751166 (Thread-1): finished collecting timing info
2020-07-08 06:21:07.751683 (Thread-1): finished collecting timing info
2020-07-08 06:21:07.752267 (Thread-1): Finished running node model.springml_demo_dbt_project.payments
2020-07-08 06:21:07.752719 (Thread-1): Began running node seed.springml_demo_dbt_project.datafile_sales
2020-07-08 06:21:07.755408 (Thread-1): Acquiring new bigquery connection "seed.springml_demo_dbt_project.datafile_sales".
2020-07-08 06:21:07.755725 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.payments).
2020-07-08 06:21:07.755916 (Thread-1): Compiling seed.springml_demo_dbt_project.datafile_sales
2020-07-08 06:21:07.780374 (Thread-1): finished collecting timing info
2020-07-08 06:21:07.780854 (Thread-1): finished collecting timing info
2020-07-08 06:21:07.781563 (Thread-1): Finished running node seed.springml_demo_dbt_project.datafile_sales
2020-07-08 06:21:07.781849 (Thread-1): Began running node test.springml_demo_dbt_project.creditcardtest
2020-07-08 06:21:07.782458 (Thread-1): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-08 06:21:07.782640 (Thread-1): Re-using an available connection from the pool (formerly seed.springml_demo_dbt_project.datafile_sales).
2020-07-08 06:21:07.782805 (Thread-1): Compiling test.springml_demo_dbt_project.creditcardtest
2020-07-08 06:21:07.801878 (Thread-1): Writing injected SQL for node "test.springml_demo_dbt_project.creditcardtest"
2020-07-08 06:21:07.807180 (Thread-1): finished collecting timing info
2020-07-08 06:21:07.807659 (Thread-1): finished collecting timing info
2020-07-08 06:21:07.808237 (Thread-1): Finished running node test.springml_demo_dbt_project.creditcardtest
2020-07-08 06:21:07.808470 (Thread-1): Began running node test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners
2020-07-08 06:21:07.809170 (Thread-1): Acquiring new bigquery connection "test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners".
2020-07-08 06:21:07.809312 (Thread-1): Re-using an available connection from the pool (formerly test.springml_demo_dbt_project.creditcardtest).
2020-07-08 06:21:07.809421 (Thread-1): Compiling test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners
2020-07-08 06:21:07.829930 (Thread-1): Writing injected SQL for node "test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners"
2020-07-08 06:21:07.830729 (Thread-1): finished collecting timing info
2020-07-08 06:21:07.831142 (Thread-1): finished collecting timing info
2020-07-08 06:21:07.831743 (Thread-1): Finished running node test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners
2020-07-08 06:21:07.831916 (Thread-1): Began running node test.springml_demo_dbt_project.not_null_payments_number_of_payments
2020-07-08 06:21:07.832286 (Thread-1): Acquiring new bigquery connection "test.springml_demo_dbt_project.not_null_payments_number_of_payments".
2020-07-08 06:21:07.832408 (Thread-1): Re-using an available connection from the pool (formerly test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners).
2020-07-08 06:21:07.832512 (Thread-1): Compiling test.springml_demo_dbt_project.not_null_payments_number_of_payments
2020-07-08 06:21:07.842760 (Thread-1): Writing injected SQL for node "test.springml_demo_dbt_project.not_null_payments_number_of_payments"
2020-07-08 06:21:07.849681 (Thread-1): finished collecting timing info
2020-07-08 06:21:07.850167 (Thread-1): finished collecting timing info
2020-07-08 06:21:07.850818 (Thread-1): Finished running node test.springml_demo_dbt_project.not_null_payments_number_of_payments
2020-07-08 06:21:07.851031 (Thread-1): Began running node test.springml_demo_dbt_project.not_null_payments_total_price
2020-07-08 06:21:07.851528 (Thread-1): Acquiring new bigquery connection "test.springml_demo_dbt_project.not_null_payments_total_price".
2020-07-08 06:21:07.851680 (Thread-1): Re-using an available connection from the pool (formerly test.springml_demo_dbt_project.not_null_payments_number_of_payments).
2020-07-08 06:21:07.851829 (Thread-1): Compiling test.springml_demo_dbt_project.not_null_payments_total_price
2020-07-08 06:21:07.860953 (Thread-1): Writing injected SQL for node "test.springml_demo_dbt_project.not_null_payments_total_price"
2020-07-08 06:21:07.862531 (Thread-1): finished collecting timing info
2020-07-08 06:21:07.862986 (Thread-1): finished collecting timing info
2020-07-08 06:21:07.863538 (Thread-1): Finished running node test.springml_demo_dbt_project.not_null_payments_total_price
2020-07-08 06:21:07.911434 (MainThread): Connection 'master' was properly closed.
2020-07-08 06:21:07.911849 (MainThread): Connection 'test.springml_demo_dbt_project.not_null_payments_total_price' was left open.
2020-07-08 06:21:07.940870 (MainThread): 02:21:07 | Done.
2020-07-08 06:21:07.957336 (MainThread): Acquiring new bigquery connection "generate_catalog".
2020-07-08 06:21:07.958172 (MainThread): Opening a new connection, currently in state init
2020-07-08 06:21:07.958614 (MainThread): 02:21:07 | Building catalog
2020-07-08 06:21:07.990340 (MainThread): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-08 06:21:08.843229 (ThreadPoolExecutor-2_0): Acquiring new bigquery connection "prismatic-cider-279015.information_schema".
2020-07-08 06:21:08.843721 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state init
2020-07-08 06:21:08.864411 (ThreadPoolExecutor-2_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-08 06:21:09.358039 (ThreadPoolExecutor-2_0): On prismatic-cider-279015.information_schema: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "connection_name": "prismatic-cider-279015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `prismatic-cider-279015`.`springml_demo_dataset`.__TABLES__
        where (upper(dataset_id) = upper('springml_demo_dataset'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,
            cast(null as string) as column_comment,

            is_partitioning_column,
            clustering_ordinal_position

        from `prismatic-cider-279015`.`springml_demo_dataset`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name

        from `prismatic-cider-279015`.`springml_demo_dataset`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS
        where data_type not like 'STRUCT%'

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2020-07-08 06:21:17.520819 (MainThread): 02:21:17 | Catalog written to /Users/medhapatil/springml/springml_demo_dbt/target/catalog.json
2020-07-08 06:21:17.521743 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bb760d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bb76150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bb761d0>]}
2020-07-08 06:21:17.522158 (MainThread): Flushing usage events
2020-07-08 06:21:18.065798 (MainThread): Connection 'generate_catalog' was left open.
2020-07-08 06:21:18.066058 (MainThread): Connection 'prismatic-cider-279015.information_schema' was left open.
2020-07-08 06:21:22.454419 (MainThread): Running with dbt=0.17.0
2020-07-08 06:21:24.482379 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8001, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-07-08 06:21:24.484324 (MainThread): Tracking: tracking
2020-07-08 06:21:24.515000 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb6cbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb80990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb80790>]}
2020-07-08 06:21:24.584111 (MainThread): Serving docs at 0.0.0.0:8001
2020-07-08 06:21:24.585830 (MainThread): To access from your browser, navigate to:  http://localhost:8001
2020-07-08 06:21:24.588735 (MainThread): Press Ctrl+C to exit.


2020-07-08 07:59:24.921112 (MainThread): Flushing usage events
2020-07-08 07:59:25.108082 (MainThread): ctrl-c
2020-07-08 09:16:49.305091 (MainThread): Running with dbt=0.17.0
2020-07-08 09:16:50.524689 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-08 09:16:50.526884 (MainThread): Tracking: tracking
2020-07-08 09:16:50.558456 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114689d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146d5a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146d5890>]}
2020-07-08 09:16:50.613448 (MainThread): Partial parsing not enabled
2020-07-08 09:16:50.616613 (MainThread): Parsing macros/core.sql
2020-07-08 09:16:50.624688 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-08 09:16:50.639094 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-08 09:16:50.643299 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-08 09:16:50.685364 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-08 09:16:50.731719 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-08 09:16:50.762142 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-08 09:16:50.765189 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-08 09:16:50.779253 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-08 09:16:50.809892 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-08 09:16:50.819234 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-08 09:16:50.829013 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-08 09:16:50.835421 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-08 09:16:50.837176 (MainThread): Parsing macros/etc/query.sql
2020-07-08 09:16:50.839469 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-08 09:16:50.842329 (MainThread): Parsing macros/etc/datetime.sql
2020-07-08 09:16:50.855312 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-08 09:16:50.858926 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-08 09:16:50.868446 (MainThread): Parsing macros/adapters/common.sql
2020-07-08 09:16:50.951674 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-08 09:16:50.953838 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-08 09:16:50.955931 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-08 09:16:50.957710 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-08 09:16:50.961021 (MainThread): Parsing macros/etc.sql
2020-07-08 09:16:50.962241 (MainThread): Parsing macros/catalog.sql
2020-07-08 09:16:50.969921 (MainThread): Parsing macros/adapters.sql
2020-07-08 09:16:51.016257 (MainThread): Parsing macros/materializations/seed.sql
2020-07-08 09:16:51.019743 (MainThread): Parsing macros/materializations/view.sql
2020-07-08 09:16:51.024269 (MainThread): Parsing macros/materializations/table.sql
2020-07-08 09:16:51.040173 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-08 09:16:51.057502 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-08 09:16:51.103266 (MainThread): Partial parsing not enabled
2020-07-08 09:16:51.164794 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-08 09:16:51.164961 (MainThread): Opening a new connection, currently in state init
2020-07-08 09:16:51.227260 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-08 09:16:51.227476 (MainThread): Opening a new connection, currently in state closed
2020-07-08 09:16:51.250365 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-08 09:16:51.250509 (MainThread): Opening a new connection, currently in state closed
2020-07-08 09:16:51.659710 (MainThread): WARNING: Found documentation for resource "creditcards" which was not found or is disabled
2020-07-08 09:16:51.660011 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.unique_creditcards_country' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-08 09:16:51.660155 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_country' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-08 09:16:51.660304 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Amex_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-08 09:16:51.660565 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Mastercard_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-08 09:16:51.660764 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Visa_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-08 09:16:51.816136 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 1 seed file, 1 source
2020-07-08 09:16:51.817137 (MainThread): 
2020-07-08 09:16:51.817510 (MainThread): Acquiring new bigquery connection "master".
2020-07-08 09:16:51.817616 (MainThread): Opening a new connection, currently in state closed
2020-07-08 09:16:51.821223 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-08 09:16:51.821436 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-08 09:16:51.824267 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-08 09:16:54.694842 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-08 09:16:54.701764 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-08 09:16:54.702371 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-08 09:16:54.830584 (MainThread): Acquiring new bigquery connection "master".
2020-07-08 09:16:54.830762 (MainThread): Opening a new connection, currently in state closed
2020-07-08 09:16:54.831177 (MainThread): 05:16:54 | Concurrency: 1 threads (target='dev')
2020-07-08 09:16:54.831437 (MainThread): 05:16:54 | 
2020-07-08 09:16:54.834078 (Thread-1): Began running node model.springml_demo_dbt_project.creditcard
2020-07-08 09:16:54.836122 (Thread-1): 05:16:54 | 1 of 2 START view model springml_demo_dataset.creditcard............. [RUN]
2020-07-08 09:16:54.836793 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-08 09:16:54.836934 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-08 09:16:54.837119 (Thread-1): Compiling model.springml_demo_dbt_project.creditcard
2020-07-08 09:16:54.863565 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-08 09:16:54.864552 (Thread-1): finished collecting timing info
2020-07-08 09:16:54.916846 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-08 09:16:54.917700 (Thread-1): On model.springml_demo_dbt_project.creditcard: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
  OPTIONS()
  as 

select country,

sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,

sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,

sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,

from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
group by country 
having not (Amex_payments = 0 
and	Mastercard_payments = 0 
and	 Visa_payments = 0)
order by (Amex_payments + Mastercard_payments + Visa_payments) desc;


2020-07-08 09:16:56.358840 (Thread-1): finished collecting timing info
2020-07-08 09:16:56.359639 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e77ede7-5e97-4039-a25b-7d2b4ca01aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148a5910>]}
2020-07-08 09:16:56.360922 (Thread-1): 05:16:56 | 1 of 2 OK created view model springml_demo_dataset.creditcard........ [CREATE VIEW in 1.52s]
2020-07-08 09:16:56.361238 (Thread-1): Finished running node model.springml_demo_dbt_project.creditcard
2020-07-08 09:16:56.361654 (Thread-1): Began running node model.springml_demo_dbt_project.payments
2020-07-08 09:16:56.364379 (Thread-1): 05:16:56 | 2 of 2 START view model springml_demo_dataset.payments............... [RUN]
2020-07-08 09:16:56.364913 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-08 09:16:56.365118 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.creditcard).
2020-07-08 09:16:56.365356 (Thread-1): Compiling model.springml_demo_dbt_project.payments
2020-07-08 09:16:56.376225 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.payments"
2020-07-08 09:16:56.376717 (Thread-1): finished collecting timing info
2020-07-08 09:16:56.381625 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.payments"
2020-07-08 09:16:56.382649 (Thread-1): On model.springml_demo_dbt_project.payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
  OPTIONS()
  as select payment_type, 
    count(*) as number_of_payments, 
    sum(price) as total_price 
from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where country like "United States"
group by payment_type;


2020-07-08 09:16:56.903282 (Thread-1): finished collecting timing info
2020-07-08 09:16:56.904456 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e77ede7-5e97-4039-a25b-7d2b4ca01aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11498db10>]}
2020-07-08 09:16:56.906043 (Thread-1): 05:16:56 | 2 of 2 OK created view model springml_demo_dataset.payments.......... [CREATE VIEW in 0.54s]
2020-07-08 09:16:56.906258 (Thread-1): Finished running node model.springml_demo_dbt_project.payments
2020-07-08 09:16:56.913171 (MainThread): Acquiring new bigquery connection "master".
2020-07-08 09:16:56.913392 (MainThread): Opening a new connection, currently in state closed
2020-07-08 09:16:56.913817 (MainThread): 05:16:56 | 
2020-07-08 09:16:56.913987 (MainThread): 05:16:56 | Finished running 2 view models in 5.10s.
2020-07-08 09:16:56.914141 (MainThread): Connection 'master' was properly closed.
2020-07-08 09:16:56.914237 (MainThread): Connection 'model.springml_demo_dbt_project.payments' was left open.
2020-07-08 09:16:56.923063 (MainThread): 
2020-07-08 09:16:56.923300 (MainThread): Completed successfully
2020-07-08 09:16:56.923463 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-07-08 09:16:56.923726 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148e09d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11498db10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11498ded0>]}
2020-07-08 09:16:56.923941 (MainThread): Flushing usage events
2020-07-08 09:20:53.473725 (MainThread): Running with dbt=0.17.0
2020-07-08 09:20:55.166750 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-07-08 09:20:55.186151 (MainThread): Tracking: tracking
2020-07-08 09:20:55.217094 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e8f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11147bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e95ad0>]}
2020-07-08 09:20:55.248825 (MainThread): Partial parsing not enabled
2020-07-08 09:20:55.251544 (MainThread): Parsing macros/core.sql
2020-07-08 09:20:55.259561 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-08 09:20:55.284752 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-08 09:20:55.290560 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-08 09:20:55.327096 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-08 09:20:55.364834 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-08 09:20:55.414639 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-08 09:20:55.417504 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-08 09:20:55.426296 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-08 09:20:55.464436 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-08 09:20:55.475380 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-08 09:20:55.493239 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-08 09:20:55.503847 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-08 09:20:55.505617 (MainThread): Parsing macros/etc/query.sql
2020-07-08 09:20:55.508767 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-08 09:20:55.511447 (MainThread): Parsing macros/etc/datetime.sql
2020-07-08 09:20:55.525192 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-08 09:20:55.528507 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-08 09:20:55.531686 (MainThread): Parsing macros/adapters/common.sql
2020-07-08 09:20:55.624128 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-08 09:20:55.625917 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-08 09:20:55.627726 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-08 09:20:55.629595 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-08 09:20:55.632863 (MainThread): Parsing macros/etc.sql
2020-07-08 09:20:55.634230 (MainThread): Parsing macros/catalog.sql
2020-07-08 09:20:55.641891 (MainThread): Parsing macros/adapters.sql
2020-07-08 09:20:55.670388 (MainThread): Parsing macros/materializations/seed.sql
2020-07-08 09:20:55.673872 (MainThread): Parsing macros/materializations/view.sql
2020-07-08 09:20:55.680335 (MainThread): Parsing macros/materializations/table.sql
2020-07-08 09:20:55.710459 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-08 09:20:55.733024 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-08 09:20:55.772800 (MainThread): Partial parsing not enabled
2020-07-08 09:20:55.853916 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-08 09:20:55.854114 (MainThread): Opening a new connection, currently in state init
2020-07-08 09:20:55.910458 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-08 09:20:55.910804 (MainThread): Opening a new connection, currently in state closed
2020-07-08 09:20:55.938682 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-08 09:20:55.938843 (MainThread): Opening a new connection, currently in state closed
2020-07-08 09:20:56.349419 (MainThread): WARNING: Found documentation for resource "creditcards" which was not found or is disabled
2020-07-08 09:20:56.349727 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.unique_creditcards_country' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-08 09:20:56.349930 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_country' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-08 09:20:56.350140 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Amex_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-08 09:20:56.350417 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Mastercard_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-08 09:20:56.350592 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Visa_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-08 09:20:56.555399 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 1 seed file, 1 source
2020-07-08 09:20:56.558080 (MainThread): 
2020-07-08 09:20:56.558560 (MainThread): Acquiring new bigquery connection "master".
2020-07-08 09:20:56.558689 (MainThread): Opening a new connection, currently in state closed
2020-07-08 09:20:56.581188 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-08 09:20:56.581420 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-07-08 09:20:56.590721 (ThreadPoolExecutor-1_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-08 09:20:58.118423 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-08 09:20:58.585467 (MainThread): Acquiring new bigquery connection "master".
2020-07-08 09:20:58.585653 (MainThread): Opening a new connection, currently in state closed
2020-07-08 09:20:58.585965 (MainThread): 05:20:58 | Concurrency: 1 threads (target='dev')
2020-07-08 09:20:58.586132 (MainThread): 05:20:58 | 
2020-07-08 09:20:58.589745 (Thread-1): Began running node test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners
2020-07-08 09:20:58.589994 (Thread-1): 05:20:58 | 1 of 4 START test accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners [RUN]
2020-07-08 09:20:58.590376 (Thread-1): Acquiring new bigquery connection "test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners".
2020-07-08 09:20:58.590490 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-08 09:20:58.590617 (Thread-1): Compiling test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners
2020-07-08 09:20:58.617945 (Thread-1): Writing injected SQL for node "test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners"
2020-07-08 09:20:58.619285 (Thread-1): finished collecting timing info
2020-07-08 09:20:58.620096 (Thread-1): On test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners"} */





with all_values as (

    select distinct
        payment_type as value_field

    from `prismatic-cider-279015`.`springml_demo_dataset`.`payments`

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'Mastercard','Amex','Visa','Diners'
    )
)

select count(*) as validation_errors
from validation_errors


2020-07-08 09:21:00.522203 (Thread-1): finished collecting timing info
2020-07-08 09:21:00.522985 (Thread-1): 05:21:00 | 1 of 4 PASS accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners [PASS in 1.93s]
2020-07-08 09:21:00.523194 (Thread-1): Finished running node test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners
2020-07-08 09:21:00.523464 (Thread-1): Began running node test.springml_demo_dbt_project.creditcardtest
2020-07-08 09:21:00.523682 (Thread-1): 05:21:00 | 2 of 4 START test creditcardtest..................................... [RUN]
2020-07-08 09:21:00.524283 (Thread-1): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-08 09:21:00.524428 (Thread-1): Re-using an available connection from the pool (formerly test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners).
2020-07-08 09:21:00.524562 (Thread-1): Compiling test.springml_demo_dbt_project.creditcardtest
2020-07-08 09:21:00.554762 (Thread-1): Writing injected SQL for node "test.springml_demo_dbt_project.creditcardtest"
2020-07-08 09:21:00.565038 (Thread-1): finished collecting timing info
2020-07-08 09:21:00.565877 (Thread-1): On test.springml_demo_dbt_project.creditcardtest: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "test.springml_demo_dbt_project.creditcardtest"} */
select count(*) as errors from (
-- Making sure that there are no countries that have zero payments in all three credit cards

select country
from `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
where Amex_payments = 0 and	Mastercard_payments = 0 and	 Visa_payments = 0
) sbq
2020-07-08 09:21:01.895464 (Thread-1): finished collecting timing info
2020-07-08 09:21:01.896990 (Thread-1): 05:21:01 | 2 of 4 PASS creditcardtest........................................... [PASS in 1.37s]
2020-07-08 09:21:01.897382 (Thread-1): Finished running node test.springml_demo_dbt_project.creditcardtest
2020-07-08 09:21:01.897713 (Thread-1): Began running node test.springml_demo_dbt_project.not_null_payments_number_of_payments
2020-07-08 09:21:01.897993 (Thread-1): 05:21:01 | 3 of 4 START test not_null_payments_number_of_payments............... [RUN]
2020-07-08 09:21:01.898531 (Thread-1): Acquiring new bigquery connection "test.springml_demo_dbt_project.not_null_payments_number_of_payments".
2020-07-08 09:21:01.898651 (Thread-1): Re-using an available connection from the pool (formerly test.springml_demo_dbt_project.creditcardtest).
2020-07-08 09:21:01.898760 (Thread-1): Compiling test.springml_demo_dbt_project.not_null_payments_number_of_payments
2020-07-08 09:21:01.911317 (Thread-1): Writing injected SQL for node "test.springml_demo_dbt_project.not_null_payments_number_of_payments"
2020-07-08 09:21:01.913696 (Thread-1): finished collecting timing info
2020-07-08 09:21:01.914108 (Thread-1): On test.springml_demo_dbt_project.not_null_payments_number_of_payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "test.springml_demo_dbt_project.not_null_payments_number_of_payments"} */




select count(*) as validation_errors
from `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
where number_of_payments is null


2020-07-08 09:21:03.731356 (Thread-1): finished collecting timing info
2020-07-08 09:21:03.732045 (Thread-1): 05:21:03 | 3 of 4 PASS not_null_payments_number_of_payments..................... [PASS in 1.83s]
2020-07-08 09:21:03.732236 (Thread-1): Finished running node test.springml_demo_dbt_project.not_null_payments_number_of_payments
2020-07-08 09:21:03.732491 (Thread-1): Began running node test.springml_demo_dbt_project.not_null_payments_total_price
2020-07-08 09:21:03.732814 (Thread-1): 05:21:03 | 4 of 4 START test not_null_payments_total_price...................... [RUN]
2020-07-08 09:21:03.733184 (Thread-1): Acquiring new bigquery connection "test.springml_demo_dbt_project.not_null_payments_total_price".
2020-07-08 09:21:03.733290 (Thread-1): Re-using an available connection from the pool (formerly test.springml_demo_dbt_project.not_null_payments_number_of_payments).
2020-07-08 09:21:03.733395 (Thread-1): Compiling test.springml_demo_dbt_project.not_null_payments_total_price
2020-07-08 09:21:03.743731 (Thread-1): Writing injected SQL for node "test.springml_demo_dbt_project.not_null_payments_total_price"
2020-07-08 09:21:03.744179 (Thread-1): finished collecting timing info
2020-07-08 09:21:03.744473 (Thread-1): On test.springml_demo_dbt_project.not_null_payments_total_price: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "test.springml_demo_dbt_project.not_null_payments_total_price"} */




select count(*) as validation_errors
from `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
where total_price is null


2020-07-08 09:21:05.074188 (Thread-1): finished collecting timing info
2020-07-08 09:21:05.074941 (Thread-1): 05:21:05 | 4 of 4 PASS not_null_payments_total_price............................ [PASS in 1.34s]
2020-07-08 09:21:05.075153 (Thread-1): Finished running node test.springml_demo_dbt_project.not_null_payments_total_price
2020-07-08 09:21:05.098808 (MainThread): Acquiring new bigquery connection "master".
2020-07-08 09:21:05.099050 (MainThread): Opening a new connection, currently in state closed
2020-07-08 09:21:05.099435 (MainThread): 05:21:05 | 
2020-07-08 09:21:05.099598 (MainThread): 05:21:05 | Finished running 4 tests in 8.54s.
2020-07-08 09:21:05.099727 (MainThread): Connection 'master' was properly closed.
2020-07-08 09:21:05.099816 (MainThread): Connection 'test.springml_demo_dbt_project.not_null_payments_total_price' was left open.
2020-07-08 09:21:05.127421 (MainThread): 
2020-07-08 09:21:05.127784 (MainThread): Completed successfully
2020-07-08 09:21:05.128101 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-07-08 09:21:05.128670 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131696d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113056490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f77190>]}
2020-07-08 09:21:05.129399 (MainThread): Flushing usage events
2020-07-08 09:22:13.605641 (MainThread): Running with dbt=0.17.0
2020-07-08 09:22:14.674944 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-07-08 09:22:14.684661 (MainThread): Tracking: tracking
2020-07-08 09:22:14.712781 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7bf190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d713390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7c7b50>]}
2020-07-08 09:22:14.743515 (MainThread): Partial parsing not enabled
2020-07-08 09:22:14.747189 (MainThread): Parsing macros/core.sql
2020-07-08 09:22:14.756970 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-08 09:22:14.799160 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-08 09:22:14.804285 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-08 09:22:14.835864 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-08 09:22:14.889644 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-08 09:22:14.928658 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-08 09:22:14.931632 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-08 09:22:14.941269 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-08 09:22:14.964521 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-08 09:22:14.995988 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-08 09:22:15.017700 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-08 09:22:15.024912 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-08 09:22:15.026674 (MainThread): Parsing macros/etc/query.sql
2020-07-08 09:22:15.029498 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-08 09:22:15.033235 (MainThread): Parsing macros/etc/datetime.sql
2020-07-08 09:22:15.048619 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-08 09:22:15.051664 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-08 09:22:15.054202 (MainThread): Parsing macros/adapters/common.sql
2020-07-08 09:22:15.143865 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-08 09:22:15.146351 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-08 09:22:15.148517 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-08 09:22:15.150237 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-08 09:22:15.153587 (MainThread): Parsing macros/etc.sql
2020-07-08 09:22:15.155052 (MainThread): Parsing macros/catalog.sql
2020-07-08 09:22:15.163373 (MainThread): Parsing macros/adapters.sql
2020-07-08 09:22:15.199210 (MainThread): Parsing macros/materializations/seed.sql
2020-07-08 09:22:15.204820 (MainThread): Parsing macros/materializations/view.sql
2020-07-08 09:22:15.211685 (MainThread): Parsing macros/materializations/table.sql
2020-07-08 09:22:15.228265 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-08 09:22:15.247233 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-08 09:22:15.290547 (MainThread): Partial parsing not enabled
2020-07-08 09:22:15.366344 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-08 09:22:15.366520 (MainThread): Opening a new connection, currently in state init
2020-07-08 09:22:15.440581 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-08 09:22:15.440773 (MainThread): Opening a new connection, currently in state closed
2020-07-08 09:22:15.497780 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-08 09:22:15.498037 (MainThread): Opening a new connection, currently in state closed
2020-07-08 09:22:15.970771 (MainThread): WARNING: Found documentation for resource "creditcards" which was not found or is disabled
2020-07-08 09:22:15.971503 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.unique_creditcards_country' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-08 09:22:15.971728 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_country' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-08 09:22:15.971908 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Amex_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-08 09:22:15.972093 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Mastercard_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-08 09:22:15.972432 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Visa_payments' (models/base/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-08 09:22:16.160679 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 1 seed file, 1 source
2020-07-08 09:22:16.162456 (MainThread): 
2020-07-08 09:22:16.162984 (MainThread): Acquiring new bigquery connection "master".
2020-07-08 09:22:16.163134 (MainThread): Opening a new connection, currently in state closed
2020-07-08 09:22:16.168733 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-08 09:22:16.168983 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-08 09:22:16.171822 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-08 09:22:18.478030 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-08 09:22:18.478293 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-08 09:22:18.478519 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-08 09:22:18.693087 (MainThread): 05:22:18 | Concurrency: 1 threads (target='dev')
2020-07-08 09:22:18.693345 (MainThread): 05:22:18 | 
2020-07-08 09:22:18.695830 (Thread-1): Began running node model.springml_demo_dbt_project.creditcard
2020-07-08 09:22:18.696291 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-08 09:22:18.696452 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-08 09:22:18.696609 (Thread-1): Compiling model.springml_demo_dbt_project.creditcard
2020-07-08 09:22:18.717466 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-08 09:22:18.718884 (Thread-1): finished collecting timing info
2020-07-08 09:22:18.719330 (Thread-1): finished collecting timing info
2020-07-08 09:22:18.719814 (Thread-1): Finished running node model.springml_demo_dbt_project.creditcard
2020-07-08 09:22:18.719981 (Thread-1): Began running node model.springml_demo_dbt_project.payments
2020-07-08 09:22:18.720509 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-08 09:22:18.720634 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.creditcard).
2020-07-08 09:22:18.720727 (Thread-1): Compiling model.springml_demo_dbt_project.payments
2020-07-08 09:22:18.740983 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.payments"
2020-07-08 09:22:18.742342 (Thread-1): finished collecting timing info
2020-07-08 09:22:18.742925 (Thread-1): finished collecting timing info
2020-07-08 09:22:18.743614 (Thread-1): Finished running node model.springml_demo_dbt_project.payments
2020-07-08 09:22:18.743883 (Thread-1): Began running node seed.springml_demo_dbt_project.datafile_sales
2020-07-08 09:22:18.744467 (Thread-1): Acquiring new bigquery connection "seed.springml_demo_dbt_project.datafile_sales".
2020-07-08 09:22:18.744921 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.payments).
2020-07-08 09:22:18.745110 (Thread-1): Compiling seed.springml_demo_dbt_project.datafile_sales
2020-07-08 09:22:18.765477 (Thread-1): finished collecting timing info
2020-07-08 09:22:18.766143 (Thread-1): finished collecting timing info
2020-07-08 09:22:18.767120 (Thread-1): Finished running node seed.springml_demo_dbt_project.datafile_sales
2020-07-08 09:22:18.767677 (Thread-1): Began running node test.springml_demo_dbt_project.creditcardtest
2020-07-08 09:22:18.768783 (Thread-1): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-08 09:22:18.768945 (Thread-1): Re-using an available connection from the pool (formerly seed.springml_demo_dbt_project.datafile_sales).
2020-07-08 09:22:18.769046 (Thread-1): Compiling test.springml_demo_dbt_project.creditcardtest
2020-07-08 09:22:18.790801 (Thread-1): Writing injected SQL for node "test.springml_demo_dbt_project.creditcardtest"
2020-07-08 09:22:18.792097 (Thread-1): finished collecting timing info
2020-07-08 09:22:18.792429 (Thread-1): finished collecting timing info
2020-07-08 09:22:18.792896 (Thread-1): Finished running node test.springml_demo_dbt_project.creditcardtest
2020-07-08 09:22:18.793055 (Thread-1): Began running node test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners
2020-07-08 09:22:18.793359 (Thread-1): Acquiring new bigquery connection "test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners".
2020-07-08 09:22:18.793471 (Thread-1): Re-using an available connection from the pool (formerly test.springml_demo_dbt_project.creditcardtest).
2020-07-08 09:22:18.793576 (Thread-1): Compiling test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners
2020-07-08 09:22:18.812814 (Thread-1): Writing injected SQL for node "test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners"
2020-07-08 09:22:18.814380 (Thread-1): finished collecting timing info
2020-07-08 09:22:18.814804 (Thread-1): finished collecting timing info
2020-07-08 09:22:18.815438 (Thread-1): Finished running node test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners
2020-07-08 09:22:18.815599 (Thread-1): Began running node test.springml_demo_dbt_project.not_null_payments_number_of_payments
2020-07-08 09:22:18.815878 (Thread-1): Acquiring new bigquery connection "test.springml_demo_dbt_project.not_null_payments_number_of_payments".
2020-07-08 09:22:18.815984 (Thread-1): Re-using an available connection from the pool (formerly test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners).
2020-07-08 09:22:18.816085 (Thread-1): Compiling test.springml_demo_dbt_project.not_null_payments_number_of_payments
2020-07-08 09:22:18.827461 (Thread-1): Writing injected SQL for node "test.springml_demo_dbt_project.not_null_payments_number_of_payments"
2020-07-08 09:22:18.828514 (Thread-1): finished collecting timing info
2020-07-08 09:22:18.829074 (Thread-1): finished collecting timing info
2020-07-08 09:22:18.830081 (Thread-1): Finished running node test.springml_demo_dbt_project.not_null_payments_number_of_payments
2020-07-08 09:22:18.830410 (Thread-1): Began running node test.springml_demo_dbt_project.not_null_payments_total_price
2020-07-08 09:22:18.831070 (Thread-1): Acquiring new bigquery connection "test.springml_demo_dbt_project.not_null_payments_total_price".
2020-07-08 09:22:18.831261 (Thread-1): Re-using an available connection from the pool (formerly test.springml_demo_dbt_project.not_null_payments_number_of_payments).
2020-07-08 09:22:18.831387 (Thread-1): Compiling test.springml_demo_dbt_project.not_null_payments_total_price
2020-07-08 09:22:18.845006 (Thread-1): Writing injected SQL for node "test.springml_demo_dbt_project.not_null_payments_total_price"
2020-07-08 09:22:18.845703 (Thread-1): finished collecting timing info
2020-07-08 09:22:18.846143 (Thread-1): finished collecting timing info
2020-07-08 09:22:18.846757 (Thread-1): Finished running node test.springml_demo_dbt_project.not_null_payments_total_price
2020-07-08 09:22:18.900245 (MainThread): Connection 'master' was properly closed.
2020-07-08 09:22:18.900450 (MainThread): Connection 'test.springml_demo_dbt_project.not_null_payments_total_price' was left open.
2020-07-08 09:22:18.923885 (MainThread): 05:22:18 | Done.
2020-07-08 09:22:18.968625 (MainThread): Acquiring new bigquery connection "generate_catalog".
2020-07-08 09:22:18.968911 (MainThread): Opening a new connection, currently in state init
2020-07-08 09:22:18.969042 (MainThread): 05:22:18 | Building catalog
2020-07-08 09:22:19.014855 (MainThread): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-08 09:22:21.318692 (ThreadPoolExecutor-2_0): Acquiring new bigquery connection "prismatic-cider-279015.information_schema".
2020-07-08 09:22:21.319150 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state init
2020-07-08 09:22:21.339640 (ThreadPoolExecutor-2_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-08 09:22:22.039278 (ThreadPoolExecutor-2_0): On prismatic-cider-279015.information_schema: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "connection_name": "prismatic-cider-279015.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `prismatic-cider-279015`.`springml_demo_dataset`.__TABLES__
        where (upper(dataset_id) = upper('springml_demo_dataset'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,
            cast(null as string) as column_comment,

            is_partitioning_column,
            clustering_ordinal_position

        from `prismatic-cider-279015`.`springml_demo_dataset`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name

        from `prismatic-cider-279015`.`springml_demo_dataset`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS
        where data_type not like 'STRUCT%'

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2020-07-08 09:22:26.075617 (MainThread): 05:22:26 | Catalog written to /Users/medhapatil/springml/springml_demo_dbt/target/catalog.json
2020-07-08 09:22:26.076011 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f463090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f463150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4631d0>]}
2020-07-08 09:22:26.076276 (MainThread): Flushing usage events
2020-07-08 09:22:26.356949 (MainThread): Connection 'generate_catalog' was left open.
2020-07-08 09:22:26.357112 (MainThread): Connection 'prismatic-cider-279015.information_schema' was left open.
2020-07-08 09:23:25.128031 (MainThread): Running with dbt=0.17.0
2020-07-08 09:23:26.524736 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8001, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-07-08 09:23:26.527588 (MainThread): Tracking: tracking
2020-07-08 09:23:26.547054 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4b0750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4b0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4c96d0>]}
2020-07-08 09:23:26.559502 (MainThread): Serving docs at 0.0.0.0:8001
2020-07-08 09:23:26.559960 (MainThread): To access from your browser, navigate to:  http://localhost:8001
2020-07-08 09:23:26.560132 (MainThread): Press Ctrl+C to exit.


2020-07-08 09:31:25.766522 (MainThread): Flushing usage events
2020-07-08 09:31:26.009973 (MainThread): ctrl-c
2020-07-08 09:31:26.010787 (MainThread): unclosed <socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.136', 56374), raddr=('3.211.96.98', 443)>
2020-07-16 15:05:10.901511 (MainThread): Running with dbt=0.17.0
2020-07-16 15:05:13.665194 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-16 15:05:13.666658 (MainThread): Tracking: tracking
2020-07-16 15:05:13.895871 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11af09b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11af1f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ab0d890>]}
2020-07-16 15:05:13.936397 (MainThread): Partial parsing not enabled
2020-07-16 15:05:13.941556 (MainThread): Parsing macros/core.sql
2020-07-16 15:05:13.953986 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-16 15:05:13.969972 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-16 15:05:13.974478 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-16 15:05:14.010915 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-16 15:05:14.063763 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-16 15:05:14.091892 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-16 15:05:14.094651 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-16 15:05:14.102988 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-16 15:05:14.120234 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-16 15:05:14.129134 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-16 15:05:14.137322 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-16 15:05:14.143698 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-16 15:05:14.145296 (MainThread): Parsing macros/etc/query.sql
2020-07-16 15:05:14.147019 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-16 15:05:14.149471 (MainThread): Parsing macros/etc/datetime.sql
2020-07-16 15:05:14.160784 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-16 15:05:14.163632 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-16 15:05:14.166137 (MainThread): Parsing macros/adapters/common.sql
2020-07-16 15:05:14.226474 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-16 15:05:14.228346 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-16 15:05:14.229887 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-16 15:05:14.231662 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-16 15:05:14.234891 (MainThread): Parsing macros/etc.sql
2020-07-16 15:05:14.236153 (MainThread): Parsing macros/catalog.sql
2020-07-16 15:05:14.243622 (MainThread): Parsing macros/adapters.sql
2020-07-16 15:05:14.267149 (MainThread): Parsing macros/materializations/seed.sql
2020-07-16 15:05:14.270286 (MainThread): Parsing macros/materializations/view.sql
2020-07-16 15:05:14.273345 (MainThread): Parsing macros/materializations/table.sql
2020-07-16 15:05:14.295044 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-16 15:05:14.321221 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-16 15:05:14.356466 (MainThread): Partial parsing not enabled
2020-07-16 15:05:14.406927 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-16 15:05:14.407131 (MainThread): Opening a new connection, currently in state init
2020-07-16 15:05:14.441366 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-16 15:05:14.441528 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:05:14.464024 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-16 15:05:14.464203 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:05:14.768590 (MainThread): WARNING: Found documentation for resource "creditcards" which was not found or is disabled
2020-07-16 15:05:14.769050 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.unique_creditcards_country' (models/part_1_model/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-16 15:05:14.769199 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_country' (models/part_1_model/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-16 15:05:14.769326 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Amex_payments' (models/part_1_model/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-16 15:05:14.769450 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Mastercard_payments' (models/part_1_model/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-16 15:05:14.769571 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Visa_payments' (models/part_1_model/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-16 15:05:14.807857 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.springml_demo_dbt_project.part_2_model

2020-07-16 15:05:14.877545 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 2 seed files, 1 source
2020-07-16 15:05:14.878943 (MainThread): 
2020-07-16 15:05:14.879418 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 15:05:14.879560 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:05:14.884210 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-16 15:05:14.884535 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-16 15:05:14.890805 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-16 15:05:18.890661 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-16 15:05:18.890927 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-16 15:05:18.891140 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 15:05:19.040137 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 15:05:19.040356 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:05:19.040770 (MainThread): 11:05:19 | Concurrency: 1 threads (target='dev')
2020-07-16 15:05:19.040984 (MainThread): 11:05:19 | 
2020-07-16 15:05:19.045317 (Thread-1): Began running node model.springml_demo_dbt_project.creditcard
2020-07-16 15:05:19.047008 (Thread-1): 11:05:19 | 1 of 2 START view model springml_demo_dataset.creditcard............. [RUN]
2020-07-16 15:05:19.047418 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-16 15:05:19.047532 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-16 15:05:19.047655 (Thread-1): Compiling model.springml_demo_dbt_project.creditcard
2020-07-16 15:05:19.067678 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-16 15:05:19.068260 (Thread-1): finished collecting timing info
2020-07-16 15:05:19.106029 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-16 15:05:19.106617 (Thread-1): On model.springml_demo_dbt_project.creditcard: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
  OPTIONS()
  as 

select country,

sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,

sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,

sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,

from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
group by country 
having not (Amex_payments = 0 
and	Mastercard_payments = 0 
and	 Visa_payments = 0)
order by (Amex_payments + Mastercard_payments + Visa_payments) desc;


2020-07-16 15:05:20.114198 (Thread-1): finished collecting timing info
2020-07-16 15:05:20.115469 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90fe24d1-bdd5-4370-aa7a-bdae1e6b9577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b016d90>]}
2020-07-16 15:05:20.117300 (Thread-1): 11:05:20 | 1 of 2 OK created view model springml_demo_dataset.creditcard........ [CREATE VIEW in 1.07s]
2020-07-16 15:05:20.117496 (Thread-1): Finished running node model.springml_demo_dbt_project.creditcard
2020-07-16 15:05:20.117740 (Thread-1): Began running node model.springml_demo_dbt_project.payments
2020-07-16 15:05:20.120279 (Thread-1): 11:05:20 | 2 of 2 START view model springml_demo_dataset.payments............... [RUN]
2020-07-16 15:05:20.120881 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-16 15:05:20.121015 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.creditcard).
2020-07-16 15:05:20.121114 (Thread-1): Compiling model.springml_demo_dbt_project.payments
2020-07-16 15:05:20.134237 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.payments"
2020-07-16 15:05:20.134749 (Thread-1): finished collecting timing info
2020-07-16 15:05:20.140137 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.payments"
2020-07-16 15:05:20.140645 (Thread-1): On model.springml_demo_dbt_project.payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
  OPTIONS()
  as select payment_type, 
    count(*) as number_of_payments, 
    sum(price) as total_price 
from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where country like "United States"
group by payment_type;


2020-07-16 15:05:20.752373 (Thread-1): finished collecting timing info
2020-07-16 15:05:20.753317 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90fe24d1-bdd5-4370-aa7a-bdae1e6b9577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b11b2d0>]}
2020-07-16 15:05:20.754822 (Thread-1): 11:05:20 | 2 of 2 OK created view model springml_demo_dataset.payments.......... [CREATE VIEW in 0.63s]
2020-07-16 15:05:20.754988 (Thread-1): Finished running node model.springml_demo_dbt_project.payments
2020-07-16 15:05:20.804305 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 15:05:20.804579 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:05:20.805106 (MainThread): 11:05:20 | 
2020-07-16 15:05:20.805347 (MainThread): 11:05:20 | Finished running 2 view models in 5.93s.
2020-07-16 15:05:20.805514 (MainThread): Connection 'master' was properly closed.
2020-07-16 15:05:20.805644 (MainThread): Connection 'model.springml_demo_dbt_project.payments' was left open.
2020-07-16 15:05:20.814265 (MainThread): 
2020-07-16 15:05:20.814459 (MainThread): Completed successfully
2020-07-16 15:05:20.814688 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-07-16 15:05:20.814992 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b048d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b1296d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b12c1d0>]}
2020-07-16 15:05:20.815220 (MainThread): Flushing usage events
2020-07-16 15:05:32.054840 (MainThread): Running with dbt=0.17.0
2020-07-16 15:05:36.489842 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-07-16 15:05:36.502712 (MainThread): Tracking: tracking
2020-07-16 15:05:36.544484 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144d12d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144d6bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144d69d0>]}
2020-07-16 15:05:36.586509 (MainThread): Partial parsing not enabled
2020-07-16 15:05:36.593444 (MainThread): Parsing macros/core.sql
2020-07-16 15:05:36.608627 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-16 15:05:36.634504 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-16 15:05:36.641601 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-16 15:05:36.694643 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-16 15:05:36.745798 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-16 15:05:36.786808 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-16 15:05:36.793003 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-16 15:05:36.809912 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-16 15:05:36.831604 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-16 15:05:36.844268 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-16 15:05:36.856346 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-16 15:05:36.863361 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-16 15:05:36.865165 (MainThread): Parsing macros/etc/query.sql
2020-07-16 15:05:36.867053 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-16 15:05:36.869792 (MainThread): Parsing macros/etc/datetime.sql
2020-07-16 15:05:36.882492 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-16 15:05:36.885550 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-16 15:05:36.888096 (MainThread): Parsing macros/adapters/common.sql
2020-07-16 15:05:36.961867 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-16 15:05:36.965147 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-16 15:05:36.967303 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-16 15:05:36.969719 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-16 15:05:36.973740 (MainThread): Parsing macros/etc.sql
2020-07-16 15:05:36.975214 (MainThread): Parsing macros/catalog.sql
2020-07-16 15:05:36.984461 (MainThread): Parsing macros/adapters.sql
2020-07-16 15:05:37.012520 (MainThread): Parsing macros/materializations/seed.sql
2020-07-16 15:05:37.016804 (MainThread): Parsing macros/materializations/view.sql
2020-07-16 15:05:37.020645 (MainThread): Parsing macros/materializations/table.sql
2020-07-16 15:05:37.037057 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-16 15:05:37.064680 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-16 15:05:37.099025 (MainThread): Partial parsing not enabled
2020-07-16 15:05:37.158994 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-16 15:05:37.159362 (MainThread): Opening a new connection, currently in state init
2020-07-16 15:05:37.222008 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-16 15:05:37.222217 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:05:37.247739 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-16 15:05:37.247886 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:05:37.605874 (MainThread): WARNING: Found documentation for resource "creditcards" which was not found or is disabled
2020-07-16 15:05:37.606185 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.unique_creditcards_country' (models/part_1_model/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-16 15:05:37.606384 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_country' (models/part_1_model/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-16 15:05:37.606534 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Amex_payments' (models/part_1_model/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-16 15:05:37.606665 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Mastercard_payments' (models/part_1_model/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-16 15:05:37.606799 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Visa_payments' (models/part_1_model/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-16 15:05:37.649445 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.springml_demo_dbt_project.part_2_model

2020-07-16 15:05:37.732674 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 2 seed files, 1 source
2020-07-16 15:05:37.733755 (MainThread): 
2020-07-16 15:05:37.734145 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 15:05:37.734254 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:05:37.753464 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-16 15:05:37.753717 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-07-16 15:05:37.755437 (ThreadPoolExecutor-1_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-16 15:05:39.818766 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 15:05:40.275103 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 15:05:40.275268 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:05:40.275595 (MainThread): 11:05:40 | Concurrency: 1 threads (target='dev')
2020-07-16 15:05:40.275754 (MainThread): 11:05:40 | 
2020-07-16 15:05:40.278769 (Thread-1): Began running node test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners
2020-07-16 15:05:40.279014 (Thread-1): 11:05:40 | 1 of 4 START test accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners [RUN]
2020-07-16 15:05:40.279554 (Thread-1): Acquiring new bigquery connection "test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners".
2020-07-16 15:05:40.279730 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-16 15:05:40.279858 (Thread-1): Compiling test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners
2020-07-16 15:05:40.304121 (Thread-1): Writing injected SQL for node "test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners"
2020-07-16 15:05:40.304774 (Thread-1): finished collecting timing info
2020-07-16 15:05:40.305143 (Thread-1): On test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners"} */





with all_values as (

    select distinct
        payment_type as value_field

    from `prismatic-cider-279015`.`springml_demo_dataset`.`payments`

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'Mastercard','Amex','Visa','Diners'
    )
)

select count(*) as validation_errors
from validation_errors


2020-07-16 15:05:41.871915 (Thread-1): finished collecting timing info
2020-07-16 15:05:41.872775 (Thread-1): 11:05:41 | 1 of 4 PASS accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners [PASS in 1.59s]
2020-07-16 15:05:41.873022 (Thread-1): Finished running node test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners
2020-07-16 15:05:41.873324 (Thread-1): Began running node test.springml_demo_dbt_project.creditcardtest
2020-07-16 15:05:41.873538 (Thread-1): 11:05:41 | 2 of 4 START test creditcardtest..................................... [RUN]
2020-07-16 15:05:41.873963 (Thread-1): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-16 15:05:41.874259 (Thread-1): Re-using an available connection from the pool (formerly test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners).
2020-07-16 15:05:41.874456 (Thread-1): Compiling test.springml_demo_dbt_project.creditcardtest
2020-07-16 15:05:41.890632 (Thread-1): Writing injected SQL for node "test.springml_demo_dbt_project.creditcardtest"
2020-07-16 15:05:41.892418 (Thread-1): finished collecting timing info
2020-07-16 15:05:41.892968 (Thread-1): On test.springml_demo_dbt_project.creditcardtest: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "test.springml_demo_dbt_project.creditcardtest"} */
select count(*) as errors from (
-- Making sure that there are no countries that have zero payments in all three credit cards

select country
from `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
where Amex_payments = 0 and	Mastercard_payments = 0 and	 Visa_payments = 0
) sbq
2020-07-16 15:05:43.393977 (Thread-1): finished collecting timing info
2020-07-16 15:05:43.395102 (Thread-1): 11:05:43 | 2 of 4 PASS creditcardtest........................................... [PASS in 1.52s]
2020-07-16 15:05:43.395345 (Thread-1): Finished running node test.springml_demo_dbt_project.creditcardtest
2020-07-16 15:05:43.395653 (Thread-1): Began running node test.springml_demo_dbt_project.not_null_payments_number_of_payments
2020-07-16 15:05:43.395981 (Thread-1): 11:05:43 | 3 of 4 START test not_null_payments_number_of_payments............... [RUN]
2020-07-16 15:05:43.396409 (Thread-1): Acquiring new bigquery connection "test.springml_demo_dbt_project.not_null_payments_number_of_payments".
2020-07-16 15:05:43.396568 (Thread-1): Re-using an available connection from the pool (formerly test.springml_demo_dbt_project.creditcardtest).
2020-07-16 15:05:43.396701 (Thread-1): Compiling test.springml_demo_dbt_project.not_null_payments_number_of_payments
2020-07-16 15:05:43.408082 (Thread-1): Writing injected SQL for node "test.springml_demo_dbt_project.not_null_payments_number_of_payments"
2020-07-16 15:05:43.408707 (Thread-1): finished collecting timing info
2020-07-16 15:05:43.409220 (Thread-1): On test.springml_demo_dbt_project.not_null_payments_number_of_payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "test.springml_demo_dbt_project.not_null_payments_number_of_payments"} */




select count(*) as validation_errors
from `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
where number_of_payments is null


2020-07-16 15:05:45.147019 (Thread-1): finished collecting timing info
2020-07-16 15:05:45.147713 (Thread-1): 11:05:45 | 3 of 4 PASS not_null_payments_number_of_payments..................... [PASS in 1.75s]
2020-07-16 15:05:45.147906 (Thread-1): Finished running node test.springml_demo_dbt_project.not_null_payments_number_of_payments
2020-07-16 15:05:45.148117 (Thread-1): Began running node test.springml_demo_dbt_project.not_null_payments_total_price
2020-07-16 15:05:45.148306 (Thread-1): 11:05:45 | 4 of 4 START test not_null_payments_total_price...................... [RUN]
2020-07-16 15:05:45.148658 (Thread-1): Acquiring new bigquery connection "test.springml_demo_dbt_project.not_null_payments_total_price".
2020-07-16 15:05:45.148786 (Thread-1): Re-using an available connection from the pool (formerly test.springml_demo_dbt_project.not_null_payments_number_of_payments).
2020-07-16 15:05:45.148915 (Thread-1): Compiling test.springml_demo_dbt_project.not_null_payments_total_price
2020-07-16 15:05:45.160076 (Thread-1): Writing injected SQL for node "test.springml_demo_dbt_project.not_null_payments_total_price"
2020-07-16 15:05:45.160660 (Thread-1): finished collecting timing info
2020-07-16 15:05:45.160983 (Thread-1): On test.springml_demo_dbt_project.not_null_payments_total_price: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "test.springml_demo_dbt_project.not_null_payments_total_price"} */




select count(*) as validation_errors
from `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
where total_price is null


2020-07-16 15:05:47.194206 (Thread-1): finished collecting timing info
2020-07-16 15:05:47.195232 (Thread-1): 11:05:47 | 4 of 4 PASS not_null_payments_total_price............................ [PASS in 2.05s]
2020-07-16 15:05:47.195422 (Thread-1): Finished running node test.springml_demo_dbt_project.not_null_payments_total_price
2020-07-16 15:05:47.204763 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 15:05:47.205002 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:05:47.205559 (MainThread): 11:05:47 | 
2020-07-16 15:05:47.205712 (MainThread): 11:05:47 | Finished running 4 tests in 9.47s.
2020-07-16 15:05:47.205906 (MainThread): Connection 'master' was properly closed.
2020-07-16 15:05:47.206048 (MainThread): Connection 'test.springml_demo_dbt_project.not_null_payments_total_price' was left open.
2020-07-16 15:05:47.221228 (MainThread): 
2020-07-16 15:05:47.221414 (MainThread): Completed successfully
2020-07-16 15:05:47.221578 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-07-16 15:05:47.221867 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147bb0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114796f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146797d0>]}
2020-07-16 15:05:47.222138 (MainThread): Flushing usage events
2020-07-16 15:06:02.806355 (MainThread): Running with dbt=0.17.0
2020-07-16 15:06:04.085860 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['part_1_model'], partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-16 15:06:04.093778 (MainThread): Tracking: tracking
2020-07-16 15:06:04.122153 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a2bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1179bbc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1179bba10>]}
2020-07-16 15:06:04.147990 (MainThread): Partial parsing not enabled
2020-07-16 15:06:04.151713 (MainThread): Parsing macros/core.sql
2020-07-16 15:06:04.158983 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-16 15:06:04.169485 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-16 15:06:04.172876 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-16 15:06:04.195340 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-16 15:06:04.231529 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-16 15:06:04.258467 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-16 15:06:04.261987 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-16 15:06:04.271407 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-16 15:06:04.289863 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-16 15:06:04.301262 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-16 15:06:04.310886 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-16 15:06:04.318061 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-16 15:06:04.320213 (MainThread): Parsing macros/etc/query.sql
2020-07-16 15:06:04.322480 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-16 15:06:04.325597 (MainThread): Parsing macros/etc/datetime.sql
2020-07-16 15:06:04.337713 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-16 15:06:04.340746 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-16 15:06:04.343733 (MainThread): Parsing macros/adapters/common.sql
2020-07-16 15:06:04.403858 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-16 15:06:04.406637 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-16 15:06:04.408931 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-16 15:06:04.417430 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-16 15:06:04.421648 (MainThread): Parsing macros/etc.sql
2020-07-16 15:06:04.423554 (MainThread): Parsing macros/catalog.sql
2020-07-16 15:06:04.431848 (MainThread): Parsing macros/adapters.sql
2020-07-16 15:06:04.451452 (MainThread): Parsing macros/materializations/seed.sql
2020-07-16 15:06:04.454616 (MainThread): Parsing macros/materializations/view.sql
2020-07-16 15:06:04.457621 (MainThread): Parsing macros/materializations/table.sql
2020-07-16 15:06:04.471193 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-16 15:06:04.487683 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-16 15:06:04.512058 (MainThread): Partial parsing not enabled
2020-07-16 15:06:04.556353 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-16 15:06:04.556529 (MainThread): Opening a new connection, currently in state init
2020-07-16 15:06:04.589694 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-16 15:06:04.589848 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:06:04.613751 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-16 15:06:04.613933 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:06:04.922423 (MainThread): WARNING: Found documentation for resource "creditcards" which was not found or is disabled
2020-07-16 15:06:04.922747 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.unique_creditcards_country' (models/part_1_model/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-16 15:06:04.922911 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_country' (models/part_1_model/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-16 15:06:04.923087 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Amex_payments' (models/part_1_model/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-16 15:06:04.923267 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Mastercard_payments' (models/part_1_model/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-16 15:06:04.923447 (MainThread): WARNING: Test 'test.springml_demo_dbt_project.not_null_creditcards_Visa_payments' (models/part_1_model/schema.yml) depends on a node named 'creditcards' which was not found
2020-07-16 15:06:04.962997 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.springml_demo_dbt_project.part_2_model

2020-07-16 15:06:05.028431 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 2 seed files, 1 source
2020-07-16 15:06:05.029556 (MainThread): 
2020-07-16 15:06:05.030008 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 15:06:05.030111 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:06:05.033910 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-16 15:06:05.034072 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-16 15:06:05.037402 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-16 15:06:07.707598 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-16 15:06:07.707929 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-16 15:06:07.708124 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 15:06:07.834816 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 15:06:07.835030 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:06:07.835442 (MainThread): 11:06:07 | Concurrency: 1 threads (target='dev')
2020-07-16 15:06:07.835701 (MainThread): 11:06:07 | 
2020-07-16 15:06:07.840115 (Thread-1): Began running node model.springml_demo_dbt_project.creditcard
2020-07-16 15:06:07.841521 (Thread-1): 11:06:07 | 1 of 2 START view model springml_demo_dataset.creditcard............. [RUN]
2020-07-16 15:06:07.841982 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-16 15:06:07.842098 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-16 15:06:07.842226 (Thread-1): Compiling model.springml_demo_dbt_project.creditcard
2020-07-16 15:06:07.861144 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-16 15:06:07.861675 (Thread-1): finished collecting timing info
2020-07-16 15:06:07.900147 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-16 15:06:07.900879 (Thread-1): On model.springml_demo_dbt_project.creditcard: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
  OPTIONS()
  as 

select country,

sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,

sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,

sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,

from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
group by country 
having not (Amex_payments = 0 
and	Mastercard_payments = 0 
and	 Visa_payments = 0)
order by (Amex_payments + Mastercard_payments + Visa_payments) desc;


2020-07-16 15:06:08.696943 (Thread-1): finished collecting timing info
2020-07-16 15:06:08.697876 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '634970b5-fad5-433b-ad1e-a913b3cca688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117bf9e50>]}
2020-07-16 15:06:08.699275 (Thread-1): 11:06:08 | 1 of 2 OK created view model springml_demo_dataset.creditcard........ [CREATE VIEW in 0.86s]
2020-07-16 15:06:08.699493 (Thread-1): Finished running node model.springml_demo_dbt_project.creditcard
2020-07-16 15:06:08.699758 (Thread-1): Began running node model.springml_demo_dbt_project.payments
2020-07-16 15:06:08.700951 (Thread-1): 11:06:08 | 2 of 2 START view model springml_demo_dataset.payments............... [RUN]
2020-07-16 15:06:08.701342 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-16 15:06:08.701439 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.creditcard).
2020-07-16 15:06:08.701532 (Thread-1): Compiling model.springml_demo_dbt_project.payments
2020-07-16 15:06:08.713091 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.payments"
2020-07-16 15:06:08.713607 (Thread-1): finished collecting timing info
2020-07-16 15:06:08.718409 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.payments"
2020-07-16 15:06:08.718965 (Thread-1): On model.springml_demo_dbt_project.payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
  OPTIONS()
  as select payment_type, 
    count(*) as number_of_payments, 
    sum(price) as total_price 
from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where country like "United States"
group by payment_type;


2020-07-16 15:06:09.319918 (Thread-1): finished collecting timing info
2020-07-16 15:06:09.320808 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '634970b5-fad5-433b-ad1e-a913b3cca688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117a10a50>]}
2020-07-16 15:06:09.322260 (Thread-1): 11:06:09 | 2 of 2 OK created view model springml_demo_dataset.payments.......... [CREATE VIEW in 0.62s]
2020-07-16 15:06:09.322419 (Thread-1): Finished running node model.springml_demo_dbt_project.payments
2020-07-16 15:06:09.389886 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 15:06:09.390133 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:06:09.390607 (MainThread): 11:06:09 | 
2020-07-16 15:06:09.390824 (MainThread): 11:06:09 | Finished running 2 view models in 4.36s.
2020-07-16 15:06:09.391100 (MainThread): Connection 'master' was properly closed.
2020-07-16 15:06:09.391343 (MainThread): Connection 'model.springml_demo_dbt_project.payments' was left open.
2020-07-16 15:06:09.400789 (MainThread): 
2020-07-16 15:06:09.400985 (MainThread): Completed successfully
2020-07-16 15:06:09.401225 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-07-16 15:06:09.401701 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117b8aa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117c05410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117a32fd0>]}
2020-07-16 15:06:09.402085 (MainThread): Flushing usage events
2020-07-16 15:17:46.946217 (MainThread): Running with dbt=0.17.0
2020-07-16 15:17:48.469062 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['part_2_model'], partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-16 15:17:48.472168 (MainThread): Tracking: tracking
2020-07-16 15:17:48.493727 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11878a250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11705c790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11878fc50>]}
2020-07-16 15:17:48.522590 (MainThread): Partial parsing not enabled
2020-07-16 15:17:48.525789 (MainThread): Parsing macros/core.sql
2020-07-16 15:17:48.533977 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-16 15:17:48.544079 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-16 15:17:48.546966 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-16 15:17:48.569351 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-16 15:17:48.608373 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-16 15:17:48.635460 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-16 15:17:48.639576 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-16 15:17:48.649918 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-16 15:17:48.667126 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-16 15:17:48.677587 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-16 15:17:48.686726 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-16 15:17:48.694328 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-16 15:17:48.696397 (MainThread): Parsing macros/etc/query.sql
2020-07-16 15:17:48.698936 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-16 15:17:48.702174 (MainThread): Parsing macros/etc/datetime.sql
2020-07-16 15:17:48.716568 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-16 15:17:48.719965 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-16 15:17:48.722726 (MainThread): Parsing macros/adapters/common.sql
2020-07-16 15:17:48.787285 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-16 15:17:48.789552 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-16 15:17:48.791688 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-16 15:17:48.794593 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-16 15:17:48.800187 (MainThread): Parsing macros/etc.sql
2020-07-16 15:17:48.802085 (MainThread): Parsing macros/catalog.sql
2020-07-16 15:17:48.811538 (MainThread): Parsing macros/adapters.sql
2020-07-16 15:17:48.831955 (MainThread): Parsing macros/materializations/seed.sql
2020-07-16 15:17:48.835001 (MainThread): Parsing macros/materializations/view.sql
2020-07-16 15:17:48.838654 (MainThread): Parsing macros/materializations/table.sql
2020-07-16 15:17:48.852324 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-16 15:17:48.869083 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-16 15:17:48.896678 (MainThread): Partial parsing not enabled
2020-07-16 15:17:48.940404 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 15:17:48.940594 (MainThread): Opening a new connection, currently in state init
2020-07-16 15:17:48.976715 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-16 15:17:48.976889 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:17:48.992160 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-16 15:17:48.992393 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:17:49.016229 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-16 15:17:49.016402 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:17:49.476265 (MainThread): Found 3 models, 9 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 2 seed files, 2 sources
2020-07-16 15:17:49.477289 (MainThread): 
2020-07-16 15:17:49.477747 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 15:17:49.477876 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:17:49.480433 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-16 15:17:49.480590 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-16 15:17:49.484168 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-16 15:17:52.244926 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-16 15:17:52.245240 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-16 15:17:52.245509 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 15:17:52.571046 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 15:17:52.571228 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:17:52.571569 (MainThread): 11:17:52 | Concurrency: 1 threads (target='dev')
2020-07-16 15:17:52.571734 (MainThread): 11:17:52 | 
2020-07-16 15:17:52.576917 (Thread-1): Began running node model.springml_demo_dbt_project.gender_count
2020-07-16 15:17:52.578290 (Thread-1): 11:17:52 | 1 of 1 START view model springml_demo_dataset.gender_count........... [RUN]
2020-07-16 15:17:52.578705 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 15:17:52.578829 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-16 15:17:52.578952 (Thread-1): Compiling model.springml_demo_dbt_project.gender_count
2020-07-16 15:17:52.602979 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 15:17:52.603578 (Thread-1): finished collecting timing info
2020-07-16 15:17:52.639329 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 15:17:52.639998 (Thread-1): On model.springml_demo_dbt_project.gender_count: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.gender_count"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count`
  OPTIONS()
  as delete from `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data` where Ingestion_date=CURRENT_DATE();
INSERT into `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`
SELECT 
CURRENT_DATE() as Ingestion_date, 
countif(ad.Gender is not null and ad.Gender="F" ) as Female_count,
countif(ad.Gender is not null and ad.Gender="M" ) as Male_count,
FROM `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data` as ad;;


2020-07-16 15:17:52.908243 (Thread-1): finished collecting timing info
2020-07-16 15:17:52.909052 (Thread-1): Database Error in model gender_count (models/part_2_model/gender_count.sql)
  Syntax error: Expected "(" or keyword SELECT or keyword WITH but got keyword DELETE at [6:6]
  compiled SQL at target/run/springml_demo_dbt_project/models/part_2_model/gender_count.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 84, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 225, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 352, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 127, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Expected "(" or keyword SELECT or keyword WITH but got keyword DELETE at [6:6]

(job ID: 51c0ba40-0798-4f4d-b560-1eb2473d612f)

                                                                -----Query Job SQL Follows-----                                                                

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.gender_count"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count`
   5:  OPTIONS()
   6:  as delete from `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data` where Ingestion_date=CURRENT_DATE();
   7:INSERT into `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`
   8:SELECT 
   9:CURRENT_DATE() as Ingestion_date, 
  10:countif(ad.Gender is not null and ad.Gender="F" ) as Female_count,
  11:countif(ad.Gender is not null and ad.Gender="M" ) as Male_count,
  12:FROM `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data` as ad;;
  13:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 234, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 227, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/Cellar/python/3.7.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 88, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 76, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model gender_count (models/part_2_model/gender_count.sql)
  Syntax error: Expected "(" or keyword SELECT or keyword WITH but got keyword DELETE at [6:6]
  compiled SQL at target/run/springml_demo_dbt_project/models/part_2_model/gender_count.sql
2020-07-16 15:17:52.930220 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd453c352-5b0f-4803-a042-804661fa1aef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118cfce50>]}
2020-07-16 15:17:52.932278 (Thread-1): 11:17:52 | 1 of 1 ERROR creating view model springml_demo_dataset.gender_count.. [ERROR in 0.35s]
2020-07-16 15:17:52.932477 (Thread-1): Finished running node model.springml_demo_dbt_project.gender_count
2020-07-16 15:17:52.993128 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 15:17:52.993368 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:17:52.993817 (MainThread): 11:17:52 | 
2020-07-16 15:17:52.994031 (MainThread): 11:17:52 | Finished running 1 view model in 3.52s.
2020-07-16 15:17:52.994309 (MainThread): Connection 'master' was properly closed.
2020-07-16 15:17:52.994511 (MainThread): Connection 'model.springml_demo_dbt_project.gender_count' was left open.
2020-07-16 15:17:53.001746 (MainThread): 
2020-07-16 15:17:53.002033 (MainThread): Completed with 1 error and 0 warnings:
2020-07-16 15:17:53.002266 (MainThread): 
2020-07-16 15:17:53.002523 (MainThread): Database Error in model gender_count (models/part_2_model/gender_count.sql)
2020-07-16 15:17:53.002757 (MainThread):   Syntax error: Expected "(" or keyword SELECT or keyword WITH but got keyword DELETE at [6:6]
2020-07-16 15:17:53.002944 (MainThread):   compiled SQL at target/run/springml_demo_dbt_project/models/part_2_model/gender_count.sql
2020-07-16 15:17:53.003152 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2020-07-16 15:17:53.003438 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118cf6790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118cf6b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118cf6c90>]}
2020-07-16 15:17:53.003734 (MainThread): Flushing usage events
2020-07-16 15:18:11.661922 (MainThread): Running with dbt=0.17.0
2020-07-16 15:18:12.868297 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['part_2_model'], partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-16 15:18:12.871726 (MainThread): Tracking: tracking
2020-07-16 15:18:12.931992 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135f5b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b74c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b74a90>]}
2020-07-16 15:18:12.960549 (MainThread): Partial parsing not enabled
2020-07-16 15:18:12.966076 (MainThread): Parsing macros/core.sql
2020-07-16 15:18:12.975908 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-16 15:18:12.988492 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-16 15:18:12.991104 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-16 15:18:13.013142 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-16 15:18:13.063024 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-16 15:18:13.097177 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-16 15:18:13.099819 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-16 15:18:13.108227 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-16 15:18:13.125799 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-16 15:18:13.135617 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-16 15:18:13.144846 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-16 15:18:13.152522 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-16 15:18:13.154364 (MainThread): Parsing macros/etc/query.sql
2020-07-16 15:18:13.156712 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-16 15:18:13.159819 (MainThread): Parsing macros/etc/datetime.sql
2020-07-16 15:18:13.171972 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-16 15:18:13.175006 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-16 15:18:13.177506 (MainThread): Parsing macros/adapters/common.sql
2020-07-16 15:18:13.238357 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-16 15:18:13.240747 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-16 15:18:13.242453 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-16 15:18:13.244592 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-16 15:18:13.249540 (MainThread): Parsing macros/etc.sql
2020-07-16 15:18:13.250950 (MainThread): Parsing macros/catalog.sql
2020-07-16 15:18:13.259011 (MainThread): Parsing macros/adapters.sql
2020-07-16 15:18:13.281275 (MainThread): Parsing macros/materializations/seed.sql
2020-07-16 15:18:13.284112 (MainThread): Parsing macros/materializations/view.sql
2020-07-16 15:18:13.290939 (MainThread): Parsing macros/materializations/table.sql
2020-07-16 15:18:13.306128 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-16 15:18:13.328559 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-16 15:18:13.375973 (MainThread): Partial parsing not enabled
2020-07-16 15:18:13.442623 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 15:18:13.442825 (MainThread): Opening a new connection, currently in state init
2020-07-16 15:18:13.496775 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-16 15:18:13.496946 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:18:13.514248 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-16 15:18:13.514468 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:18:13.541363 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-16 15:18:13.541501 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:18:14.173916 (MainThread): Found 3 models, 9 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 2 seed files, 2 sources
2020-07-16 15:18:14.174999 (MainThread): 
2020-07-16 15:18:14.175362 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 15:18:14.175475 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:18:14.181265 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-16 15:18:14.181501 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-16 15:18:14.185915 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-16 15:18:16.439180 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-16 15:18:16.439483 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-16 15:18:16.439668 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 15:18:16.617628 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 15:18:16.617813 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:18:16.618167 (MainThread): 11:18:16 | Concurrency: 1 threads (target='dev')
2020-07-16 15:18:16.618420 (MainThread): 11:18:16 | 
2020-07-16 15:18:16.623002 (Thread-1): Began running node model.springml_demo_dbt_project.gender_count
2020-07-16 15:18:16.624386 (Thread-1): 11:18:16 | 1 of 1 START view model springml_demo_dataset.gender_count........... [RUN]
2020-07-16 15:18:16.624906 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 15:18:16.625050 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-16 15:18:16.625189 (Thread-1): Compiling model.springml_demo_dbt_project.gender_count
2020-07-16 15:18:16.648612 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 15:18:16.649111 (Thread-1): finished collecting timing info
2020-07-16 15:18:16.685410 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 15:18:16.685955 (Thread-1): On model.springml_demo_dbt_project.gender_count: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.gender_count"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count`
  OPTIONS()
  as INSERT into `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`
SELECT 
CURRENT_DATE() as Ingestion_date, 
countif(ad.Gender is not null and ad.Gender="F" ) as Female_count,
countif(ad.Gender is not null and ad.Gender="M" ) as Male_count,
FROM `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data` as ad;;


2020-07-16 15:18:17.143236 (Thread-1): finished collecting timing info
2020-07-16 15:18:17.144071 (Thread-1): Database Error in model gender_count (models/part_2_model/gender_count.sql)
  Syntax error: Expected "(" or keyword SELECT or keyword WITH but got keyword INSERT at [6:6]
  compiled SQL at target/run/springml_demo_dbt_project/models/part_2_model/gender_count.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 84, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 225, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 352, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 127, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Expected "(" or keyword SELECT or keyword WITH but got keyword INSERT at [6:6]

(job ID: 723fa3bb-8586-49e2-afd1-acbd2723553e)

                                                                -----Query Job SQL Follows-----                                                                

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.gender_count"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count`
   5:  OPTIONS()
   6:  as INSERT into `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`
   7:SELECT 
   8:CURRENT_DATE() as Ingestion_date, 
   9:countif(ad.Gender is not null and ad.Gender="F" ) as Female_count,
  10:countif(ad.Gender is not null and ad.Gender="M" ) as Male_count,
  11:FROM `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data` as ad;;
  12:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 234, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 227, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/Cellar/python/3.7.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 88, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 76, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model gender_count (models/part_2_model/gender_count.sql)
  Syntax error: Expected "(" or keyword SELECT or keyword WITH but got keyword INSERT at [6:6]
  compiled SQL at target/run/springml_demo_dbt_project/models/part_2_model/gender_count.sql
2020-07-16 15:18:17.197697 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7572bcf4-115e-42e7-a06c-b2cf8ef4db25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115f8ac50>]}
2020-07-16 15:18:17.199822 (Thread-1): 11:18:17 | 1 of 1 ERROR creating view model springml_demo_dataset.gender_count.. [ERROR in 0.57s]
2020-07-16 15:18:17.200016 (Thread-1): Finished running node model.springml_demo_dbt_project.gender_count
2020-07-16 15:18:17.246657 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 15:18:17.246861 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:18:17.247239 (MainThread): 11:18:17 | 
2020-07-16 15:18:17.247409 (MainThread): 11:18:17 | Finished running 1 view model in 3.07s.
2020-07-16 15:18:17.247568 (MainThread): Connection 'master' was properly closed.
2020-07-16 15:18:17.247688 (MainThread): Connection 'model.springml_demo_dbt_project.gender_count' was left open.
2020-07-16 15:18:17.252322 (MainThread): 
2020-07-16 15:18:17.252483 (MainThread): Completed with 1 error and 0 warnings:
2020-07-16 15:18:17.252626 (MainThread): 
2020-07-16 15:18:17.252788 (MainThread): Database Error in model gender_count (models/part_2_model/gender_count.sql)
2020-07-16 15:18:17.253061 (MainThread):   Syntax error: Expected "(" or keyword SELECT or keyword WITH but got keyword INSERT at [6:6]
2020-07-16 15:18:17.253200 (MainThread):   compiled SQL at target/run/springml_demo_dbt_project/models/part_2_model/gender_count.sql
2020-07-16 15:18:17.253434 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2020-07-16 15:18:17.253799 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1160d5b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115d16790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1160e2810>]}
2020-07-16 15:18:17.254021 (MainThread): Flushing usage events
2020-07-16 15:18:25.948307 (MainThread): Running with dbt=0.17.0
2020-07-16 15:18:26.365450 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['part_2_model'], partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-16 15:18:26.366642 (MainThread): Tracking: tracking
2020-07-16 15:18:26.379636 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d49250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d20cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d4eb90>]}
2020-07-16 15:18:26.406054 (MainThread): Partial parsing not enabled
2020-07-16 15:18:26.408081 (MainThread): Parsing macros/core.sql
2020-07-16 15:18:26.413707 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-16 15:18:26.424442 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-16 15:18:26.426645 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-16 15:18:26.446759 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-16 15:18:26.483588 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-16 15:18:26.509880 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-16 15:18:26.512346 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-16 15:18:26.520048 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-16 15:18:26.536543 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-16 15:18:26.544837 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-16 15:18:26.552505 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-16 15:18:26.558368 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-16 15:18:26.559494 (MainThread): Parsing macros/etc/query.sql
2020-07-16 15:18:26.560754 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-16 15:18:26.562729 (MainThread): Parsing macros/etc/datetime.sql
2020-07-16 15:18:26.573261 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-16 15:18:26.575629 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-16 15:18:26.577582 (MainThread): Parsing macros/adapters/common.sql
2020-07-16 15:18:26.634689 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-16 15:18:26.636144 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-16 15:18:26.637242 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-16 15:18:26.638527 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-16 15:18:26.641233 (MainThread): Parsing macros/etc.sql
2020-07-16 15:18:26.642022 (MainThread): Parsing macros/catalog.sql
2020-07-16 15:18:26.648897 (MainThread): Parsing macros/adapters.sql
2020-07-16 15:18:26.667723 (MainThread): Parsing macros/materializations/seed.sql
2020-07-16 15:18:26.670619 (MainThread): Parsing macros/materializations/view.sql
2020-07-16 15:18:26.673129 (MainThread): Parsing macros/materializations/table.sql
2020-07-16 15:18:26.685834 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-16 15:18:26.701469 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-16 15:18:26.728889 (MainThread): Partial parsing not enabled
2020-07-16 15:18:26.775808 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 15:18:26.775977 (MainThread): Opening a new connection, currently in state init
2020-07-16 15:18:26.809508 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-16 15:18:26.811475 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:18:26.826319 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-16 15:18:26.826472 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:18:26.848241 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-16 15:18:26.848391 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:18:27.290771 (MainThread): Found 3 models, 9 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 2 seed files, 2 sources
2020-07-16 15:18:27.291794 (MainThread): 
2020-07-16 15:18:27.292238 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 15:18:27.292344 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:18:27.294340 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-16 15:18:27.294466 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-16 15:18:27.295494 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-16 15:18:28.191754 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-16 15:18:28.192044 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-16 15:18:28.192253 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 15:18:28.329222 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 15:18:28.329425 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:18:28.329822 (MainThread): 11:18:28 | Concurrency: 1 threads (target='dev')
2020-07-16 15:18:28.330023 (MainThread): 11:18:28 | 
2020-07-16 15:18:28.332930 (Thread-1): Began running node model.springml_demo_dbt_project.gender_count
2020-07-16 15:18:28.334201 (Thread-1): 11:18:28 | 1 of 1 START view model springml_demo_dataset.gender_count........... [RUN]
2020-07-16 15:18:28.334570 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 15:18:28.334676 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-16 15:18:28.334797 (Thread-1): Compiling model.springml_demo_dbt_project.gender_count
2020-07-16 15:18:28.355457 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 15:18:28.356037 (Thread-1): finished collecting timing info
2020-07-16 15:18:28.391638 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 15:18:28.392237 (Thread-1): On model.springml_demo_dbt_project.gender_count: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.gender_count"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count`
  OPTIONS()
  as SELECT 
CURRENT_DATE() as Ingestion_date, 
countif(ad.Gender is not null and ad.Gender="F" ) as Female_count,
countif(ad.Gender is not null and ad.Gender="M" ) as Male_count,
FROM `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data` as ad;;


2020-07-16 15:18:28.612180 (Thread-1): finished collecting timing info
2020-07-16 15:18:28.612994 (Thread-1): Database Error in model gender_count (models/part_2_model/gender_count.sql)
  Syntax error: Expected end of input but got ";" at [10:78]
  compiled SQL at target/run/springml_demo_dbt_project/models/part_2_model/gender_count.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 84, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 225, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 352, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 127, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Expected end of input but got ";" at [10:78]

(job ID: 9cd1da28-fd0d-4049-9a54-ad3a5aa7ae35)

                                                                -----Query Job SQL Follows-----                                                                

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.gender_count"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count`
   5:  OPTIONS()
   6:  as SELECT 
   7:CURRENT_DATE() as Ingestion_date, 
   8:countif(ad.Gender is not null and ad.Gender="F" ) as Female_count,
   9:countif(ad.Gender is not null and ad.Gender="M" ) as Male_count,
  10:FROM `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data` as ad;;
  11:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 234, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 227, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/Cellar/python/3.7.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 88, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 76, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model gender_count (models/part_2_model/gender_count.sql)
  Syntax error: Expected end of input but got ";" at [10:78]
  compiled SQL at target/run/springml_demo_dbt_project/models/part_2_model/gender_count.sql
2020-07-16 15:18:28.617267 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f8bc021-b9ba-4192-8d5c-351e7defda59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122af250>]}
2020-07-16 15:18:28.618946 (Thread-1): 11:18:28 | 1 of 1 ERROR creating view model springml_demo_dataset.gender_count.. [ERROR in 0.28s]
2020-07-16 15:18:28.619164 (Thread-1): Finished running node model.springml_demo_dbt_project.gender_count
2020-07-16 15:18:28.645575 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 15:18:28.645815 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:18:28.646258 (MainThread): 11:18:28 | 
2020-07-16 15:18:28.646471 (MainThread): 11:18:28 | Finished running 1 view model in 1.35s.
2020-07-16 15:18:28.646672 (MainThread): Connection 'master' was properly closed.
2020-07-16 15:18:28.646847 (MainThread): Connection 'model.springml_demo_dbt_project.gender_count' was left open.
2020-07-16 15:18:28.651829 (MainThread): 
2020-07-16 15:18:28.652025 (MainThread): Completed with 1 error and 0 warnings:
2020-07-16 15:18:28.652206 (MainThread): 
2020-07-16 15:18:28.652390 (MainThread): Database Error in model gender_count (models/part_2_model/gender_count.sql)
2020-07-16 15:18:28.652553 (MainThread):   Syntax error: Expected end of input but got ";" at [10:78]
2020-07-16 15:18:28.652700 (MainThread):   compiled SQL at target/run/springml_demo_dbt_project/models/part_2_model/gender_count.sql
2020-07-16 15:18:28.652858 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2020-07-16 15:18:28.653342 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ef0d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122af250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122c05d0>]}
2020-07-16 15:18:28.653722 (MainThread): Flushing usage events
2020-07-16 15:18:43.356364 (MainThread): Running with dbt=0.17.0
2020-07-16 15:18:43.785483 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['part_2_model'], partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-16 15:18:43.786648 (MainThread): Tracking: tracking
2020-07-16 15:18:43.799913 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ce6690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cf7d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cf7b50>]}
2020-07-16 15:18:43.838542 (MainThread): Partial parsing not enabled
2020-07-16 15:18:43.840854 (MainThread): Parsing macros/core.sql
2020-07-16 15:18:43.847201 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-16 15:18:43.858507 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-16 15:18:43.861301 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-16 15:18:43.897141 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-16 15:18:43.955200 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-16 15:18:43.996524 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-16 15:18:43.999380 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-16 15:18:44.007365 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-16 15:18:44.024279 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-16 15:18:44.032835 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-16 15:18:44.040772 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-16 15:18:44.047413 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-16 15:18:44.048728 (MainThread): Parsing macros/etc/query.sql
2020-07-16 15:18:44.050100 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-16 15:18:44.052229 (MainThread): Parsing macros/etc/datetime.sql
2020-07-16 15:18:44.063205 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-16 15:18:44.065632 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-16 15:18:44.067646 (MainThread): Parsing macros/adapters/common.sql
2020-07-16 15:18:44.127526 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-16 15:18:44.128952 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-16 15:18:44.130052 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-16 15:18:44.131345 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-16 15:18:44.134331 (MainThread): Parsing macros/etc.sql
2020-07-16 15:18:44.135148 (MainThread): Parsing macros/catalog.sql
2020-07-16 15:18:44.142206 (MainThread): Parsing macros/adapters.sql
2020-07-16 15:18:44.167157 (MainThread): Parsing macros/materializations/seed.sql
2020-07-16 15:18:44.169601 (MainThread): Parsing macros/materializations/view.sql
2020-07-16 15:18:44.171997 (MainThread): Parsing macros/materializations/table.sql
2020-07-16 15:18:44.185003 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-16 15:18:44.200700 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-16 15:18:44.224781 (MainThread): Partial parsing not enabled
2020-07-16 15:18:44.266939 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 15:18:44.267092 (MainThread): Opening a new connection, currently in state init
2020-07-16 15:18:44.305149 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-16 15:18:44.305415 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:18:44.322164 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-16 15:18:44.322319 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:18:44.344152 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-16 15:18:44.344294 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:18:44.782694 (MainThread): Found 3 models, 9 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 2 seed files, 2 sources
2020-07-16 15:18:44.783809 (MainThread): 
2020-07-16 15:18:44.784263 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 15:18:44.784366 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:18:44.786388 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-16 15:18:44.786517 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-16 15:18:44.787531 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-16 15:18:45.690452 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-16 15:18:45.690719 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-16 15:18:45.690891 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 15:18:45.860362 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 15:18:45.860556 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:18:45.860943 (MainThread): 11:18:45 | Concurrency: 1 threads (target='dev')
2020-07-16 15:18:45.861177 (MainThread): 11:18:45 | 
2020-07-16 15:18:45.864171 (Thread-1): Began running node model.springml_demo_dbt_project.gender_count
2020-07-16 15:18:45.865489 (Thread-1): 11:18:45 | 1 of 1 START view model springml_demo_dataset.gender_count........... [RUN]
2020-07-16 15:18:45.865865 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 15:18:45.865970 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-16 15:18:45.866089 (Thread-1): Compiling model.springml_demo_dbt_project.gender_count
2020-07-16 15:18:45.886412 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 15:18:45.888684 (Thread-1): finished collecting timing info
2020-07-16 15:18:45.925947 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 15:18:45.926473 (Thread-1): On model.springml_demo_dbt_project.gender_count: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.gender_count"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count`
  OPTIONS()
  as SELECT 
CURRENT_DATE() as Ingestion_date, 
countif(ad.Gender is not null and ad.Gender="F" ) as Female_count,
countif(ad.Gender is not null and ad.Gender="M" ) as Male_count,
FROM `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data` as ad;


2020-07-16 15:18:46.567007 (Thread-1): finished collecting timing info
2020-07-16 15:18:46.567835 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c9a378c-4fe8-4ad4-adaa-3bc25867caab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f54a50>]}
2020-07-16 15:18:46.569108 (Thread-1): 11:18:46 | 1 of 1 OK created view model springml_demo_dataset.gender_count...... [CREATE VIEW in 0.70s]
2020-07-16 15:18:46.569272 (Thread-1): Finished running node model.springml_demo_dbt_project.gender_count
2020-07-16 15:18:46.587499 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 15:18:46.587745 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:18:46.588205 (MainThread): 11:18:46 | 
2020-07-16 15:18:46.588417 (MainThread): 11:18:46 | Finished running 1 view model in 1.80s.
2020-07-16 15:18:46.588691 (MainThread): Connection 'master' was properly closed.
2020-07-16 15:18:46.588893 (MainThread): Connection 'model.springml_demo_dbt_project.gender_count' was left open.
2020-07-16 15:18:46.594485 (MainThread): 
2020-07-16 15:18:46.594686 (MainThread): Completed successfully
2020-07-16 15:18:46.594873 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-07-16 15:18:46.595179 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a7fd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a5bbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e99450>]}
2020-07-16 15:18:46.595445 (MainThread): Flushing usage events
2020-07-16 15:30:23.710121 (MainThread): Running with dbt=0.17.0
2020-07-16 15:30:25.166811 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['redaction'], partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-16 15:30:25.168533 (MainThread): Tracking: tracking
2020-07-16 15:30:25.207843 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116f47910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116a12890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116f94950>]}
2020-07-16 15:30:25.240207 (MainThread): Partial parsing not enabled
2020-07-16 15:30:25.244076 (MainThread): Parsing macros/core.sql
2020-07-16 15:30:25.251597 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-16 15:30:25.264219 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-16 15:30:25.267153 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-16 15:30:25.289764 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-16 15:30:25.326714 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-16 15:30:25.353458 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-16 15:30:25.357429 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-16 15:30:25.366398 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-16 15:30:25.383742 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-16 15:30:25.392595 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-16 15:30:25.401690 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-16 15:30:25.407954 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-16 15:30:25.410276 (MainThread): Parsing macros/etc/query.sql
2020-07-16 15:30:25.412714 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-16 15:30:25.415677 (MainThread): Parsing macros/etc/datetime.sql
2020-07-16 15:30:25.427700 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-16 15:30:25.430692 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-16 15:30:25.433359 (MainThread): Parsing macros/adapters/common.sql
2020-07-16 15:30:25.493389 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-16 15:30:25.495635 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-16 15:30:25.497202 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-16 15:30:25.499684 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-16 15:30:25.502969 (MainThread): Parsing macros/etc.sql
2020-07-16 15:30:25.504171 (MainThread): Parsing macros/catalog.sql
2020-07-16 15:30:25.511382 (MainThread): Parsing macros/adapters.sql
2020-07-16 15:30:25.530860 (MainThread): Parsing macros/materializations/seed.sql
2020-07-16 15:30:25.533745 (MainThread): Parsing macros/materializations/view.sql
2020-07-16 15:30:25.536508 (MainThread): Parsing macros/materializations/table.sql
2020-07-16 15:30:25.549614 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-16 15:30:25.565698 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-16 15:30:25.590886 (MainThread): Partial parsing not enabled
2020-07-16 15:30:25.631497 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 15:30:25.631681 (MainThread): Opening a new connection, currently in state init
2020-07-16 15:30:25.667197 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-16 15:30:25.667368 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:30:25.682357 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-16 15:30:25.682532 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:30:25.704743 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-16 15:30:25.704901 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:30:26.157336 (MainThread): Found 3 models, 9 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 2 seed files, 2 sources
2020-07-16 15:30:26.158878 (MainThread): 
2020-07-16 15:30:26.159327 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 15:30:26.159459 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:30:26.162279 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-16 15:30:26.162569 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-16 15:30:26.165672 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-16 15:30:28.631264 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-16 15:30:28.631559 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-16 15:30:28.631753 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 15:30:28.814009 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 15:30:28.814203 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:30:28.814599 (MainThread): 11:30:28 | Concurrency: 1 threads (target='dev')
2020-07-16 15:30:28.814822 (MainThread): 11:30:28 | 
2020-07-16 15:30:28.819408 (Thread-1): Began running node model.springml_demo_dbt_project.gender_count
2020-07-16 15:30:28.820772 (Thread-1): 11:30:28 | 1 of 1 START table model springml_demo_dataset.gender_count.......... [RUN]
2020-07-16 15:30:28.821220 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 15:30:28.821336 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-16 15:30:28.821461 (Thread-1): Compiling model.springml_demo_dbt_project.gender_count
2020-07-16 15:30:28.844089 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 15:30:28.844749 (Thread-1): finished collecting timing info
2020-07-16 15:30:28.874352 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 15:30:29.033257 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 15:30:29.208736 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 15:30:29.209535 (Thread-1): On model.springml_demo_dbt_project.gender_count: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.gender_count"} */


  create or replace table `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count`
  
  
  OPTIONS()
  as (
    SELECT 
CURRENT_DATE() as Ingestion_date, 
countif(ad.Gender is not null and ad.Gender="F" ) as Female_count,
countif(ad.Gender is not null and ad.Gender="M" ) as Male_count,
FROM `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data` as ad
  );
    
2020-07-16 15:30:31.577796 (Thread-1): finished collecting timing info
2020-07-16 15:30:31.578657 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a3e7c90-d503-4af8-b5dc-6cc47c94a389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1174cb9d0>]}
2020-07-16 15:30:31.579964 (Thread-1): 11:30:31 | 1 of 1 OK created table model springml_demo_dataset.gender_count..... [CREATE TABLE (1) in 2.76s]
2020-07-16 15:30:31.580139 (Thread-1): Finished running node model.springml_demo_dbt_project.gender_count
2020-07-16 15:30:31.620860 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 15:30:31.621078 (MainThread): Opening a new connection, currently in state closed
2020-07-16 15:30:31.621632 (MainThread): 11:30:31 | 
2020-07-16 15:30:31.621842 (MainThread): 11:30:31 | Finished running 1 table model in 5.46s.
2020-07-16 15:30:31.622094 (MainThread): Connection 'master' was properly closed.
2020-07-16 15:30:31.622245 (MainThread): Connection 'model.springml_demo_dbt_project.gender_count' was left open.
2020-07-16 15:30:31.627906 (MainThread): 
2020-07-16 15:30:31.628203 (MainThread): Completed successfully
2020-07-16 15:30:31.628556 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-07-16 15:30:31.628898 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1174ec510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1174ec890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116f7ec90>]}
2020-07-16 15:30:31.629130 (MainThread): Flushing usage events
2020-07-16 18:43:32.429345 (MainThread): Running with dbt=0.17.0
2020-07-16 18:43:33.911717 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['redaction'], partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-16 18:43:33.914971 (MainThread): Tracking: tracking
2020-07-16 18:43:33.942454 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bcdc610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bce2d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bce2b10>]}
2020-07-16 18:43:33.971002 (MainThread): Partial parsing not enabled
2020-07-16 18:43:33.973717 (MainThread): Parsing macros/core.sql
2020-07-16 18:43:33.980354 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-16 18:43:33.991938 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-16 18:43:33.994783 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-16 18:43:34.016880 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-16 18:43:34.052890 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-16 18:43:34.082014 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-16 18:43:34.085396 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-16 18:43:34.093951 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-16 18:43:34.116236 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-16 18:43:34.125631 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-16 18:43:34.133747 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-16 18:43:34.142269 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-16 18:43:34.144184 (MainThread): Parsing macros/etc/query.sql
2020-07-16 18:43:34.145970 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-16 18:43:34.148564 (MainThread): Parsing macros/etc/datetime.sql
2020-07-16 18:43:34.159827 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-16 18:43:34.162934 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-16 18:43:34.165793 (MainThread): Parsing macros/adapters/common.sql
2020-07-16 18:43:34.224255 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-16 18:43:34.226952 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-16 18:43:34.228814 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-16 18:43:34.230607 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-16 18:43:34.234194 (MainThread): Parsing macros/etc.sql
2020-07-16 18:43:34.235703 (MainThread): Parsing macros/catalog.sql
2020-07-16 18:43:34.243686 (MainThread): Parsing macros/adapters.sql
2020-07-16 18:43:34.263142 (MainThread): Parsing macros/materializations/seed.sql
2020-07-16 18:43:34.265952 (MainThread): Parsing macros/materializations/view.sql
2020-07-16 18:43:34.268897 (MainThread): Parsing macros/materializations/table.sql
2020-07-16 18:43:34.282054 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-16 18:43:34.298405 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-16 18:43:34.324799 (MainThread): Partial parsing not enabled
2020-07-16 18:43:34.372864 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 18:43:34.373040 (MainThread): Opening a new connection, currently in state init
2020-07-16 18:43:34.406052 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-16 18:43:34.406217 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:43:34.421619 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-16 18:43:34.421859 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:43:34.437113 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-16 18:43:34.437265 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:43:34.500006 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-16 18:43:34.500191 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:43:34.591984 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bcf31d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bd1cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bd1c090>]}
2020-07-16 18:43:34.592283 (MainThread): Flushing usage events
2020-07-16 18:43:34.920397 (MainThread): Connection 'test.springml_demo_dbt_project.creditcardtest' was properly closed.
2020-07-16 18:43:34.920636 (MainThread): Encountered an error:
2020-07-16 18:43:34.920811 (MainThread): Compilation Error
  dbt found two resources with the name "springml_demo_dataset_applicant_data". Since these resources have the same name,
  dbt will be unable to find the correct resource when source("springml_demo_dataset", "applicant_data") is used. To fix this,
  change the name of one of these resources:
  - source.springml_demo_dbt_project.springml_demo_dataset.applicant_data (models/redaction/schema.yml)
  - source.springml_demo_dbt_project.springml_demo_dataset.applicant_data (models/gender/schema.yml)
2020-07-16 18:43:34.929533 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 212, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.7/site-packages/dbt/task/runnable.py", line 389, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.7/site-packages/dbt/task/runnable.py", line 103, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.7/site-packages/dbt/task/runnable.py", line 71, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.7/site-packages/dbt/task/runnable.py", line 60, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.7/site-packages/dbt/perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 641, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 356, in load_all
    loader.load(internal_manifest=internal_manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 212, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 186, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 142, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/schemas.py", line 533, in parse_file
    for test_block in parser.parse():
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/schemas.py", line 623, in parse
    self.add_source_definitions(source)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/schemas.py", line 650, in add_source_definitions
    self.results.add_source(self.yaml.file, result)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/results.py", line 93, in add_source
    _check_duplicates(source, self.sources)
  File "/usr/local/lib/python3.7/site-packages/dbt/parser/results.py", line 46, in _check_duplicates
    raise_duplicate_resource_name(value, src[value.unique_id])
  File "/usr/local/lib/python3.7/site-packages/dbt/exceptions.py", line 744, in raise_duplicate_resource_name
    node_2.unique_id, node_2.original_file_path))
  File "/usr/local/lib/python3.7/site-packages/dbt/exceptions.py", line 392, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  dbt found two resources with the name "springml_demo_dataset_applicant_data". Since these resources have the same name,
  dbt will be unable to find the correct resource when source("springml_demo_dataset", "applicant_data") is used. To fix this,
  change the name of one of these resources:
  - source.springml_demo_dbt_project.springml_demo_dataset.applicant_data (models/redaction/schema.yml)
  - source.springml_demo_dbt_project.springml_demo_dataset.applicant_data (models/gender/schema.yml)

2020-07-16 18:45:30.541942 (MainThread): Running with dbt=0.17.0
2020-07-16 18:45:31.943280 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['redaction'], partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-16 18:45:31.945801 (MainThread): Tracking: tracking
2020-07-16 18:45:31.970958 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebd72d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebdcb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebdc990>]}
2020-07-16 18:45:31.998423 (MainThread): Partial parsing not enabled
2020-07-16 18:45:32.002305 (MainThread): Parsing macros/core.sql
2020-07-16 18:45:32.041363 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-16 18:45:32.059592 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-16 18:45:32.063316 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-16 18:45:32.120922 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-16 18:45:32.158662 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-16 18:45:32.190940 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-16 18:45:32.193532 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-16 18:45:32.201765 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-16 18:45:32.219234 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-16 18:45:32.229686 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-16 18:45:32.239521 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-16 18:45:32.245803 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-16 18:45:32.247440 (MainThread): Parsing macros/etc/query.sql
2020-07-16 18:45:32.249194 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-16 18:45:32.251906 (MainThread): Parsing macros/etc/datetime.sql
2020-07-16 18:45:32.263487 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-16 18:45:32.266231 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-16 18:45:32.268631 (MainThread): Parsing macros/adapters/common.sql
2020-07-16 18:45:32.330453 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-16 18:45:32.332366 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-16 18:45:32.333943 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-16 18:45:32.335783 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-16 18:45:32.339266 (MainThread): Parsing macros/etc.sql
2020-07-16 18:45:32.340333 (MainThread): Parsing macros/catalog.sql
2020-07-16 18:45:32.347614 (MainThread): Parsing macros/adapters.sql
2020-07-16 18:45:32.367284 (MainThread): Parsing macros/materializations/seed.sql
2020-07-16 18:45:32.370089 (MainThread): Parsing macros/materializations/view.sql
2020-07-16 18:45:32.372726 (MainThread): Parsing macros/materializations/table.sql
2020-07-16 18:45:32.387296 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-16 18:45:32.403697 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-16 18:45:32.450778 (MainThread): Partial parsing not enabled
2020-07-16 18:45:32.514960 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-16 18:45:32.515147 (MainThread): Opening a new connection, currently in state init
2020-07-16 18:45:32.560269 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 18:45:32.560457 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:45:32.581788 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-16 18:45:32.581986 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:45:32.603377 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-16 18:45:32.603526 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:45:32.673726 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-16 18:45:32.673880 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:45:33.148891 (MainThread): Found 4 models, 9 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 2 seed files, 2 sources
2020-07-16 18:45:33.149348 (MainThread): The selector 'redaction' does not match any nodes and will be ignored
2020-07-16 18:45:33.150086 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2020-07-16 18:45:33.150301 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec437d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec43f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec43910>]}
2020-07-16 18:45:33.150541 (MainThread): Flushing usage events
2020-07-16 18:45:33.477632 (MainThread): Connection 'test.springml_demo_dbt_project.creditcardtest' was properly closed.
2020-07-16 18:45:45.405487 (MainThread): Running with dbt=0.17.0
2020-07-16 18:45:45.830883 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['applicant'], partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-16 18:45:45.832231 (MainThread): Tracking: tracking
2020-07-16 18:45:45.853376 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115f6610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115fbb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115fb950>]}
2020-07-16 18:45:45.881542 (MainThread): Partial parsing not enabled
2020-07-16 18:45:45.883494 (MainThread): Parsing macros/core.sql
2020-07-16 18:45:45.889261 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-16 18:45:45.902533 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-16 18:45:45.904895 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-16 18:45:45.927367 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-16 18:45:45.966869 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-16 18:45:45.995047 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-16 18:45:45.998095 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-16 18:45:46.006108 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-16 18:45:46.031453 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-16 18:45:46.041536 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-16 18:45:46.049361 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-16 18:45:46.055634 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-16 18:45:46.056810 (MainThread): Parsing macros/etc/query.sql
2020-07-16 18:45:46.058101 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-16 18:45:46.060106 (MainThread): Parsing macros/etc/datetime.sql
2020-07-16 18:45:46.070747 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-16 18:45:46.073142 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-16 18:45:46.075120 (MainThread): Parsing macros/adapters/common.sql
2020-07-16 18:45:46.133611 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-16 18:45:46.135092 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-16 18:45:46.136191 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-16 18:45:46.137492 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-16 18:45:46.140217 (MainThread): Parsing macros/etc.sql
2020-07-16 18:45:46.140985 (MainThread): Parsing macros/catalog.sql
2020-07-16 18:45:46.148051 (MainThread): Parsing macros/adapters.sql
2020-07-16 18:45:46.168021 (MainThread): Parsing macros/materializations/seed.sql
2020-07-16 18:45:46.170452 (MainThread): Parsing macros/materializations/view.sql
2020-07-16 18:45:46.172954 (MainThread): Parsing macros/materializations/table.sql
2020-07-16 18:45:46.185970 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-16 18:45:46.202466 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-16 18:45:46.227260 (MainThread): Partial parsing not enabled
2020-07-16 18:45:46.268414 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-16 18:45:46.268633 (MainThread): Opening a new connection, currently in state init
2020-07-16 18:45:46.304685 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 18:45:46.304853 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:45:46.317963 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-16 18:45:46.318134 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:45:46.331619 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-16 18:45:46.331794 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:45:46.392089 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-16 18:45:46.392239 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:45:46.802622 (MainThread): Found 4 models, 9 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 2 seed files, 2 sources
2020-07-16 18:45:46.803789 (MainThread): 
2020-07-16 18:45:46.804194 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 18:45:46.804305 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:45:46.808459 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-16 18:45:46.808748 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-16 18:45:46.812406 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-16 18:45:49.701885 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-16 18:45:49.702151 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-16 18:45:49.702324 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 18:45:49.883661 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 18:45:49.883848 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:45:49.884188 (MainThread): 14:45:49 | Concurrency: 1 threads (target='dev')
2020-07-16 18:45:49.884356 (MainThread): 14:45:49 | 
2020-07-16 18:45:49.889326 (Thread-1): Began running node model.springml_demo_dbt_project.gender_count
2020-07-16 18:45:49.890883 (Thread-1): 14:45:49 | 1 of 2 START incremental model springml_demo_dataset.gender_count.... [RUN]
2020-07-16 18:45:49.891323 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 18:45:49.891430 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-16 18:45:49.891555 (Thread-1): Compiling model.springml_demo_dbt_project.gender_count
2020-07-16 18:45:49.912713 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 18:45:49.913388 (Thread-1): finished collecting timing info
2020-07-16 18:45:49.980562 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 18:45:49.981187 (Thread-1): On model.springml_demo_dbt_project.gender_count: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.gender_count"} */


  create or replace table `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count`
  
  
  OPTIONS()
  as (
    SELECT 
CURRENT_DATE() as Ingestion_date, 
countif(ad.Gender is not null and ad.Gender="F" ) as Female_count,
countif(ad.Gender is not null and ad.Gender="M" ) as Male_count,
FROM `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data` as ad
  );
  
2020-07-16 18:45:52.300244 (Thread-1): finished collecting timing info
2020-07-16 18:45:52.301406 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd44d4016-c38f-4c70-8d60-be4d02d5e48b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115af4d0>]}
2020-07-16 18:45:52.302781 (Thread-1): 14:45:52 | 1 of 2 OK created incremental model springml_demo_dataset.gender_count [CREATE TABLE (1) in 2.41s]
2020-07-16 18:45:52.303016 (Thread-1): Finished running node model.springml_demo_dbt_project.gender_count
2020-07-16 18:45:52.303209 (Thread-1): Began running node model.springml_demo_dbt_project.redact_fields
2020-07-16 18:45:52.304478 (Thread-1): 14:45:52 | 2 of 2 START incremental model springml_demo_dataset.redact_fields... [RUN]
2020-07-16 18:45:52.304895 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-16 18:45:52.304995 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.gender_count).
2020-07-16 18:45:52.305088 (Thread-1): Compiling model.springml_demo_dbt_project.redact_fields
2020-07-16 18:45:52.316334 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-16 18:45:52.316861 (Thread-1): finished collecting timing info
2020-07-16 18:45:52.322735 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-16 18:45:52.323237 (Thread-1): On model.springml_demo_dbt_project.redact_fields: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.redact_fields"} */


  create or replace table `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields`
  
  
  OPTIONS()
  as (
    redacted as ( 

		select
			case
			  when Surname like "A" then '##ARCHIVED##'
              else '##ARCHIVED##'
		    end as Surname,
            case
			  when Given_name like "A" then '##ARCHIVED##'
              else '##ARCHIVED##'
		    end as Given_name,
            case
			  when Phone_no like 0 then '##ARCHIVED##'
              else '##ARCHIVED##'
		    end as Phone_no,
            case
			  when Social_insurance_no like 0 then '##ARCHIVED##'
              else '##ARCHIVED##'
		    end as Social_insurance_no,
		from
			`prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`

)

select * from redacted
  );
  
2020-07-16 18:45:52.585966 (Thread-1): finished collecting timing info
2020-07-16 18:45:52.586875 (Thread-1): Database Error in model redact_fields (models/applicant/redact_fields.sql)
  Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "redacted" at [9:5]
  compiled SQL at target/run/springml_demo_dbt_project/models/applicant/redact_fields.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 84, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 225, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 352, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 127, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "redacted" at [9:5]

(job ID: fea95338-0e61-48c3-bd29-54d6b2461b73)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.redact_fields"} */
   2:
   3:
   4:  create or replace table `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    redacted as ( 
  10:
  11:		select
  12:			case
  13:			  when Surname like "A" then '##ARCHIVED##'
  14:              else '##ARCHIVED##'
  15:		    end as Surname,
  16:            case
  17:			  when Given_name like "A" then '##ARCHIVED##'
  18:              else '##ARCHIVED##'
  19:		    end as Given_name,
  20:            case
  21:			  when Phone_no like 0 then '##ARCHIVED##'
  22:              else '##ARCHIVED##'
  23:		    end as Phone_no,
  24:            case
  25:			  when Social_insurance_no like 0 then '##ARCHIVED##'
  26:              else '##ARCHIVED##'
  27:		    end as Social_insurance_no,
  28:		from
  29:			`prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`
  30:
  31:)
  32:
  33:select * from redacted
  34:  );
  35:  
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 156, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 234, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 227, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/Cellar/python/3.7.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 88, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 76, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model redact_fields (models/applicant/redact_fields.sql)
  Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "redacted" at [9:5]
  compiled SQL at target/run/springml_demo_dbt_project/models/applicant/redact_fields.sql
2020-07-16 18:45:52.609748 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd44d4016-c38f-4c70-8d60-be4d02d5e48b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b5bd90>]}
2020-07-16 18:45:52.611449 (Thread-1): 14:45:52 | 2 of 2 ERROR creating incremental model springml_demo_dataset.redact_fields [ERROR in 0.31s]
2020-07-16 18:45:52.611679 (Thread-1): Finished running node model.springml_demo_dbt_project.redact_fields
2020-07-16 18:45:52.688582 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 18:45:52.688836 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:45:52.689352 (MainThread): 14:45:52 | 
2020-07-16 18:45:52.689575 (MainThread): 14:45:52 | Finished running 2 incremental models in 5.89s.
2020-07-16 18:45:52.689888 (MainThread): Connection 'master' was properly closed.
2020-07-16 18:45:52.690117 (MainThread): Connection 'model.springml_demo_dbt_project.redact_fields' was left open.
2020-07-16 18:45:52.701592 (MainThread): 
2020-07-16 18:45:52.701813 (MainThread): Completed with 1 error and 0 warnings:
2020-07-16 18:45:52.701997 (MainThread): 
2020-07-16 18:45:52.702186 (MainThread): Database Error in model redact_fields (models/applicant/redact_fields.sql)
2020-07-16 18:45:52.702337 (MainThread):   Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "redacted" at [9:5]
2020-07-16 18:45:52.702479 (MainThread):   compiled SQL at target/run/springml_demo_dbt_project/models/applicant/redact_fields.sql
2020-07-16 18:45:52.702636 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2020-07-16 18:45:52.702922 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b27c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bc8250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b5bd90>]}
2020-07-16 18:45:52.703157 (MainThread): Flushing usage events
2020-07-16 18:47:07.537839 (MainThread): Running with dbt=0.17.0
2020-07-16 18:47:08.712052 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['applicant'], partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-16 18:47:08.718490 (MainThread): Tracking: tracking
2020-07-16 18:47:08.740972 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efe4f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efcb650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed20c50>]}
2020-07-16 18:47:08.767590 (MainThread): Partial parsing not enabled
2020-07-16 18:47:08.770334 (MainThread): Parsing macros/core.sql
2020-07-16 18:47:08.778504 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-16 18:47:08.791388 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-16 18:47:08.794113 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-16 18:47:08.822748 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-16 18:47:08.860952 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-16 18:47:08.887619 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-16 18:47:08.890725 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-16 18:47:08.899166 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-16 18:47:08.919192 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-16 18:47:08.930282 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-16 18:47:08.939606 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-16 18:47:08.946074 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-16 18:47:08.947982 (MainThread): Parsing macros/etc/query.sql
2020-07-16 18:47:08.950131 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-16 18:47:08.952848 (MainThread): Parsing macros/etc/datetime.sql
2020-07-16 18:47:08.964767 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-16 18:47:08.968058 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-16 18:47:08.970714 (MainThread): Parsing macros/adapters/common.sql
2020-07-16 18:47:09.029059 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-16 18:47:09.030974 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-16 18:47:09.032463 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-16 18:47:09.034122 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-16 18:47:09.037453 (MainThread): Parsing macros/etc.sql
2020-07-16 18:47:09.038883 (MainThread): Parsing macros/catalog.sql
2020-07-16 18:47:09.046394 (MainThread): Parsing macros/adapters.sql
2020-07-16 18:47:09.066229 (MainThread): Parsing macros/materializations/seed.sql
2020-07-16 18:47:09.069167 (MainThread): Parsing macros/materializations/view.sql
2020-07-16 18:47:09.072217 (MainThread): Parsing macros/materializations/table.sql
2020-07-16 18:47:09.085247 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-16 18:47:09.101195 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-16 18:47:09.129234 (MainThread): Partial parsing not enabled
2020-07-16 18:47:09.174909 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-16 18:47:09.175067 (MainThread): Opening a new connection, currently in state init
2020-07-16 18:47:09.210058 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 18:47:09.210220 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:47:09.223867 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-16 18:47:09.224018 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:47:09.239245 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-16 18:47:09.239437 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:47:09.301111 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-16 18:47:09.301290 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:47:09.706819 (MainThread): Found 4 models, 9 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 2 seed files, 2 sources
2020-07-16 18:47:09.707897 (MainThread): 
2020-07-16 18:47:09.708256 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 18:47:09.708352 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:47:09.712737 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-16 18:47:09.713030 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-16 18:47:09.715414 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-16 18:47:11.851514 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-16 18:47:11.851865 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-16 18:47:11.852046 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 18:47:11.999866 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 18:47:12.000034 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:47:12.000371 (MainThread): 14:47:12 | Concurrency: 1 threads (target='dev')
2020-07-16 18:47:12.000537 (MainThread): 14:47:12 | 
2020-07-16 18:47:12.003346 (Thread-1): Began running node model.springml_demo_dbt_project.gender_count
2020-07-16 18:47:12.005612 (Thread-1): 14:47:12 | 1 of 2 START incremental model springml_demo_dataset.gender_count.... [RUN]
2020-07-16 18:47:12.006077 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 18:47:12.006192 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-16 18:47:12.006320 (Thread-1): Compiling model.springml_demo_dbt_project.gender_count
2020-07-16 18:47:12.028142 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 18:47:12.028668 (Thread-1): finished collecting timing info
2020-07-16 18:47:12.069117 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 18:47:12.640185 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 18:47:12.640789 (Thread-1): On model.springml_demo_dbt_project.gender_count: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.gender_count"} */

        
    

    

    merge into `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count` as DBT_INTERNAL_DEST
        using (
           SELECT 
CURRENT_DATE() as Ingestion_date, 
countif(ad.Gender is not null and ad.Gender="F" ) as Female_count,
countif(ad.Gender is not null and ad.Gender="M" ) as Male_count,
FROM `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data` as ad
         ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`Ingestion_date`, `Female_count`, `Male_count`)
    values
        (`Ingestion_date`, `Female_count`, `Male_count`)


  
2020-07-16 18:47:14.886528 (Thread-1): finished collecting timing info
2020-07-16 18:47:14.888101 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfe8a772-ab0b-4acb-9b59-e58abf2a1eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f538250>]}
2020-07-16 18:47:14.890645 (Thread-1): 14:47:14 | 1 of 2 OK created incremental model springml_demo_dataset.gender_count [MERGE (1) in 2.88s]
2020-07-16 18:47:14.890998 (Thread-1): Finished running node model.springml_demo_dbt_project.gender_count
2020-07-16 18:47:14.891368 (Thread-1): Began running node model.springml_demo_dbt_project.redact_fields
2020-07-16 18:47:14.893832 (Thread-1): 14:47:14 | 2 of 2 START incremental model springml_demo_dataset.redact_fields... [RUN]
2020-07-16 18:47:14.894638 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-16 18:47:14.894942 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.gender_count).
2020-07-16 18:47:14.895170 (Thread-1): Compiling model.springml_demo_dbt_project.redact_fields
2020-07-16 18:47:14.916485 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-16 18:47:14.917236 (Thread-1): finished collecting timing info
2020-07-16 18:47:14.961701 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-16 18:47:14.962266 (Thread-1): On model.springml_demo_dbt_project.redact_fields: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.redact_fields"} */


  create or replace table `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields`
  
  
  OPTIONS()
  as (
    with source as (
		select * from `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`
),

redacted as ( 

		select
			case
			  when Surname like "A" then '##ARCHIVED##'
              else '##ARCHIVED##'
		    end as Surname,
            case
			  when Given_name like "A" then '##ARCHIVED##'
              else '##ARCHIVED##'
		    end as Given_name,
            case
			  when Phone_no like 0 then '##ARCHIVED##'
              else '##ARCHIVED##'
		    end as Phone_no,
            case
			  when Social_insurance_no like 0 then '##ARCHIVED##'
              else '##ARCHIVED##'
		    end as Social_insurance_no,
		from
			source
)

select * from redacted
  );
  
2020-07-16 18:47:15.429543 (Thread-1): finished collecting timing info
2020-07-16 18:47:15.430766 (Thread-1): Database Error in model redact_fields (models/applicant/redact_fields.sql)
  No matching signature for operator LIKE for argument types: STRING, INT64. Supported signatures: STRING LIKE STRING; BYTES LIKE BYTES at [25:32]
  compiled SQL at target/run/springml_demo_dbt_project/models/applicant/redact_fields.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 84, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 225, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 352, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 122, in result
    self._blocking_poll(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3098, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 101, in _blocking_poll
    retry_(self._done_or_raise)()
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 80, in _done_or_raise
    if not self.done():
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3085, in done
    timeout=timeout,
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/client.py", line 1287, in _get_query_results
    retry, method="GET", path=path, query_params=extra_params, timeout=timeout
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/client.py", line 556, in _call_api
    return call()
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/google/cloud/_http.py", line 423, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/prismatic-cider-279015/queries/766677b5-8e17-4952-937d-6aea9015a4b7?maxResults=0&location=US: No matching signature for operator LIKE for argument types: STRING, INT64. Supported signatures: STRING LIKE STRING; BYTES LIKE BYTES at [25:32]

(job ID: 766677b5-8e17-4952-937d-6aea9015a4b7)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.redact_fields"} */
   2:
   3:
   4:  create or replace table `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    with source as (
  10:		select * from `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`
  11:),
  12:
  13:redacted as ( 
  14:
  15:		select
  16:			case
  17:			  when Surname like "A" then '##ARCHIVED##'
  18:              else '##ARCHIVED##'
  19:		    end as Surname,
  20:            case
  21:			  when Given_name like "A" then '##ARCHIVED##'
  22:              else '##ARCHIVED##'
  23:		    end as Given_name,
  24:            case
  25:			  when Phone_no like 0 then '##ARCHIVED##'
  26:              else '##ARCHIVED##'
  27:		    end as Phone_no,
  28:            case
  29:			  when Social_insurance_no like 0 then '##ARCHIVED##'
  30:              else '##ARCHIVED##'
  31:		    end as Social_insurance_no,
  32:		from
  33:			source
  34:)
  35:
  36:select * from redacted
  37:  );
  38:  
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 156, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 234, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 227, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/Cellar/python/3.7.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 88, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 76, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model redact_fields (models/applicant/redact_fields.sql)
  No matching signature for operator LIKE for argument types: STRING, INT64. Supported signatures: STRING LIKE STRING; BYTES LIKE BYTES at [25:32]
  compiled SQL at target/run/springml_demo_dbt_project/models/applicant/redact_fields.sql
2020-07-16 18:47:15.498797 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfe8a772-ab0b-4acb-9b59-e58abf2a1eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f416c90>]}
2020-07-16 18:47:15.500828 (Thread-1): 14:47:15 | 2 of 2 ERROR creating incremental model springml_demo_dataset.redact_fields [ERROR in 0.60s]
2020-07-16 18:47:15.501080 (Thread-1): Finished running node model.springml_demo_dbt_project.redact_fields
2020-07-16 18:47:15.529518 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 18:47:15.529762 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:47:15.530245 (MainThread): 14:47:15 | 
2020-07-16 18:47:15.530458 (MainThread): 14:47:15 | Finished running 2 incremental models in 5.82s.
2020-07-16 18:47:15.530700 (MainThread): Connection 'master' was properly closed.
2020-07-16 18:47:15.530861 (MainThread): Connection 'model.springml_demo_dbt_project.redact_fields' was left open.
2020-07-16 18:47:15.542267 (MainThread): 
2020-07-16 18:47:15.542642 (MainThread): Completed with 1 error and 0 warnings:
2020-07-16 18:47:15.542871 (MainThread): 
2020-07-16 18:47:15.543051 (MainThread): Database Error in model redact_fields (models/applicant/redact_fields.sql)
2020-07-16 18:47:15.543210 (MainThread):   No matching signature for operator LIKE for argument types: STRING, INT64. Supported signatures: STRING LIKE STRING; BYTES LIKE BYTES at [25:32]
2020-07-16 18:47:15.543350 (MainThread):   compiled SQL at target/run/springml_demo_dbt_project/models/applicant/redact_fields.sql
2020-07-16 18:47:15.543514 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2020-07-16 18:47:15.543812 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f53bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f43f210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f421550>]}
2020-07-16 18:47:15.544076 (MainThread): Flushing usage events
2020-07-16 18:49:27.518784 (MainThread): Running with dbt=0.17.0
2020-07-16 18:49:28.822104 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['applicant'], partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-16 18:49:28.824921 (MainThread): Tracking: tracking
2020-07-16 18:49:28.843076 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c525410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c52ab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c52a950>]}
2020-07-16 18:49:28.869950 (MainThread): Partial parsing not enabled
2020-07-16 18:49:28.872669 (MainThread): Parsing macros/core.sql
2020-07-16 18:49:28.879269 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-16 18:49:28.889376 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-16 18:49:28.892566 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-16 18:49:28.914965 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-16 18:49:28.955352 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-16 18:49:28.983289 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-16 18:49:28.986925 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-16 18:49:28.997540 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-16 18:49:29.017905 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-16 18:49:29.026953 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-16 18:49:29.036335 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-16 18:49:29.043405 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-16 18:49:29.045343 (MainThread): Parsing macros/etc/query.sql
2020-07-16 18:49:29.047374 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-16 18:49:29.050488 (MainThread): Parsing macros/etc/datetime.sql
2020-07-16 18:49:29.062716 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-16 18:49:29.066152 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-16 18:49:29.069385 (MainThread): Parsing macros/adapters/common.sql
2020-07-16 18:49:29.128478 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-16 18:49:29.130932 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-16 18:49:29.133227 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-16 18:49:29.135569 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-16 18:49:29.139539 (MainThread): Parsing macros/etc.sql
2020-07-16 18:49:29.141425 (MainThread): Parsing macros/catalog.sql
2020-07-16 18:49:29.150149 (MainThread): Parsing macros/adapters.sql
2020-07-16 18:49:29.169959 (MainThread): Parsing macros/materializations/seed.sql
2020-07-16 18:49:29.173028 (MainThread): Parsing macros/materializations/view.sql
2020-07-16 18:49:29.176499 (MainThread): Parsing macros/materializations/table.sql
2020-07-16 18:49:29.190115 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-16 18:49:29.213549 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-16 18:49:29.239976 (MainThread): Partial parsing not enabled
2020-07-16 18:49:29.293395 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-16 18:49:29.293559 (MainThread): Opening a new connection, currently in state init
2020-07-16 18:49:29.329115 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 18:49:29.329268 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:49:29.343998 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-16 18:49:29.344151 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:49:29.358444 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-16 18:49:29.358596 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:49:29.430138 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-16 18:49:29.430303 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:49:29.878061 (MainThread): Found 4 models, 9 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 2 seed files, 2 sources
2020-07-16 18:49:29.879393 (MainThread): 
2020-07-16 18:49:29.879788 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 18:49:29.879893 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:49:29.884432 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-16 18:49:29.884707 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-16 18:49:29.888528 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-16 18:49:32.456250 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-16 18:49:32.456530 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-16 18:49:32.456705 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 18:49:32.804930 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 18:49:32.805109 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:49:32.805521 (MainThread): 14:49:32 | Concurrency: 1 threads (target='dev')
2020-07-16 18:49:32.805749 (MainThread): 14:49:32 | 
2020-07-16 18:49:32.808252 (Thread-1): Began running node model.springml_demo_dbt_project.gender_count
2020-07-16 18:49:32.809416 (Thread-1): 14:49:32 | 1 of 2 START incremental model springml_demo_dataset.gender_count.... [RUN]
2020-07-16 18:49:32.809865 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 18:49:32.809964 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-16 18:49:32.810076 (Thread-1): Compiling model.springml_demo_dbt_project.gender_count
2020-07-16 18:49:32.842394 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 18:49:32.844070 (Thread-1): finished collecting timing info
2020-07-16 18:49:32.887700 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 18:49:33.122924 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 18:49:33.125084 (Thread-1): On model.springml_demo_dbt_project.gender_count: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.gender_count"} */

        
    

    

    merge into `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count` as DBT_INTERNAL_DEST
        using (
           SELECT 
CURRENT_DATE() as Ingestion_date, 
countif(ad.Gender is not null and ad.Gender="F" ) as Female_count,
countif(ad.Gender is not null and ad.Gender="M" ) as Male_count,
FROM `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data` as ad
         ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`Ingestion_date`, `Female_count`, `Male_count`)
    values
        (`Ingestion_date`, `Female_count`, `Male_count`)


  
2020-07-16 18:49:34.790069 (Thread-1): finished collecting timing info
2020-07-16 18:49:34.790878 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0605522-9f0a-4876-bdc7-5ce6db06dc09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c901290>]}
2020-07-16 18:49:34.791966 (Thread-1): 14:49:34 | 1 of 2 OK created incremental model springml_demo_dataset.gender_count [MERGE (1) in 1.98s]
2020-07-16 18:49:34.792151 (Thread-1): Finished running node model.springml_demo_dbt_project.gender_count
2020-07-16 18:49:34.792787 (Thread-1): Began running node model.springml_demo_dbt_project.redact_fields
2020-07-16 18:49:34.794006 (Thread-1): 14:49:34 | 2 of 2 START incremental model springml_demo_dataset.redact_fields... [RUN]
2020-07-16 18:49:34.794342 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-16 18:49:34.794437 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.gender_count).
2020-07-16 18:49:34.794526 (Thread-1): Compiling model.springml_demo_dbt_project.redact_fields
2020-07-16 18:49:34.807250 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-16 18:49:34.807742 (Thread-1): finished collecting timing info
2020-07-16 18:49:34.831724 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-16 18:49:34.833083 (Thread-1): On model.springml_demo_dbt_project.redact_fields: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.redact_fields"} */


  create or replace table `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields`
  
  
  OPTIONS()
  as (
    with source as (
		select * from `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`
),

redacted as ( 

		select
			case
			  when Surname like "A" then '##ARCHIVED##'
              else '##ARCHIVED##'
		    end as Surname,
            case
			  when Given_name like "A" then '##ARCHIVED##'
              else '##ARCHIVED##'
		    end as Given_name
		from
			source
)

select * from redacted
  );
  
2020-07-16 18:49:36.689245 (Thread-1): finished collecting timing info
2020-07-16 18:49:36.690266 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0605522-9f0a-4876-bdc7-5ce6db06dc09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d266fd0>]}
2020-07-16 18:49:36.692093 (Thread-1): 14:49:36 | 2 of 2 OK created incremental model springml_demo_dataset.redact_fields [CREATE TABLE (8336) in 1.90s]
2020-07-16 18:49:36.692456 (Thread-1): Finished running node model.springml_demo_dbt_project.redact_fields
2020-07-16 18:49:36.736953 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 18:49:36.737136 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:49:36.737482 (MainThread): 14:49:36 | 
2020-07-16 18:49:36.737627 (MainThread): 14:49:36 | Finished running 2 incremental models in 6.86s.
2020-07-16 18:49:36.737765 (MainThread): Connection 'master' was properly closed.
2020-07-16 18:49:36.737896 (MainThread): Connection 'model.springml_demo_dbt_project.redact_fields' was left open.
2020-07-16 18:49:36.745952 (MainThread): 
2020-07-16 18:49:36.746136 (MainThread): Completed successfully
2020-07-16 18:49:36.746276 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-07-16 18:49:36.746682 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c901290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d2d6bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d2d6390>]}
2020-07-16 18:49:36.746911 (MainThread): Flushing usage events
2020-07-16 18:52:36.692174 (MainThread): Running with dbt=0.17.0
2020-07-16 18:52:38.086444 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['applicant'], partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-16 18:52:38.089295 (MainThread): Tracking: tracking
2020-07-16 18:52:38.114915 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112280e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd56710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122cdcd0>]}
2020-07-16 18:52:38.152075 (MainThread): Partial parsing not enabled
2020-07-16 18:52:38.157838 (MainThread): Parsing macros/core.sql
2020-07-16 18:52:38.164802 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-16 18:52:38.178588 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-16 18:52:38.181617 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-16 18:52:38.209466 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-16 18:52:38.247426 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-16 18:52:38.274989 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-16 18:52:38.278230 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-16 18:52:38.287498 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-16 18:52:38.305250 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-16 18:52:38.314383 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-16 18:52:38.322974 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-16 18:52:38.329463 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-16 18:52:38.331134 (MainThread): Parsing macros/etc/query.sql
2020-07-16 18:52:38.333025 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-16 18:52:38.335460 (MainThread): Parsing macros/etc/datetime.sql
2020-07-16 18:52:38.347366 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-16 18:52:38.350707 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-16 18:52:38.353317 (MainThread): Parsing macros/adapters/common.sql
2020-07-16 18:52:38.413167 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-16 18:52:38.415802 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-16 18:52:38.417633 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-16 18:52:38.419818 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-16 18:52:38.423791 (MainThread): Parsing macros/etc.sql
2020-07-16 18:52:38.425357 (MainThread): Parsing macros/catalog.sql
2020-07-16 18:52:38.435973 (MainThread): Parsing macros/adapters.sql
2020-07-16 18:52:38.460940 (MainThread): Parsing macros/materializations/seed.sql
2020-07-16 18:52:38.463768 (MainThread): Parsing macros/materializations/view.sql
2020-07-16 18:52:38.466688 (MainThread): Parsing macros/materializations/table.sql
2020-07-16 18:52:38.481549 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-16 18:52:38.499467 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-16 18:52:38.524586 (MainThread): Partial parsing not enabled
2020-07-16 18:52:38.568796 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-16 18:52:38.568976 (MainThread): Opening a new connection, currently in state init
2020-07-16 18:52:38.606096 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 18:52:38.606268 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:52:38.621644 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-16 18:52:38.621799 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:52:38.636274 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-16 18:52:38.636434 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:52:38.699760 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-16 18:52:38.699939 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:52:39.130652 (MainThread): Found 4 models, 9 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 2 seed files, 2 sources
2020-07-16 18:52:39.132203 (MainThread): 
2020-07-16 18:52:39.132866 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 18:52:39.133073 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:52:39.138149 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-16 18:52:39.138384 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-16 18:52:39.141448 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-16 18:52:43.409650 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-16 18:52:43.409925 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-16 18:52:43.410096 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 18:52:43.844368 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 18:52:43.844653 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:52:43.845292 (MainThread): 14:52:43 | Concurrency: 1 threads (target='dev')
2020-07-16 18:52:43.845690 (MainThread): 14:52:43 | 
2020-07-16 18:52:43.849749 (Thread-1): Began running node model.springml_demo_dbt_project.gender_count
2020-07-16 18:52:43.851353 (Thread-1): 14:52:43 | 1 of 2 START incremental model springml_demo_dataset.gender_count.... [RUN]
2020-07-16 18:52:43.851877 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 18:52:43.851990 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-16 18:52:43.852109 (Thread-1): Compiling model.springml_demo_dbt_project.gender_count
2020-07-16 18:52:43.878907 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 18:52:43.879402 (Thread-1): finished collecting timing info
2020-07-16 18:52:43.927833 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 18:52:44.143854 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 18:52:44.144430 (Thread-1): On model.springml_demo_dbt_project.gender_count: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.gender_count"} */

        
    

    

    merge into `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count` as DBT_INTERNAL_DEST
        using (
           SELECT 
CURRENT_DATE() as Ingestion_date, 
countif(ad.Gender is not null and ad.Gender="F" ) as Female_count,
countif(ad.Gender is not null and ad.Gender="M" ) as Male_count,
FROM `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data` as ad
         ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`Ingestion_date`, `Female_count`, `Male_count`)
    values
        (`Ingestion_date`, `Female_count`, `Male_count`)


  
2020-07-16 18:52:45.982955 (Thread-1): finished collecting timing info
2020-07-16 18:52:45.983750 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f3ce5f6-82bb-464d-aac2-5b44968cd714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126dc750>]}
2020-07-16 18:52:45.984957 (Thread-1): 14:52:45 | 1 of 2 OK created incremental model springml_demo_dataset.gender_count [MERGE (1) in 2.13s]
2020-07-16 18:52:45.985104 (Thread-1): Finished running node model.springml_demo_dbt_project.gender_count
2020-07-16 18:52:45.985282 (Thread-1): Began running node model.springml_demo_dbt_project.redact_fields
2020-07-16 18:52:45.986369 (Thread-1): 14:52:45 | 2 of 2 START incremental model springml_demo_dataset.redact_fields... [RUN]
2020-07-16 18:52:45.986792 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-16 18:52:45.986894 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.gender_count).
2020-07-16 18:52:45.986986 (Thread-1): Compiling model.springml_demo_dbt_project.redact_fields
2020-07-16 18:52:45.998284 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-16 18:52:46.001056 (Thread-1): finished collecting timing info
2020-07-16 18:52:46.007383 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 18:52:46.225689 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-16 18:52:46.228381 (Thread-1): On model.springml_demo_dbt_project.redact_fields: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.redact_fields"} */

        
    

    

    merge into `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields` as DBT_INTERNAL_DEST
        using (
           select
	Employee_no,
	'##ARCHIVED##' as Surname,
	case
		when Given_name like "" then '##ARCHIVED##'
		else '##ARCHIVED##'
	end as Given_name,
	Gender,
	City,
	Age,
	Year_joined

from
	`prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`
         ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`Surname`, `Given_name`)
    values
        (`Surname`, `Given_name`)


  
2020-07-16 18:52:48.118651 (Thread-1): finished collecting timing info
2020-07-16 18:52:48.119626 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f3ce5f6-82bb-464d-aac2-5b44968cd714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126d0f10>]}
2020-07-16 18:52:48.120847 (Thread-1): 14:52:48 | 2 of 2 OK created incremental model springml_demo_dataset.redact_fields [MERGE (8336) in 2.13s]
2020-07-16 18:52:48.121024 (Thread-1): Finished running node model.springml_demo_dbt_project.redact_fields
2020-07-16 18:52:48.225143 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 18:52:48.225390 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:52:48.225886 (MainThread): 14:52:48 | 
2020-07-16 18:52:48.226100 (MainThread): 14:52:48 | Finished running 2 incremental models in 9.09s.
2020-07-16 18:52:48.226396 (MainThread): Connection 'master' was properly closed.
2020-07-16 18:52:48.226610 (MainThread): Connection 'model.springml_demo_dbt_project.redact_fields' was left open.
2020-07-16 18:52:48.239028 (MainThread): 
2020-07-16 18:52:48.239344 (MainThread): Completed successfully
2020-07-16 18:52:48.239591 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-07-16 18:52:48.239898 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126d0950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113051290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113040c10>]}
2020-07-16 18:52:48.240219 (MainThread): Flushing usage events
2020-07-16 18:58:53.799390 (MainThread): Running with dbt=0.17.0
2020-07-16 18:58:55.129820 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['applicant'], partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-16 18:58:55.132240 (MainThread): Tracking: tracking
2020-07-16 18:58:55.150962 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d612450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d622cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d622ad0>]}
2020-07-16 18:58:55.178869 (MainThread): Partial parsing not enabled
2020-07-16 18:58:55.181711 (MainThread): Parsing macros/core.sql
2020-07-16 18:58:55.188394 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-16 18:58:55.198406 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-16 18:58:55.202190 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-16 18:58:55.227407 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-16 18:58:55.269841 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-16 18:58:55.297182 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-16 18:58:55.300526 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-16 18:58:55.309719 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-16 18:58:55.327203 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-16 18:58:55.336651 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-16 18:58:55.345411 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-16 18:58:55.352932 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-16 18:58:55.354818 (MainThread): Parsing macros/etc/query.sql
2020-07-16 18:58:55.356752 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-16 18:58:55.359678 (MainThread): Parsing macros/etc/datetime.sql
2020-07-16 18:58:55.371451 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-16 18:58:55.374994 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-16 18:58:55.377853 (MainThread): Parsing macros/adapters/common.sql
2020-07-16 18:58:55.443238 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-16 18:58:55.445611 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-16 18:58:55.447423 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-16 18:58:55.449341 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-16 18:58:55.453194 (MainThread): Parsing macros/etc.sql
2020-07-16 18:58:55.454556 (MainThread): Parsing macros/catalog.sql
2020-07-16 18:58:55.462550 (MainThread): Parsing macros/adapters.sql
2020-07-16 18:58:55.482912 (MainThread): Parsing macros/materializations/seed.sql
2020-07-16 18:58:55.486164 (MainThread): Parsing macros/materializations/view.sql
2020-07-16 18:58:55.489010 (MainThread): Parsing macros/materializations/table.sql
2020-07-16 18:58:55.502735 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-16 18:58:55.521457 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-16 18:58:55.548930 (MainThread): Partial parsing not enabled
2020-07-16 18:58:55.591897 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-16 18:58:55.592073 (MainThread): Opening a new connection, currently in state init
2020-07-16 18:58:55.628950 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 18:58:55.629117 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:58:55.643339 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-16 18:58:55.643492 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:58:55.657496 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-16 18:58:55.657649 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:58:55.719019 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-16 18:58:55.719198 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:58:56.149949 (MainThread): Found 4 models, 9 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 2 seed files, 2 sources
2020-07-16 18:58:56.151068 (MainThread): 
2020-07-16 18:58:56.151494 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 18:58:56.151601 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:58:56.155795 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-16 18:58:56.156079 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-16 18:58:56.159167 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-16 18:59:01.224718 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-16 18:59:01.225063 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-16 18:59:01.225330 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 18:59:01.435471 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 18:59:01.435830 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:59:01.436323 (MainThread): 14:59:01 | Concurrency: 1 threads (target='dev')
2020-07-16 18:59:01.436502 (MainThread): 14:59:01 | 
2020-07-16 18:59:01.439325 (Thread-1): Began running node model.springml_demo_dbt_project.gender_count
2020-07-16 18:59:01.440999 (Thread-1): 14:59:01 | 1 of 2 START incremental model springml_demo_dataset.gender_count.... [RUN]
2020-07-16 18:59:01.441619 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 18:59:01.441814 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-16 18:59:01.441986 (Thread-1): Compiling model.springml_demo_dbt_project.gender_count
2020-07-16 18:59:01.464022 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 18:59:01.466489 (Thread-1): finished collecting timing info
2020-07-16 18:59:01.507534 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 18:59:01.693559 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 18:59:01.694088 (Thread-1): On model.springml_demo_dbt_project.gender_count: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.gender_count"} */

        
    

    

    merge into `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count` as DBT_INTERNAL_DEST
        using (
           SELECT 
CURRENT_DATE() as Ingestion_date, 
countif(ad.Gender is not null and ad.Gender="F" ) as Female_count,
countif(ad.Gender is not null and ad.Gender="M" ) as Male_count,
FROM `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data` as ad
         ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`Ingestion_date`, `Female_count`, `Male_count`)
    values
        (`Ingestion_date`, `Female_count`, `Male_count`)


  
2020-07-16 18:59:04.132092 (Thread-1): finished collecting timing info
2020-07-16 18:59:04.133176 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd67b5f52-cfe9-4927-aa64-1e177e9920ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11da32050>]}
2020-07-16 18:59:04.134549 (Thread-1): 14:59:04 | 1 of 2 OK created incremental model springml_demo_dataset.gender_count [MERGE (1) in 2.69s]
2020-07-16 18:59:04.134715 (Thread-1): Finished running node model.springml_demo_dbt_project.gender_count
2020-07-16 18:59:04.134916 (Thread-1): Began running node model.springml_demo_dbt_project.redact_fields
2020-07-16 18:59:04.136176 (Thread-1): 14:59:04 | 2 of 2 START incremental model springml_demo_dataset.redact_fields... [RUN]
2020-07-16 18:59:04.136566 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-16 18:59:04.136686 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.gender_count).
2020-07-16 18:59:04.136795 (Thread-1): Compiling model.springml_demo_dbt_project.redact_fields
2020-07-16 18:59:04.147866 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-16 18:59:04.148400 (Thread-1): finished collecting timing info
2020-07-16 18:59:04.153609 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 18:59:04.298829 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-16 18:59:04.299612 (Thread-1): On model.springml_demo_dbt_project.redact_fields: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.redact_fields"} */

        
    

    

    merge into `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields` as DBT_INTERNAL_DEST
        using (
           select
	Employee_no,
	'##ARCHIVED##' as Surname,
	'##ARCHIVED##'as Given_name,
	Gender,
	City,
	Age,
	Year_joined ,
	'##ARCHIVED##' as mcast(Phone_no, varchar(512)),
	'##ARCHIVED##' as mcast(Social_insurance_no, varchar(512))
from
	`prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`
         ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`Surname`, `Given_name`)
    values
        (`Surname`, `Given_name`)


  
2020-07-16 18:59:04.464628 (Thread-1): finished collecting timing info
2020-07-16 18:59:04.465441 (Thread-1): Database Error in model redact_fields (models/applicant/redact_fields.sql)
  Syntax error: Expected ")" but got "(" at [18:32]
  compiled SQL at target/run/springml_demo_dbt_project/models/applicant/redact_fields.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 84, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 225, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 352, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 127, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Expected ")" but got "(" at [18:32]

(job ID: 7a5b9e2a-df25-421b-9186-f8810ea9941c)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.redact_fields"} */
   2:
   3:        
   4:    
   5:
   6:    
   7:
   8:    merge into `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields` as DBT_INTERNAL_DEST
   9:        using (
  10:           select
  11:	Employee_no,
  12:	'##ARCHIVED##' as Surname,
  13:	'##ARCHIVED##'as Given_name,
  14:	Gender,
  15:	City,
  16:	Age,
  17:	Year_joined ,
  18:	'##ARCHIVED##' as mcast(Phone_no, varchar(512)),
  19:	'##ARCHIVED##' as mcast(Social_insurance_no, varchar(512))
  20:from
  21:	`prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`
  22:         ) as DBT_INTERNAL_SOURCE
  23:        on FALSE
  24:
  25:    
  26:
  27:    when not matched then insert
  28:        (`Surname`, `Given_name`)
  29:    values
  30:        (`Surname`, `Given_name`)
  31:
  32:
  33:  
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 156, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 234, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 227, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/Cellar/python/3.7.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 88, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 76, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model redact_fields (models/applicant/redact_fields.sql)
  Syntax error: Expected ")" but got "(" at [18:32]
  compiled SQL at target/run/springml_demo_dbt_project/models/applicant/redact_fields.sql
2020-07-16 18:59:04.524982 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd67b5f52-cfe9-4927-aa64-1e177e9920ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11db2fed0>]}
2020-07-16 18:59:04.527024 (Thread-1): 14:59:04 | 2 of 2 ERROR creating incremental model springml_demo_dataset.redact_fields [ERROR in 0.39s]
2020-07-16 18:59:04.527263 (Thread-1): Finished running node model.springml_demo_dbt_project.redact_fields
2020-07-16 18:59:04.545561 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 18:59:04.545814 (MainThread): Opening a new connection, currently in state closed
2020-07-16 18:59:04.546399 (MainThread): 14:59:04 | 
2020-07-16 18:59:04.546624 (MainThread): 14:59:04 | Finished running 2 incremental models in 8.40s.
2020-07-16 18:59:04.546840 (MainThread): Connection 'master' was properly closed.
2020-07-16 18:59:04.547095 (MainThread): Connection 'model.springml_demo_dbt_project.redact_fields' was left open.
2020-07-16 18:59:04.558127 (MainThread): 
2020-07-16 18:59:04.558607 (MainThread): Completed with 1 error and 0 warnings:
2020-07-16 18:59:04.558835 (MainThread): 
2020-07-16 18:59:04.559000 (MainThread): Database Error in model redact_fields (models/applicant/redact_fields.sql)
2020-07-16 18:59:04.559234 (MainThread):   Syntax error: Expected ")" but got "(" at [18:32]
2020-07-16 18:59:04.559451 (MainThread):   compiled SQL at target/run/springml_demo_dbt_project/models/applicant/redact_fields.sql
2020-07-16 18:59:04.559656 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2020-07-16 18:59:04.559978 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11da275d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11db47090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e40dc90>]}
2020-07-16 18:59:04.560245 (MainThread): Flushing usage events
2020-07-16 19:03:11.199303 (MainThread): Running with dbt=0.17.0
2020-07-16 19:03:12.550348 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['applicant'], partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-16 19:03:12.552134 (MainThread): Tracking: tracking
2020-07-16 19:03:12.575357 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140ddfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140e3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140e3910>]}
2020-07-16 19:03:12.604923 (MainThread): Partial parsing not enabled
2020-07-16 19:03:12.608064 (MainThread): Parsing macros/core.sql
2020-07-16 19:03:12.615958 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-16 19:03:12.627340 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-16 19:03:12.630103 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-16 19:03:12.656616 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-16 19:03:12.696569 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-16 19:03:12.729139 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-16 19:03:12.732009 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-16 19:03:12.741976 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-16 19:03:12.762064 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-16 19:03:12.772104 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-16 19:03:12.780783 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-16 19:03:12.788173 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-16 19:03:12.789855 (MainThread): Parsing macros/etc/query.sql
2020-07-16 19:03:12.792257 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-16 19:03:12.795011 (MainThread): Parsing macros/etc/datetime.sql
2020-07-16 19:03:12.811069 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-16 19:03:12.814661 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-16 19:03:12.817942 (MainThread): Parsing macros/adapters/common.sql
2020-07-16 19:03:12.879982 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-16 19:03:12.882571 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-16 19:03:12.884826 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-16 19:03:12.887726 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-16 19:03:12.891870 (MainThread): Parsing macros/etc.sql
2020-07-16 19:03:12.893900 (MainThread): Parsing macros/catalog.sql
2020-07-16 19:03:12.903445 (MainThread): Parsing macros/adapters.sql
2020-07-16 19:03:12.927408 (MainThread): Parsing macros/materializations/seed.sql
2020-07-16 19:03:12.931672 (MainThread): Parsing macros/materializations/view.sql
2020-07-16 19:03:12.935352 (MainThread): Parsing macros/materializations/table.sql
2020-07-16 19:03:12.950106 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-16 19:03:12.967414 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-16 19:03:12.994442 (MainThread): Partial parsing not enabled
2020-07-16 19:03:13.041364 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-16 19:03:13.041545 (MainThread): Opening a new connection, currently in state init
2020-07-16 19:03:13.088280 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 19:03:13.088430 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:03:13.103263 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-16 19:03:13.103439 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:03:13.118555 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-16 19:03:13.118777 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:03:13.190660 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-16 19:03:13.190859 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:03:13.638495 (MainThread): Found 4 models, 9 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 2 seed files, 2 sources
2020-07-16 19:03:13.639764 (MainThread): 
2020-07-16 19:03:13.640180 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 19:03:13.640300 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:03:13.644729 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-16 19:03:13.645009 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-16 19:03:13.648784 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-16 19:03:15.148356 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-16 19:03:15.148628 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-16 19:03:15.148785 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 19:03:15.289912 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 19:03:15.290073 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:03:15.290405 (MainThread): 15:03:15 | Concurrency: 1 threads (target='dev')
2020-07-16 19:03:15.290567 (MainThread): 15:03:15 | 
2020-07-16 19:03:15.294460 (Thread-1): Began running node model.springml_demo_dbt_project.gender_count
2020-07-16 19:03:15.296100 (Thread-1): 15:03:15 | 1 of 2 START incremental model springml_demo_dataset.gender_count.... [RUN]
2020-07-16 19:03:15.296626 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 19:03:15.296820 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-16 19:03:15.296952 (Thread-1): Compiling model.springml_demo_dbt_project.gender_count
2020-07-16 19:03:15.319489 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 19:03:15.320877 (Thread-1): finished collecting timing info
2020-07-16 19:03:15.362735 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 19:03:15.515741 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 19:03:15.516724 (Thread-1): On model.springml_demo_dbt_project.gender_count: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.gender_count"} */

        
    

    

    merge into `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count` as DBT_INTERNAL_DEST
        using (
           SELECT 
CURRENT_DATE() as Ingestion_date, 
countif(ad.Gender is not null and ad.Gender="F" ) as Female_count,
countif(ad.Gender is not null and ad.Gender="M" ) as Male_count,
FROM `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data` as ad
         ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`Ingestion_date`, `Female_count`, `Male_count`)
    values
        (`Ingestion_date`, `Female_count`, `Male_count`)


  
2020-07-16 19:03:17.988290 (Thread-1): finished collecting timing info
2020-07-16 19:03:17.989105 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '665808df-0110-43b0-8c66-6a61328276e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11434ded0>]}
2020-07-16 19:03:17.990262 (Thread-1): 15:03:17 | 1 of 2 OK created incremental model springml_demo_dataset.gender_count [MERGE (1) in 2.69s]
2020-07-16 19:03:17.990426 (Thread-1): Finished running node model.springml_demo_dbt_project.gender_count
2020-07-16 19:03:17.990692 (Thread-1): Began running node model.springml_demo_dbt_project.redact_fields
2020-07-16 19:03:17.991762 (Thread-1): 15:03:17 | 2 of 2 START incremental model springml_demo_dataset.redact_fields... [RUN]
2020-07-16 19:03:17.992191 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-16 19:03:17.992292 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.gender_count).
2020-07-16 19:03:17.992383 (Thread-1): Compiling model.springml_demo_dbt_project.redact_fields
2020-07-16 19:03:18.003671 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-16 19:03:18.004199 (Thread-1): finished collecting timing info
2020-07-16 19:03:18.009444 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 19:03:18.137019 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-16 19:03:18.137833 (Thread-1): On model.springml_demo_dbt_project.redact_fields: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.redact_fields"} */

        
    

    

    merge into `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields` as DBT_INTERNAL_DEST
        using (
           final as ( 
	select
		Employee_no,
		'##ARCHIVED##' as Surname,
		'##ARCHIVED##'as Given_name,
		Gender,
		City,
		Age,
		Year_joined,
		cast(Phone_no as varchar),
		cast(Social_insurance_no as varchar)
	from
		`prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`
)

select
		Employee_no,
		Surname,
		Given_name,
		Gender,
		City,
		Age,
		Year_joined,
		'##ARCHIVED##' as Phone_no,
		'##ARCHIVED##' as Social_insurance_no
	from
		final
         ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`Surname`, `Given_name`)
    values
        (`Surname`, `Given_name`)


  
2020-07-16 19:03:18.447463 (Thread-1): finished collecting timing info
2020-07-16 19:03:18.448170 (Thread-1): Database Error in model redact_fields (models/applicant/redact_fields.sql)
  Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "final" at [10:12]
  compiled SQL at target/run/springml_demo_dbt_project/models/applicant/redact_fields.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 84, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 225, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 352, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 127, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "final" at [10:12]

(job ID: bfc4ecd8-6d22-4f14-ae40-5f63f0357875)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.redact_fields"} */
   2:
   3:        
   4:    
   5:
   6:    
   7:
   8:    merge into `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields` as DBT_INTERNAL_DEST
   9:        using (
  10:           final as ( 
  11:	select
  12:		Employee_no,
  13:		'##ARCHIVED##' as Surname,
  14:		'##ARCHIVED##'as Given_name,
  15:		Gender,
  16:		City,
  17:		Age,
  18:		Year_joined,
  19:		cast(Phone_no as varchar),
  20:		cast(Social_insurance_no as varchar)
  21:	from
  22:		`prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`
  23:)
  24:
  25:select
  26:		Employee_no,
  27:		Surname,
  28:		Given_name,
  29:		Gender,
  30:		City,
  31:		Age,
  32:		Year_joined,
  33:		'##ARCHIVED##' as Phone_no,
  34:		'##ARCHIVED##' as Social_insurance_no
  35:	from
  36:		final
  37:         ) as DBT_INTERNAL_SOURCE
  38:        on FALSE
  39:
  40:    
  41:
  42:    when not matched then insert
  43:        (`Surname`, `Given_name`)
  44:    values
  45:        (`Surname`, `Given_name`)
  46:
  47:
  48:  
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 156, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 234, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 227, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/Cellar/python/3.7.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 88, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 76, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model redact_fields (models/applicant/redact_fields.sql)
  Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "final" at [10:12]
  compiled SQL at target/run/springml_demo_dbt_project/models/applicant/redact_fields.sql
2020-07-16 19:03:18.468475 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '665808df-0110-43b0-8c66-6a61328276e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11440ea90>]}
2020-07-16 19:03:18.469874 (Thread-1): 15:03:18 | 2 of 2 ERROR creating incremental model springml_demo_dataset.redact_fields [ERROR in 0.48s]
2020-07-16 19:03:18.470035 (Thread-1): Finished running node model.springml_demo_dbt_project.redact_fields
2020-07-16 19:03:18.518010 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 19:03:18.518213 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:03:18.518747 (MainThread): 15:03:18 | 
2020-07-16 19:03:18.518951 (MainThread): 15:03:18 | Finished running 2 incremental models in 4.88s.
2020-07-16 19:03:18.519131 (MainThread): Connection 'master' was properly closed.
2020-07-16 19:03:18.519278 (MainThread): Connection 'model.springml_demo_dbt_project.redact_fields' was left open.
2020-07-16 19:03:18.529862 (MainThread): 
2020-07-16 19:03:18.530157 (MainThread): Completed with 1 error and 0 warnings:
2020-07-16 19:03:18.530472 (MainThread): 
2020-07-16 19:03:18.530669 (MainThread): Database Error in model redact_fields (models/applicant/redact_fields.sql)
2020-07-16 19:03:18.530832 (MainThread):   Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "final" at [10:12]
2020-07-16 19:03:18.531033 (MainThread):   compiled SQL at target/run/springml_demo_dbt_project/models/applicant/redact_fields.sql
2020-07-16 19:03:18.531263 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2020-07-16 19:03:18.531739 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e599d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e46f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114515210>]}
2020-07-16 19:03:18.531988 (MainThread): Flushing usage events
2020-07-16 19:03:30.855018 (MainThread): Running with dbt=0.17.0
2020-07-16 19:03:31.270934 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['applicant'], partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-16 19:03:31.272145 (MainThread): Tracking: tracking
2020-07-16 19:03:31.285400 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d467450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d477d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d477b50>]}
2020-07-16 19:03:31.314676 (MainThread): Partial parsing not enabled
2020-07-16 19:03:31.317771 (MainThread): Parsing macros/core.sql
2020-07-16 19:03:31.326065 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-16 19:03:31.341342 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-16 19:03:31.345076 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-16 19:03:31.380581 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-16 19:03:31.434635 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-16 19:03:31.465942 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-16 19:03:31.468382 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-16 19:03:31.476688 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-16 19:03:31.495080 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-16 19:03:31.504263 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-16 19:03:31.512582 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-16 19:03:31.518860 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-16 19:03:31.520173 (MainThread): Parsing macros/etc/query.sql
2020-07-16 19:03:31.521654 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-16 19:03:31.523719 (MainThread): Parsing macros/etc/datetime.sql
2020-07-16 19:03:31.534965 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-16 19:03:31.537532 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-16 19:03:31.540080 (MainThread): Parsing macros/adapters/common.sql
2020-07-16 19:03:31.601061 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-16 19:03:31.602510 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-16 19:03:31.603595 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-16 19:03:31.604899 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-16 19:03:31.608016 (MainThread): Parsing macros/etc.sql
2020-07-16 19:03:31.608883 (MainThread): Parsing macros/catalog.sql
2020-07-16 19:03:31.616078 (MainThread): Parsing macros/adapters.sql
2020-07-16 19:03:31.635965 (MainThread): Parsing macros/materializations/seed.sql
2020-07-16 19:03:31.638394 (MainThread): Parsing macros/materializations/view.sql
2020-07-16 19:03:31.641039 (MainThread): Parsing macros/materializations/table.sql
2020-07-16 19:03:31.654156 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-16 19:03:31.670517 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-16 19:03:31.696111 (MainThread): Partial parsing not enabled
2020-07-16 19:03:31.737902 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-16 19:03:31.738054 (MainThread): Opening a new connection, currently in state init
2020-07-16 19:03:31.774301 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 19:03:31.774464 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:03:31.788017 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-16 19:03:31.788164 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:03:31.801458 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-16 19:03:31.801594 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:03:31.863028 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-16 19:03:31.863189 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:03:32.328083 (MainThread): Found 4 models, 9 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 2 seed files, 2 sources
2020-07-16 19:03:32.329210 (MainThread): 
2020-07-16 19:03:32.329653 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 19:03:32.329761 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:03:32.333383 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-16 19:03:32.333583 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-16 19:03:32.334670 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-16 19:03:33.356984 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-16 19:03:33.358693 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-16 19:03:33.359048 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 19:03:33.527435 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 19:03:33.527601 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:03:33.527923 (MainThread): 15:03:33 | Concurrency: 1 threads (target='dev')
2020-07-16 19:03:33.528082 (MainThread): 15:03:33 | 
2020-07-16 19:03:33.531702 (Thread-1): Began running node model.springml_demo_dbt_project.gender_count
2020-07-16 19:03:33.533009 (Thread-1): 15:03:33 | 1 of 2 START incremental model springml_demo_dataset.gender_count.... [RUN]
2020-07-16 19:03:33.533399 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 19:03:33.533507 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-16 19:03:33.533649 (Thread-1): Compiling model.springml_demo_dbt_project.gender_count
2020-07-16 19:03:33.555215 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 19:03:33.555724 (Thread-1): finished collecting timing info
2020-07-16 19:03:33.597824 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 19:03:33.777506 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 19:03:33.778087 (Thread-1): On model.springml_demo_dbt_project.gender_count: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.gender_count"} */

        
    

    

    merge into `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count` as DBT_INTERNAL_DEST
        using (
           SELECT 
CURRENT_DATE() as Ingestion_date, 
countif(ad.Gender is not null and ad.Gender="F" ) as Female_count,
countif(ad.Gender is not null and ad.Gender="M" ) as Male_count,
FROM `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data` as ad
         ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`Ingestion_date`, `Female_count`, `Male_count`)
    values
        (`Ingestion_date`, `Female_count`, `Male_count`)


  
2020-07-16 19:03:35.801408 (Thread-1): finished collecting timing info
2020-07-16 19:03:35.802226 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45f5249f-d7da-4390-9b59-a095dbcf418c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d87a3d0>]}
2020-07-16 19:03:35.803477 (Thread-1): 15:03:35 | 1 of 2 OK created incremental model springml_demo_dataset.gender_count [MERGE (1) in 2.27s]
2020-07-16 19:03:35.803643 (Thread-1): Finished running node model.springml_demo_dbt_project.gender_count
2020-07-16 19:03:35.804721 (Thread-1): Began running node model.springml_demo_dbt_project.redact_fields
2020-07-16 19:03:35.806076 (Thread-1): 15:03:35 | 2 of 2 START incremental model springml_demo_dataset.redact_fields... [RUN]
2020-07-16 19:03:35.807230 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-16 19:03:35.807665 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.gender_count).
2020-07-16 19:03:35.807862 (Thread-1): Compiling model.springml_demo_dbt_project.redact_fields
2020-07-16 19:03:35.819989 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-16 19:03:35.820547 (Thread-1): finished collecting timing info
2020-07-16 19:03:35.826178 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 19:03:35.962430 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-16 19:03:35.963092 (Thread-1): On model.springml_demo_dbt_project.redact_fields: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.redact_fields"} */

        
    

    

    merge into `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields` as DBT_INTERNAL_DEST
        using (
           with final as ( 
	select
		Employee_no,
		'##ARCHIVED##' as Surname,
		'##ARCHIVED##'as Given_name,
		Gender,
		City,
		Age,
		Year_joined,
		cast(Phone_no as varchar),
		cast(Social_insurance_no as varchar)
	from
		`prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`
)

select
		Employee_no,
		Surname,
		Given_name,
		Gender,
		City,
		Age,
		Year_joined,
		'##ARCHIVED##' as Phone_no,
		'##ARCHIVED##' as Social_insurance_no
	from
		final
         ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`Surname`, `Given_name`)
    values
        (`Surname`, `Given_name`)


  
2020-07-16 19:03:36.241649 (Thread-1): finished collecting timing info
2020-07-16 19:03:36.242633 (Thread-1): Database Error in model redact_fields (models/applicant/redact_fields.sql)
  Type not found: varchar at [19:34]
  compiled SQL at target/run/springml_demo_dbt_project/models/applicant/redact_fields.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 84, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 225, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 352, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 127, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Type not found: varchar at [19:34]

(job ID: 63dde5f9-bbfd-4313-9106-467772a98fd9)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.redact_fields"} */
   2:
   3:        
   4:    
   5:
   6:    
   7:
   8:    merge into `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields` as DBT_INTERNAL_DEST
   9:        using (
  10:           with final as ( 
  11:	select
  12:		Employee_no,
  13:		'##ARCHIVED##' as Surname,
  14:		'##ARCHIVED##'as Given_name,
  15:		Gender,
  16:		City,
  17:		Age,
  18:		Year_joined,
  19:		cast(Phone_no as varchar),
  20:		cast(Social_insurance_no as varchar)
  21:	from
  22:		`prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`
  23:)
  24:
  25:select
  26:		Employee_no,
  27:		Surname,
  28:		Given_name,
  29:		Gender,
  30:		City,
  31:		Age,
  32:		Year_joined,
  33:		'##ARCHIVED##' as Phone_no,
  34:		'##ARCHIVED##' as Social_insurance_no
  35:	from
  36:		final
  37:         ) as DBT_INTERNAL_SOURCE
  38:        on FALSE
  39:
  40:    
  41:
  42:    when not matched then insert
  43:        (`Surname`, `Given_name`)
  44:    values
  45:        (`Surname`, `Given_name`)
  46:
  47:
  48:  
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 156, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 234, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 227, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/Cellar/python/3.7.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 88, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 76, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model redact_fields (models/applicant/redact_fields.sql)
  Type not found: varchar at [19:34]
  compiled SQL at target/run/springml_demo_dbt_project/models/applicant/redact_fields.sql
2020-07-16 19:03:36.264851 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45f5249f-d7da-4390-9b59-a095dbcf418c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d9abc90>]}
2020-07-16 19:03:36.266457 (Thread-1): 15:03:36 | 2 of 2 ERROR creating incremental model springml_demo_dataset.redact_fields [ERROR in 0.46s]
2020-07-16 19:03:36.266651 (Thread-1): Finished running node model.springml_demo_dbt_project.redact_fields
2020-07-16 19:03:36.333856 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 19:03:36.334094 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:03:36.334583 (MainThread): 15:03:36 | 
2020-07-16 19:03:36.334809 (MainThread): 15:03:36 | Finished running 2 incremental models in 4.01s.
2020-07-16 19:03:36.335093 (MainThread): Connection 'master' was properly closed.
2020-07-16 19:03:36.335324 (MainThread): Connection 'model.springml_demo_dbt_project.redact_fields' was left open.
2020-07-16 19:03:36.345614 (MainThread): 
2020-07-16 19:03:36.345820 (MainThread): Completed with 1 error and 0 warnings:
2020-07-16 19:03:36.345965 (MainThread): 
2020-07-16 19:03:36.346128 (MainThread): Database Error in model redact_fields (models/applicant/redact_fields.sql)
2020-07-16 19:03:36.346295 (MainThread):   Type not found: varchar at [19:34]
2020-07-16 19:03:36.346418 (MainThread):   compiled SQL at target/run/springml_demo_dbt_project/models/applicant/redact_fields.sql
2020-07-16 19:03:36.346558 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2020-07-16 19:03:36.346852 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d488bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d9af850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e2b3e50>]}
2020-07-16 19:03:36.347128 (MainThread): Flushing usage events
2020-07-16 19:05:00.445879 (MainThread): Running with dbt=0.17.0
2020-07-16 19:05:01.994977 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['applicant'], partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-16 19:05:02.000663 (MainThread): Tracking: tracking
2020-07-16 19:05:02.032790 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11af377d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d18fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d18f950>]}
2020-07-16 19:05:02.059366 (MainThread): Partial parsing not enabled
2020-07-16 19:05:02.064713 (MainThread): Parsing macros/core.sql
2020-07-16 19:05:02.076455 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-16 19:05:02.089153 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-16 19:05:02.092153 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-16 19:05:02.131240 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-16 19:05:02.171924 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-16 19:05:02.199057 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-16 19:05:02.202506 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-16 19:05:02.212391 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-16 19:05:02.230298 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-16 19:05:02.239178 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-16 19:05:02.247769 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-16 19:05:02.254304 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-16 19:05:02.256000 (MainThread): Parsing macros/etc/query.sql
2020-07-16 19:05:02.258031 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-16 19:05:02.260766 (MainThread): Parsing macros/etc/datetime.sql
2020-07-16 19:05:02.276490 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-16 19:05:02.279520 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-16 19:05:02.283117 (MainThread): Parsing macros/adapters/common.sql
2020-07-16 19:05:02.345929 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-16 19:05:02.348342 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-16 19:05:02.350430 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-16 19:05:02.352629 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-16 19:05:02.356490 (MainThread): Parsing macros/etc.sql
2020-07-16 19:05:02.358117 (MainThread): Parsing macros/catalog.sql
2020-07-16 19:05:02.367703 (MainThread): Parsing macros/adapters.sql
2020-07-16 19:05:02.389285 (MainThread): Parsing macros/materializations/seed.sql
2020-07-16 19:05:02.392351 (MainThread): Parsing macros/materializations/view.sql
2020-07-16 19:05:02.395883 (MainThread): Parsing macros/materializations/table.sql
2020-07-16 19:05:02.412275 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-16 19:05:02.429515 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-16 19:05:02.456583 (MainThread): Partial parsing not enabled
2020-07-16 19:05:02.500459 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-16 19:05:02.500637 (MainThread): Opening a new connection, currently in state init
2020-07-16 19:05:02.536281 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 19:05:02.536434 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:05:02.550730 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-16 19:05:02.550883 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:05:02.564777 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-16 19:05:02.564932 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:05:02.628425 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-16 19:05:02.628599 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:05:03.136088 (MainThread): Found 4 models, 9 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 2 seed files, 2 sources
2020-07-16 19:05:03.137158 (MainThread): 
2020-07-16 19:05:03.137596 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 19:05:03.137718 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:05:03.141816 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-16 19:05:03.141959 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-16 19:05:03.143693 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-16 19:05:05.248595 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-16 19:05:05.248888 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-16 19:05:05.249075 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 19:05:05.398256 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 19:05:05.398447 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:05:05.398784 (MainThread): 15:05:05 | Concurrency: 1 threads (target='dev')
2020-07-16 19:05:05.398946 (MainThread): 15:05:05 | 
2020-07-16 19:05:05.406600 (Thread-1): Began running node model.springml_demo_dbt_project.gender_count
2020-07-16 19:05:05.409186 (Thread-1): 15:05:05 | 1 of 2 START incremental model springml_demo_dataset.gender_count.... [RUN]
2020-07-16 19:05:05.409957 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 19:05:05.410096 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-16 19:05:05.410315 (Thread-1): Compiling model.springml_demo_dbt_project.gender_count
2020-07-16 19:05:05.438284 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 19:05:05.438815 (Thread-1): finished collecting timing info
2020-07-16 19:05:05.479837 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 19:05:05.698194 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 19:05:05.698893 (Thread-1): On model.springml_demo_dbt_project.gender_count: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.gender_count"} */

        
    

    

    merge into `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count` as DBT_INTERNAL_DEST
        using (
           SELECT 
CURRENT_DATE() as Ingestion_date, 
countif(ad.Gender is not null and ad.Gender="F" ) as Female_count,
countif(ad.Gender is not null and ad.Gender="M" ) as Male_count,
FROM `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data` as ad
         ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`Ingestion_date`, `Female_count`, `Male_count`)
    values
        (`Ingestion_date`, `Female_count`, `Male_count`)


  
2020-07-16 19:05:08.271014 (Thread-1): finished collecting timing info
2020-07-16 19:05:08.271919 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da0b97cd-1b41-4a23-b041-84a27b348385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d3f9c90>]}
2020-07-16 19:05:08.273290 (Thread-1): 15:05:08 | 1 of 2 OK created incremental model springml_demo_dataset.gender_count [MERGE (1) in 2.86s]
2020-07-16 19:05:08.273491 (Thread-1): Finished running node model.springml_demo_dbt_project.gender_count
2020-07-16 19:05:08.273668 (Thread-1): Began running node model.springml_demo_dbt_project.redact_fields
2020-07-16 19:05:08.274960 (Thread-1): 15:05:08 | 2 of 2 START incremental model springml_demo_dataset.redact_fields... [RUN]
2020-07-16 19:05:08.275360 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-16 19:05:08.275468 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.gender_count).
2020-07-16 19:05:08.275576 (Thread-1): Compiling model.springml_demo_dbt_project.redact_fields
2020-07-16 19:05:08.286937 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-16 19:05:08.287513 (Thread-1): finished collecting timing info
2020-07-16 19:05:08.292867 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 19:05:08.604174 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-16 19:05:08.604965 (Thread-1): On model.springml_demo_dbt_project.redact_fields: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.redact_fields"} */

        
    

    

    merge into `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields` as DBT_INTERNAL_DEST
        using (
           with final as ( 
	select
		Employee_no,
		'##ARCHIVED##' as Surname,
		'##ARCHIVED##'as Given_name,
		Gender,
		City,
		Age,
		Year_joined,
		mcast(Phone_no, varchar(512)),
		mcast(Social_insurance_no, varchar(512))
	from
		`prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`
)

select
		Employee_no,
		Surname,
		Given_name,
		Gender,
		City,
		Age,
		Year_joined,
		'##ARCHIVED##' as Phone_no,
		'##ARCHIVED##' as Social_insurance_no
	from
		final
         ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`Surname`, `Given_name`)
    values
        (`Surname`, `Given_name`)


  
2020-07-16 19:05:08.980453 (Thread-1): finished collecting timing info
2020-07-16 19:05:08.981273 (Thread-1): Database Error in model redact_fields (models/applicant/redact_fields.sql)
  Function not found: mcast; Did you mean least? at [19:17]
  compiled SQL at target/run/springml_demo_dbt_project/models/applicant/redact_fields.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 84, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 225, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 352, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 127, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Function not found: mcast; Did you mean least? at [19:17]

(job ID: 6991cb42-2f11-4890-aa48-568f5be0e629)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.redact_fields"} */
   2:
   3:        
   4:    
   5:
   6:    
   7:
   8:    merge into `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields` as DBT_INTERNAL_DEST
   9:        using (
  10:           with final as ( 
  11:	select
  12:		Employee_no,
  13:		'##ARCHIVED##' as Surname,
  14:		'##ARCHIVED##'as Given_name,
  15:		Gender,
  16:		City,
  17:		Age,
  18:		Year_joined,
  19:		mcast(Phone_no, varchar(512)),
  20:		mcast(Social_insurance_no, varchar(512))
  21:	from
  22:		`prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`
  23:)
  24:
  25:select
  26:		Employee_no,
  27:		Surname,
  28:		Given_name,
  29:		Gender,
  30:		City,
  31:		Age,
  32:		Year_joined,
  33:		'##ARCHIVED##' as Phone_no,
  34:		'##ARCHIVED##' as Social_insurance_no
  35:	from
  36:		final
  37:         ) as DBT_INTERNAL_SOURCE
  38:        on FALSE
  39:
  40:    
  41:
  42:    when not matched then insert
  43:        (`Surname`, `Given_name`)
  44:    values
  45:        (`Surname`, `Given_name`)
  46:
  47:
  48:  
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 156, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 234, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 227, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/Cellar/python/3.7.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 88, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 76, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model redact_fields (models/applicant/redact_fields.sql)
  Function not found: mcast; Did you mean least? at [19:17]
  compiled SQL at target/run/springml_demo_dbt_project/models/applicant/redact_fields.sql
2020-07-16 19:05:09.005034 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da0b97cd-1b41-4a23-b041-84a27b348385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d6bc0d0>]}
2020-07-16 19:05:09.006874 (Thread-1): 15:05:09 | 2 of 2 ERROR creating incremental model springml_demo_dataset.redact_fields [ERROR in 0.73s]
2020-07-16 19:05:09.007067 (Thread-1): Finished running node model.springml_demo_dbt_project.redact_fields
2020-07-16 19:05:09.031322 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 19:05:09.031576 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:05:09.032093 (MainThread): 15:05:09 | 
2020-07-16 19:05:09.032310 (MainThread): 15:05:09 | Finished running 2 incremental models in 5.89s.
2020-07-16 19:05:09.032597 (MainThread): Connection 'master' was properly closed.
2020-07-16 19:05:09.032796 (MainThread): Connection 'model.springml_demo_dbt_project.redact_fields' was left open.
2020-07-16 19:05:09.048581 (MainThread): 
2020-07-16 19:05:09.049115 (MainThread): Completed with 1 error and 0 warnings:
2020-07-16 19:05:09.049351 (MainThread): 
2020-07-16 19:05:09.049541 (MainThread): Database Error in model redact_fields (models/applicant/redact_fields.sql)
2020-07-16 19:05:09.049708 (MainThread):   Function not found: mcast; Did you mean least? at [19:17]
2020-07-16 19:05:09.049889 (MainThread):   compiled SQL at target/run/springml_demo_dbt_project/models/applicant/redact_fields.sql
2020-07-16 19:05:09.050027 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2020-07-16 19:05:09.050288 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d6efed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d7584d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d6ba6d0>]}
2020-07-16 19:05:09.050524 (MainThread): Flushing usage events
2020-07-16 19:08:54.426730 (MainThread): Running with dbt=0.17.0
2020-07-16 19:08:56.047829 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['applicant'], partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-16 19:08:56.050600 (MainThread): Tracking: tracking
2020-07-16 19:08:56.075362 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ee36d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f30b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c40c50>]}
2020-07-16 19:08:56.107840 (MainThread): Partial parsing not enabled
2020-07-16 19:08:56.110949 (MainThread): Parsing macros/core.sql
2020-07-16 19:08:56.117999 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-16 19:08:56.129036 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-16 19:08:56.132214 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-16 19:08:56.158884 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-16 19:08:56.212895 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-16 19:08:56.239645 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-16 19:08:56.242986 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-16 19:08:56.251639 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-16 19:08:56.269677 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-16 19:08:56.279254 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-16 19:08:56.289825 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-16 19:08:56.296810 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-16 19:08:56.298462 (MainThread): Parsing macros/etc/query.sql
2020-07-16 19:08:56.300321 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-16 19:08:56.303075 (MainThread): Parsing macros/etc/datetime.sql
2020-07-16 19:08:56.315287 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-16 19:08:56.318412 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-16 19:08:56.321267 (MainThread): Parsing macros/adapters/common.sql
2020-07-16 19:08:56.383529 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-16 19:08:56.385842 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-16 19:08:56.387580 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-16 19:08:56.389850 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-16 19:08:56.393822 (MainThread): Parsing macros/etc.sql
2020-07-16 19:08:56.395710 (MainThread): Parsing macros/catalog.sql
2020-07-16 19:08:56.405799 (MainThread): Parsing macros/adapters.sql
2020-07-16 19:08:56.427856 (MainThread): Parsing macros/materializations/seed.sql
2020-07-16 19:08:56.431354 (MainThread): Parsing macros/materializations/view.sql
2020-07-16 19:08:56.434914 (MainThread): Parsing macros/materializations/table.sql
2020-07-16 19:08:56.449617 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-16 19:08:56.466820 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-16 19:08:56.492940 (MainThread): Partial parsing not enabled
2020-07-16 19:08:56.539734 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-16 19:08:56.539911 (MainThread): Opening a new connection, currently in state init
2020-07-16 19:08:56.575325 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 19:08:56.575481 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:08:56.589771 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-16 19:08:56.589927 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:08:56.604968 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-16 19:08:56.605119 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:08:56.670483 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-16 19:08:56.670663 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:08:57.129444 (MainThread): Found 4 models, 9 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 2 seed files, 2 sources
2020-07-16 19:08:57.130597 (MainThread): 
2020-07-16 19:08:57.130982 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 19:08:57.131077 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:08:57.135410 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-16 19:08:57.135692 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-16 19:08:57.138694 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-16 19:08:59.609803 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-16 19:08:59.610102 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-16 19:08:59.610268 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 19:08:59.749614 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 19:08:59.749793 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:08:59.750135 (MainThread): 15:08:59 | Concurrency: 1 threads (target='dev')
2020-07-16 19:08:59.750399 (MainThread): 15:08:59 | 
2020-07-16 19:08:59.752996 (Thread-1): Began running node model.springml_demo_dbt_project.gender_count
2020-07-16 19:08:59.754302 (Thread-1): 15:08:59 | 1 of 2 START incremental model springml_demo_dataset.gender_count.... [RUN]
2020-07-16 19:08:59.754832 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 19:08:59.755012 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-16 19:08:59.755190 (Thread-1): Compiling model.springml_demo_dbt_project.gender_count
2020-07-16 19:08:59.777233 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 19:08:59.777731 (Thread-1): finished collecting timing info
2020-07-16 19:08:59.827291 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 19:08:59.994720 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 19:08:59.995307 (Thread-1): On model.springml_demo_dbt_project.gender_count: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.gender_count"} */

        
    

    

    merge into `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count` as DBT_INTERNAL_DEST
        using (
           SELECT 
CURRENT_DATE() as Ingestion_date, 
countif(ad.Gender is not null and ad.Gender="F" ) as Female_count,
countif(ad.Gender is not null and ad.Gender="M" ) as Male_count,
FROM `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data` as ad
         ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`Ingestion_date`, `Female_count`, `Male_count`)
    values
        (`Ingestion_date`, `Female_count`, `Male_count`)


  
2020-07-16 19:09:01.781791 (Thread-1): finished collecting timing info
2020-07-16 19:09:01.782664 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7d1f6a1-7f2b-4f07-a1ae-30caee08747a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11119b110>]}
2020-07-16 19:09:01.784081 (Thread-1): 15:09:01 | 1 of 2 OK created incremental model springml_demo_dataset.gender_count [MERGE (1) in 2.03s]
2020-07-16 19:09:01.784256 (Thread-1): Finished running node model.springml_demo_dbt_project.gender_count
2020-07-16 19:09:01.784484 (Thread-1): Began running node model.springml_demo_dbt_project.redact_fields
2020-07-16 19:09:01.785764 (Thread-1): 15:09:01 | 2 of 2 START incremental model springml_demo_dataset.redact_fields... [RUN]
2020-07-16 19:09:01.786129 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-16 19:09:01.786227 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.gender_count).
2020-07-16 19:09:01.786317 (Thread-1): Compiling model.springml_demo_dbt_project.redact_fields
2020-07-16 19:09:01.797648 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-16 19:09:01.799828 (Thread-1): finished collecting timing info
2020-07-16 19:09:01.806523 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 19:09:01.942587 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-16 19:09:01.943251 (Thread-1): On model.springml_demo_dbt_project.redact_fields: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.redact_fields"} */

        
    

    

    merge into `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields` as DBT_INTERNAL_DEST
        using (
           with final as ( 
	select
		Employee_no,
		'##ARCHIVED##' as Surname,
		'##ARCHIVED##'as Given_name,
		Gender,
		City,
		Age,
		Year_joined,
		cast(Phone_no as varchar(512)),
		cast(Social_insurance_no as varchar(512))
	from
		`prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`
)

select
		Employee_no,
		Surname,
		Given_name,
		Gender,
		City,
		Age,
		Year_joined,
		'##ARCHIVED##' as Phone_no,
		'##ARCHIVED##' as Social_insurance_no
	from
		final
         ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`Surname`, `Given_name`)
    values
        (`Surname`, `Given_name`)


  
2020-07-16 19:09:02.112939 (Thread-1): finished collecting timing info
2020-07-16 19:09:02.114035 (Thread-1): Database Error in model redact_fields (models/applicant/redact_fields.sql)
  Syntax error: Expected ")" but got "(" at [19:41]
  compiled SQL at target/run/springml_demo_dbt_project/models/applicant/redact_fields.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 84, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 225, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 352, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 127, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Expected ")" but got "(" at [19:41]

(job ID: c5235e60-c765-452f-850a-bb2b08f12a03)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.redact_fields"} */
   2:
   3:        
   4:    
   5:
   6:    
   7:
   8:    merge into `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields` as DBT_INTERNAL_DEST
   9:        using (
  10:           with final as ( 
  11:	select
  12:		Employee_no,
  13:		'##ARCHIVED##' as Surname,
  14:		'##ARCHIVED##'as Given_name,
  15:		Gender,
  16:		City,
  17:		Age,
  18:		Year_joined,
  19:		cast(Phone_no as varchar(512)),
  20:		cast(Social_insurance_no as varchar(512))
  21:	from
  22:		`prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`
  23:)
  24:
  25:select
  26:		Employee_no,
  27:		Surname,
  28:		Given_name,
  29:		Gender,
  30:		City,
  31:		Age,
  32:		Year_joined,
  33:		'##ARCHIVED##' as Phone_no,
  34:		'##ARCHIVED##' as Social_insurance_no
  35:	from
  36:		final
  37:         ) as DBT_INTERNAL_SOURCE
  38:        on FALSE
  39:
  40:    
  41:
  42:    when not matched then insert
  43:        (`Surname`, `Given_name`)
  44:    values
  45:        (`Surname`, `Given_name`)
  46:
  47:
  48:  
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 156, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 234, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 227, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/Cellar/python/3.7.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 88, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 76, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model redact_fields (models/applicant/redact_fields.sql)
  Syntax error: Expected ")" but got "(" at [19:41]
  compiled SQL at target/run/springml_demo_dbt_project/models/applicant/redact_fields.sql
2020-07-16 19:09:02.138960 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7d1f6a1-7f2b-4f07-a1ae-30caee08747a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cad990>]}
2020-07-16 19:09:02.140863 (Thread-1): 15:09:02 | 2 of 2 ERROR creating incremental model springml_demo_dataset.redact_fields [ERROR in 0.35s]
2020-07-16 19:09:02.141082 (Thread-1): Finished running node model.springml_demo_dbt_project.redact_fields
2020-07-16 19:09:02.243852 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 19:09:02.244099 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:09:02.244740 (MainThread): 15:09:02 | 
2020-07-16 19:09:02.245025 (MainThread): 15:09:02 | Finished running 2 incremental models in 5.11s.
2020-07-16 19:09:02.245310 (MainThread): Connection 'master' was properly closed.
2020-07-16 19:09:02.245482 (MainThread): Connection 'model.springml_demo_dbt_project.redact_fields' was left open.
2020-07-16 19:09:02.261524 (MainThread): 
2020-07-16 19:09:02.261810 (MainThread): Completed with 1 error and 0 warnings:
2020-07-16 19:09:02.262190 (MainThread): 
2020-07-16 19:09:02.262496 (MainThread): Database Error in model redact_fields (models/applicant/redact_fields.sql)
2020-07-16 19:09:02.262680 (MainThread):   Syntax error: Expected ")" but got "(" at [19:41]
2020-07-16 19:09:02.262870 (MainThread):   compiled SQL at target/run/springml_demo_dbt_project/models/applicant/redact_fields.sql
2020-07-16 19:09:02.263061 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2020-07-16 19:09:02.263381 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cbc290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c75ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c73fd0>]}
2020-07-16 19:09:02.263608 (MainThread): Flushing usage events
2020-07-16 19:14:23.882491 (MainThread): Running with dbt=0.17.0
2020-07-16 19:14:25.904143 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['applicant'], partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-16 19:14:25.905693 (MainThread): Tracking: tracking
2020-07-16 19:14:25.931947 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a7a490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a7fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a7f990>]}
2020-07-16 19:14:25.961954 (MainThread): Partial parsing not enabled
2020-07-16 19:14:25.965216 (MainThread): Parsing macros/core.sql
2020-07-16 19:14:25.972876 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-16 19:14:25.983188 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-16 19:14:25.986267 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-16 19:14:26.009352 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-16 19:14:26.046335 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-16 19:14:26.073516 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-16 19:14:26.076826 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-16 19:14:26.085895 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-16 19:14:26.103407 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-16 19:14:26.112708 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-16 19:14:26.122435 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-16 19:14:26.131161 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-16 19:14:26.133821 (MainThread): Parsing macros/etc/query.sql
2020-07-16 19:14:26.136283 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-16 19:14:26.138925 (MainThread): Parsing macros/etc/datetime.sql
2020-07-16 19:14:26.150605 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-16 19:14:26.153597 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-16 19:14:26.156012 (MainThread): Parsing macros/adapters/common.sql
2020-07-16 19:14:26.219196 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-16 19:14:26.221732 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-16 19:14:26.224076 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-16 19:14:26.226717 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-16 19:14:26.230517 (MainThread): Parsing macros/etc.sql
2020-07-16 19:14:26.231766 (MainThread): Parsing macros/catalog.sql
2020-07-16 19:14:26.239629 (MainThread): Parsing macros/adapters.sql
2020-07-16 19:14:26.263687 (MainThread): Parsing macros/materializations/seed.sql
2020-07-16 19:14:26.267267 (MainThread): Parsing macros/materializations/view.sql
2020-07-16 19:14:26.270886 (MainThread): Parsing macros/materializations/table.sql
2020-07-16 19:14:26.287801 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-16 19:14:26.308062 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-16 19:14:26.337527 (MainThread): Partial parsing not enabled
2020-07-16 19:14:26.387838 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-16 19:14:26.388000 (MainThread): Opening a new connection, currently in state init
2020-07-16 19:14:26.428525 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 19:14:26.428683 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:14:26.444903 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-16 19:14:26.445059 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:14:26.461577 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-16 19:14:26.461732 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:14:26.530853 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-16 19:14:26.531011 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:14:27.038901 (MainThread): Found 4 models, 9 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 2 seed files, 2 sources
2020-07-16 19:14:27.039956 (MainThread): 
2020-07-16 19:14:27.040385 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 19:14:27.040491 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:14:27.045594 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-16 19:14:27.045753 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-16 19:14:27.049365 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-16 19:14:29.172701 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-16 19:14:29.173056 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-16 19:14:29.173374 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 19:14:29.354713 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 19:14:29.354902 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:14:29.355203 (MainThread): 15:14:29 | Concurrency: 1 threads (target='dev')
2020-07-16 19:14:29.355352 (MainThread): 15:14:29 | 
2020-07-16 19:14:29.358299 (Thread-1): Began running node model.springml_demo_dbt_project.gender_count
2020-07-16 19:14:29.359636 (Thread-1): 15:14:29 | 1 of 2 START incremental model springml_demo_dataset.gender_count.... [RUN]
2020-07-16 19:14:29.360059 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 19:14:29.360174 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-16 19:14:29.360300 (Thread-1): Compiling model.springml_demo_dbt_project.gender_count
2020-07-16 19:14:29.381769 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 19:14:29.382287 (Thread-1): finished collecting timing info
2020-07-16 19:14:29.422311 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 19:14:29.577127 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 19:14:29.577647 (Thread-1): On model.springml_demo_dbt_project.gender_count: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.gender_count"} */

        
    

    

    merge into `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count` as DBT_INTERNAL_DEST
        using (
           SELECT 
CURRENT_DATE() as Ingestion_date, 
countif(ad.Gender is not null and ad.Gender="F" ) as Female_count,
countif(ad.Gender is not null and ad.Gender="M" ) as Male_count,
FROM `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data` as ad
         ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`Ingestion_date`, `Female_count`, `Male_count`)
    values
        (`Ingestion_date`, `Female_count`, `Male_count`)


  
2020-07-16 19:14:31.464557 (Thread-1): finished collecting timing info
2020-07-16 19:14:31.465300 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '356f063e-3236-4b90-bdab-64a39e0b87cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ead1d0>]}
2020-07-16 19:14:31.468822 (Thread-1): 15:14:31 | 1 of 2 OK created incremental model springml_demo_dataset.gender_count [MERGE (1) in 2.11s]
2020-07-16 19:14:31.469451 (Thread-1): Finished running node model.springml_demo_dbt_project.gender_count
2020-07-16 19:14:31.469779 (Thread-1): Began running node model.springml_demo_dbt_project.redact_fields
2020-07-16 19:14:31.471330 (Thread-1): 15:14:31 | 2 of 2 START incremental model springml_demo_dataset.redact_fields... [RUN]
2020-07-16 19:14:31.471838 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-16 19:14:31.471950 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.gender_count).
2020-07-16 19:14:31.472042 (Thread-1): Compiling model.springml_demo_dbt_project.redact_fields
2020-07-16 19:14:31.486883 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-16 19:14:31.487460 (Thread-1): finished collecting timing info
2020-07-16 19:14:31.493621 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 19:14:31.736349 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-16 19:14:31.737399 (Thread-1): On model.springml_demo_dbt_project.redact_fields: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.redact_fields"} */

        
    

    

    merge into `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields` as DBT_INTERNAL_DEST
        using (
           with final as ( 
	select
		Employee_no,
		'##ARCHIVED##' as Surname,
		'##ARCHIVED##'as Given_name,
		Gender,
		City,
		Age,
		Year_joined,
		cast(Phone_no as string),
		cast(Social_insurance_no as string)
	from
		`prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`
)

select
		Employee_no,
		Surname,
		Given_name,
		Gender,
		City,
		Age,
		Year_joined,
		'##ARCHIVED##' as Phone_no,
		'##ARCHIVED##' as Social_insurance_no
	from
		final
         ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`Surname`, `Given_name`)
    values
        (`Surname`, `Given_name`)


  
2020-07-16 19:14:33.498440 (Thread-1): finished collecting timing info
2020-07-16 19:14:33.499304 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '356f063e-3236-4b90-bdab-64a39e0b87cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fe6a10>]}
2020-07-16 19:14:33.500536 (Thread-1): 15:14:33 | 2 of 2 OK created incremental model springml_demo_dataset.redact_fields [MERGE (8336) in 2.03s]
2020-07-16 19:14:33.500726 (Thread-1): Finished running node model.springml_demo_dbt_project.redact_fields
2020-07-16 19:14:33.523935 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 19:14:33.524301 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:14:33.525027 (MainThread): 15:14:33 | 
2020-07-16 19:14:33.525211 (MainThread): 15:14:33 | Finished running 2 incremental models in 6.48s.
2020-07-16 19:14:33.525469 (MainThread): Connection 'master' was properly closed.
2020-07-16 19:14:33.525649 (MainThread): Connection 'model.springml_demo_dbt_project.redact_fields' was left open.
2020-07-16 19:14:33.534568 (MainThread): 
2020-07-16 19:14:33.534909 (MainThread): Completed successfully
2020-07-16 19:14:33.535107 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-07-16 19:14:33.535458 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11181e650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f9e250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111804ad0>]}
2020-07-16 19:14:33.535918 (MainThread): Flushing usage events
2020-07-16 19:15:47.044926 (MainThread): Running with dbt=0.17.0
2020-07-16 19:15:48.573699 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['applicant'], partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-16 19:15:48.576354 (MainThread): Tracking: tracking
2020-07-16 19:15:48.602349 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dbe0490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dc27c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dc27a90>]}
2020-07-16 19:15:48.635677 (MainThread): Partial parsing not enabled
2020-07-16 19:15:48.638698 (MainThread): Parsing macros/core.sql
2020-07-16 19:15:48.645811 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-16 19:15:48.661126 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-16 19:15:48.664478 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-16 19:15:48.691001 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-16 19:15:48.731587 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-16 19:15:48.760622 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-16 19:15:48.764164 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-16 19:15:48.774684 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-16 19:15:48.795042 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-16 19:15:48.824419 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-16 19:15:48.834110 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-16 19:15:48.841668 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-16 19:15:48.843792 (MainThread): Parsing macros/etc/query.sql
2020-07-16 19:15:48.846009 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-16 19:15:48.848367 (MainThread): Parsing macros/etc/datetime.sql
2020-07-16 19:15:48.862346 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-16 19:15:48.865670 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-16 19:15:48.871137 (MainThread): Parsing macros/adapters/common.sql
2020-07-16 19:15:48.953027 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-16 19:15:48.955168 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-16 19:15:48.956938 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-16 19:15:48.959451 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-16 19:15:48.962752 (MainThread): Parsing macros/etc.sql
2020-07-16 19:15:48.964107 (MainThread): Parsing macros/catalog.sql
2020-07-16 19:15:48.972588 (MainThread): Parsing macros/adapters.sql
2020-07-16 19:15:48.995391 (MainThread): Parsing macros/materializations/seed.sql
2020-07-16 19:15:48.998251 (MainThread): Parsing macros/materializations/view.sql
2020-07-16 19:15:49.001736 (MainThread): Parsing macros/materializations/table.sql
2020-07-16 19:15:49.015140 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-16 19:15:49.031887 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-16 19:15:49.060262 (MainThread): Partial parsing not enabled
2020-07-16 19:15:49.104655 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-16 19:15:49.104831 (MainThread): Opening a new connection, currently in state init
2020-07-16 19:15:49.142565 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 19:15:49.142767 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:15:49.159340 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-16 19:15:49.159509 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:15:49.174584 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-16 19:15:49.174741 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:15:49.238112 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-16 19:15:49.238292 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:15:49.678098 (MainThread): Found 4 models, 9 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 2 seed files, 2 sources
2020-07-16 19:15:49.679497 (MainThread): 
2020-07-16 19:15:49.679970 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 19:15:49.680084 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:15:49.684134 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-16 19:15:49.684387 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-16 19:15:49.688500 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-16 19:15:52.133053 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-16 19:15:52.133407 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-16 19:15:52.133644 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 19:15:52.299461 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 19:15:52.299638 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:15:52.299986 (MainThread): 15:15:52 | Concurrency: 1 threads (target='dev')
2020-07-16 19:15:52.300192 (MainThread): 15:15:52 | 
2020-07-16 19:15:52.310968 (Thread-1): Began running node model.springml_demo_dbt_project.gender_count
2020-07-16 19:15:52.312703 (Thread-1): 15:15:52 | 1 of 2 START view model springml_demo_dataset.gender_count........... [RUN]
2020-07-16 19:15:52.313096 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 19:15:52.313192 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-16 19:15:52.313310 (Thread-1): Compiling model.springml_demo_dbt_project.gender_count
2020-07-16 19:15:52.355697 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 19:15:52.356227 (Thread-1): finished collecting timing info
2020-07-16 19:15:52.415553 (Thread-1): finished collecting timing info
2020-07-16 19:15:52.416110 (Thread-1): Compilation Error in model gender_count (models/applicant/gender_count.sql)
  Trying to create view `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count`, but it currently exists as a table. Either drop `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro adapter_macro (macros/adapters/common.sql)
  > called by macro handle_existing_table (macros/materializations/view/create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros/materializations/view/create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model gender_count (models/applicant/gender_count.sql)
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 50, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 96, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 29, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/exceptions.py", line 966, in inner
    raise exc
  File "/usr/local/lib/python3.7/site-packages/dbt/exceptions.py", line 963, in inner
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/exceptions.py", line 634, in relation_wrong_type
    model)
  File "/usr/local/lib/python3.7/site-packages/dbt/exceptions.py", line 392, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model gender_count (models/applicant/gender_count.sql)
  Trying to create view `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count`, but it currently exists as a table. Either drop `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro adapter_macro (macros/adapters/common.sql)
  > called by macro handle_existing_table (macros/materializations/view/create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros/materializations/view/create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model gender_count (models/applicant/gender_count.sql)
2020-07-16 19:15:52.510646 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaac1795-aaa6-42fa-8a36-50faf159e538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e036990>]}
2020-07-16 19:15:52.512794 (Thread-1): 15:15:52 | 1 of 2 ERROR creating view model springml_demo_dataset.gender_count.. [ERROR in 0.20s]
2020-07-16 19:15:52.513026 (Thread-1): Finished running node model.springml_demo_dbt_project.gender_count
2020-07-16 19:15:52.513365 (Thread-1): Began running node model.springml_demo_dbt_project.redact_fields
2020-07-16 19:15:52.515167 (Thread-1): 15:15:52 | 2 of 2 START view model springml_demo_dataset.redact_fields.......... [RUN]
2020-07-16 19:15:52.516102 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-16 19:15:52.516316 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.gender_count).
2020-07-16 19:15:52.516469 (Thread-1): Compiling model.springml_demo_dbt_project.redact_fields
2020-07-16 19:15:52.555025 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-16 19:15:52.555847 (Thread-1): finished collecting timing info
2020-07-16 19:15:52.563584 (Thread-1): finished collecting timing info
2020-07-16 19:15:52.564357 (Thread-1): Compilation Error in model redact_fields (models/applicant/redact_fields.sql)
  Trying to create view `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields`, but it currently exists as a table. Either drop `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro adapter_macro (macros/adapters/common.sql)
  > called by macro handle_existing_table (macros/materializations/view/create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros/materializations/view/create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model redact_fields (models/applicant/redact_fields.sql)
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 50, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 96, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 29, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/exceptions.py", line 966, in inner
    raise exc
  File "/usr/local/lib/python3.7/site-packages/dbt/exceptions.py", line 963, in inner
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/exceptions.py", line 634, in relation_wrong_type
    model)
  File "/usr/local/lib/python3.7/site-packages/dbt/exceptions.py", line 392, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model redact_fields (models/applicant/redact_fields.sql)
  Trying to create view `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields`, but it currently exists as a table. Either drop `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro adapter_macro (macros/adapters/common.sql)
  > called by macro handle_existing_table (macros/materializations/view/create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros/materializations/view/create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model redact_fields (models/applicant/redact_fields.sql)
2020-07-16 19:15:52.568242 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaac1795-aaa6-42fa-8a36-50faf159e538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11de8c510>]}
2020-07-16 19:15:52.573210 (Thread-1): 15:15:52 | 2 of 2 ERROR creating view model springml_demo_dataset.redact_fields. [ERROR in 0.05s]
2020-07-16 19:15:52.573474 (Thread-1): Finished running node model.springml_demo_dbt_project.redact_fields
2020-07-16 19:15:52.647261 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 19:15:52.647591 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:15:52.648045 (MainThread): 15:15:52 | 
2020-07-16 19:15:52.648314 (MainThread): 15:15:52 | Finished running 2 view models in 2.97s.
2020-07-16 19:15:52.648503 (MainThread): Connection 'master' was properly closed.
2020-07-16 19:15:52.648633 (MainThread): Connection 'model.springml_demo_dbt_project.redact_fields' was left open.
2020-07-16 19:15:52.657846 (MainThread): 
2020-07-16 19:15:52.658095 (MainThread): Completed with 2 errors and 0 warnings:
2020-07-16 19:15:52.658297 (MainThread): 
2020-07-16 19:15:52.658533 (MainThread): Compilation Error in model gender_count (models/applicant/gender_count.sql)
2020-07-16 19:15:52.658687 (MainThread):   Trying to create view `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count`, but it currently exists as a table. Either drop `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
2020-07-16 19:15:52.658816 (MainThread):   
2020-07-16 19:15:52.658946 (MainThread):   > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
2020-07-16 19:15:52.659071 (MainThread):   > called by macro adapter_macro (macros/adapters/common.sql)
2020-07-16 19:15:52.659194 (MainThread):   > called by macro handle_existing_table (macros/materializations/view/create_or_replace_view.sql)
2020-07-16 19:15:52.659320 (MainThread):   > called by macro create_or_replace_view (macros/materializations/view/create_or_replace_view.sql)
2020-07-16 19:15:52.659580 (MainThread):   > called by macro materialization_view_bigquery (macros/materializations/view.sql)
2020-07-16 19:15:52.659805 (MainThread):   > called by model gender_count (models/applicant/gender_count.sql)
2020-07-16 19:15:52.660001 (MainThread): 
2020-07-16 19:15:52.660187 (MainThread): Compilation Error in model redact_fields (models/applicant/redact_fields.sql)
2020-07-16 19:15:52.660394 (MainThread):   Trying to create view `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields`, but it currently exists as a table. Either drop `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
2020-07-16 19:15:52.660629 (MainThread):   
2020-07-16 19:15:52.660794 (MainThread):   > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
2020-07-16 19:15:52.660947 (MainThread):   > called by macro adapter_macro (macros/adapters/common.sql)
2020-07-16 19:15:52.661075 (MainThread):   > called by macro handle_existing_table (macros/materializations/view/create_or_replace_view.sql)
2020-07-16 19:15:52.661260 (MainThread):   > called by macro create_or_replace_view (macros/materializations/view/create_or_replace_view.sql)
2020-07-16 19:15:52.661427 (MainThread):   > called by macro materialization_view_bigquery (macros/materializations/view.sql)
2020-07-16 19:15:52.661556 (MainThread):   > called by model redact_fields (models/applicant/redact_fields.sql)
2020-07-16 19:15:52.661866 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
2020-07-16 19:15:52.662182 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e036ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e036990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e16af90>]}
2020-07-16 19:15:52.662448 (MainThread): Flushing usage events
2020-07-16 19:16:29.517622 (MainThread): Running with dbt=0.17.0
2020-07-16 19:16:30.973617 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-16 19:16:30.976242 (MainThread): Tracking: tracking
2020-07-16 19:16:30.991825 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11adaf490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ad92c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11adc0d10>]}
2020-07-16 19:16:31.021982 (MainThread): Partial parsing not enabled
2020-07-16 19:16:31.024514 (MainThread): Parsing macros/core.sql
2020-07-16 19:16:31.031194 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-16 19:16:31.042106 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-16 19:16:31.044671 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-16 19:16:31.067601 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-16 19:16:31.109581 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-16 19:16:31.145020 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-16 19:16:31.148557 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-16 19:16:31.157932 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-16 19:16:31.258147 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-16 19:16:31.271990 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-16 19:16:31.280820 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-16 19:16:31.287517 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-16 19:16:31.289324 (MainThread): Parsing macros/etc/query.sql
2020-07-16 19:16:31.291285 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-16 19:16:31.294016 (MainThread): Parsing macros/etc/datetime.sql
2020-07-16 19:16:31.306175 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-16 19:16:31.309341 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-16 19:16:31.311868 (MainThread): Parsing macros/adapters/common.sql
2020-07-16 19:16:31.371485 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-16 19:16:31.373578 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-16 19:16:31.375116 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-16 19:16:31.376988 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-16 19:16:31.380036 (MainThread): Parsing macros/etc.sql
2020-07-16 19:16:31.381288 (MainThread): Parsing macros/catalog.sql
2020-07-16 19:16:31.388945 (MainThread): Parsing macros/adapters.sql
2020-07-16 19:16:31.409120 (MainThread): Parsing macros/materializations/seed.sql
2020-07-16 19:16:31.412062 (MainThread): Parsing macros/materializations/view.sql
2020-07-16 19:16:31.416639 (MainThread): Parsing macros/materializations/table.sql
2020-07-16 19:16:31.430198 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-16 19:16:31.449746 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-16 19:16:31.476510 (MainThread): Partial parsing not enabled
2020-07-16 19:16:31.531453 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-16 19:16:31.531630 (MainThread): Opening a new connection, currently in state init
2020-07-16 19:16:31.567290 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 19:16:31.567442 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:16:31.583022 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-16 19:16:31.583226 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:16:31.596694 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-16 19:16:31.596842 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:16:31.658564 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-16 19:16:31.658741 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:16:32.087146 (MainThread): Found 4 models, 9 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 2 seed files, 2 sources
2020-07-16 19:16:32.088536 (MainThread): 
2020-07-16 19:16:32.088972 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 19:16:32.089081 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:16:32.095583 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-16 19:16:32.095856 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-16 19:16:32.099466 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-16 19:16:34.353813 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-16 19:16:34.354102 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-16 19:16:34.354279 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 19:16:34.528554 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 19:16:34.528716 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:16:34.529032 (MainThread): 15:16:34 | Concurrency: 1 threads (target='dev')
2020-07-16 19:16:34.529197 (MainThread): 15:16:34 | 
2020-07-16 19:16:34.531644 (Thread-1): Began running node model.springml_demo_dbt_project.creditcard
2020-07-16 19:16:34.532968 (Thread-1): 15:16:34 | 1 of 4 START view model springml_demo_dataset.creditcard............. [RUN]
2020-07-16 19:16:34.533376 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-16 19:16:34.533492 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-16 19:16:34.533622 (Thread-1): Compiling model.springml_demo_dbt_project.creditcard
2020-07-16 19:16:34.557862 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-16 19:16:34.561612 (Thread-1): finished collecting timing info
2020-07-16 19:16:34.604350 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-16 19:16:34.605793 (Thread-1): On model.springml_demo_dbt_project.creditcard: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
  OPTIONS()
  as 

select country,

sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,

sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,

sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,

from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
group by country 
having not (Amex_payments = 0 
and	Mastercard_payments = 0 
and	 Visa_payments = 0)
order by (Amex_payments + Mastercard_payments + Visa_payments) desc;


2020-07-16 19:16:36.590447 (Thread-1): finished collecting timing info
2020-07-16 19:16:36.591589 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3e67789-c566-4472-85c3-97fc1ae1020d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b0eb590>]}
2020-07-16 19:16:36.593514 (Thread-1): 15:16:36 | 1 of 4 OK created view model springml_demo_dataset.creditcard........ [CREATE VIEW in 2.06s]
2020-07-16 19:16:36.593772 (Thread-1): Finished running node model.springml_demo_dbt_project.creditcard
2020-07-16 19:16:36.593988 (Thread-1): Began running node model.springml_demo_dbt_project.gender_count
2020-07-16 19:16:36.595919 (Thread-1): 15:16:36 | 2 of 4 START view model springml_demo_dataset.gender_count........... [RUN]
2020-07-16 19:16:36.596500 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 19:16:36.596668 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.creditcard).
2020-07-16 19:16:36.596813 (Thread-1): Compiling model.springml_demo_dbt_project.gender_count
2020-07-16 19:16:36.612081 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 19:16:36.612593 (Thread-1): finished collecting timing info
2020-07-16 19:16:36.622824 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 19:16:36.837612 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 19:16:36.838549 (Thread-1): On model.springml_demo_dbt_project.gender_count: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.gender_count"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count`
  OPTIONS()
  as SELECT 
CURRENT_DATE() as Ingestion_date, 
countif(ad.Gender is not null and ad.Gender="F" ) as Female_count,
countif(ad.Gender is not null and ad.Gender="M" ) as Male_count,
FROM `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data` as ad;


2020-07-16 19:16:37.500699 (Thread-1): finished collecting timing info
2020-07-16 19:16:37.501680 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3e67789-c566-4472-85c3-97fc1ae1020d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11af9b8d0>]}
2020-07-16 19:16:37.503324 (Thread-1): 15:16:37 | 2 of 4 OK created view model springml_demo_dataset.gender_count...... [CREATE VIEW in 0.91s]
2020-07-16 19:16:37.503545 (Thread-1): Finished running node model.springml_demo_dbt_project.gender_count
2020-07-16 19:16:37.503782 (Thread-1): Began running node model.springml_demo_dbt_project.payments
2020-07-16 19:16:37.505042 (Thread-1): 15:16:37 | 3 of 4 START view model springml_demo_dataset.payments............... [RUN]
2020-07-16 19:16:37.505493 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-16 19:16:37.505608 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.gender_count).
2020-07-16 19:16:37.505713 (Thread-1): Compiling model.springml_demo_dbt_project.payments
2020-07-16 19:16:37.515539 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.payments"
2020-07-16 19:16:37.516040 (Thread-1): finished collecting timing info
2020-07-16 19:16:37.521609 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.payments"
2020-07-16 19:16:37.522879 (Thread-1): On model.springml_demo_dbt_project.payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
  OPTIONS()
  as select payment_type, 
    count(*) as number_of_payments, 
    sum(price) as total_price 
from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where country like "United States"
group by payment_type;


2020-07-16 19:16:38.107552 (Thread-1): finished collecting timing info
2020-07-16 19:16:38.108483 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3e67789-c566-4472-85c3-97fc1ae1020d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11af9b8d0>]}
2020-07-16 19:16:38.109880 (Thread-1): 15:16:38 | 3 of 4 OK created view model springml_demo_dataset.payments.......... [CREATE VIEW in 0.60s]
2020-07-16 19:16:38.110066 (Thread-1): Finished running node model.springml_demo_dbt_project.payments
2020-07-16 19:16:38.110261 (Thread-1): Began running node model.springml_demo_dbt_project.redact_fields
2020-07-16 19:16:38.111518 (Thread-1): 15:16:38 | 4 of 4 START view model springml_demo_dataset.redact_fields.......... [RUN]
2020-07-16 19:16:38.111874 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-16 19:16:38.111975 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.payments).
2020-07-16 19:16:38.112069 (Thread-1): Compiling model.springml_demo_dbt_project.redact_fields
2020-07-16 19:16:38.122967 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-16 19:16:38.123507 (Thread-1): finished collecting timing info
2020-07-16 19:16:38.128067 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 19:16:38.411429 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-16 19:16:38.414133 (Thread-1): On model.springml_demo_dbt_project.redact_fields: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.redact_fields"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields`
  OPTIONS()
  as with final as ( 
	select
		Employee_no,
		'##ARCHIVED##' as Surname,
		'##ARCHIVED##'as Given_name,
		Gender,
		City,
		Age,
		Year_joined,
		cast(Phone_no as string),
		cast(Social_insurance_no as string)
	from
		`prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`
)

select
		Employee_no,
		Surname,
		Given_name,
		Gender,
		City,
		Age,
		Year_joined,
		'##ARCHIVED##' as Phone_no,
		'##ARCHIVED##' as Social_insurance_no
	from
		final;


2020-07-16 19:16:39.875487 (Thread-1): finished collecting timing info
2020-07-16 19:16:39.876466 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3e67789-c566-4472-85c3-97fc1ae1020d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11af9b8d0>]}
2020-07-16 19:16:39.877951 (Thread-1): 15:16:39 | 4 of 4 OK created view model springml_demo_dataset.redact_fields..... [CREATE VIEW in 1.76s]
2020-07-16 19:16:39.878219 (Thread-1): Finished running node model.springml_demo_dbt_project.redact_fields
2020-07-16 19:16:39.919205 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 19:16:39.919445 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:16:39.919924 (MainThread): 15:16:39 | 
2020-07-16 19:16:39.920098 (MainThread): 15:16:39 | Finished running 4 view models in 7.83s.
2020-07-16 19:16:39.920306 (MainThread): Connection 'master' was properly closed.
2020-07-16 19:16:39.920491 (MainThread): Connection 'model.springml_demo_dbt_project.redact_fields' was left open.
2020-07-16 19:16:39.936659 (MainThread): 
2020-07-16 19:16:39.936911 (MainThread): Completed successfully
2020-07-16 19:16:39.937063 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-07-16 19:16:39.937278 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b034b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b355090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b2d3950>]}
2020-07-16 19:16:39.937482 (MainThread): Flushing usage events
2020-07-16 19:23:58.909167 (MainThread): Running with dbt=0.17.0
2020-07-16 19:24:00.853824 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-16 19:24:00.856409 (MainThread): Tracking: tracking
2020-07-16 19:24:00.920378 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed9f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b878c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bee5a10>]}
2020-07-16 19:24:00.977979 (MainThread): Partial parsing not enabled
2020-07-16 19:24:00.984337 (MainThread): Parsing macros/core.sql
2020-07-16 19:24:00.993095 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-16 19:24:01.010487 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-16 19:24:01.014236 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-16 19:24:01.039054 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-16 19:24:01.083025 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-16 19:24:01.112739 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-16 19:24:01.115776 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-16 19:24:01.124694 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-16 19:24:01.143868 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-16 19:24:01.154613 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-16 19:24:01.164960 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-16 19:24:01.172028 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-16 19:24:01.173862 (MainThread): Parsing macros/etc/query.sql
2020-07-16 19:24:01.175868 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-16 19:24:01.178767 (MainThread): Parsing macros/etc/datetime.sql
2020-07-16 19:24:01.190765 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-16 19:24:01.193446 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-16 19:24:01.196096 (MainThread): Parsing macros/adapters/common.sql
2020-07-16 19:24:01.261876 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-16 19:24:01.264177 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-16 19:24:01.266239 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-16 19:24:01.268574 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-16 19:24:01.272272 (MainThread): Parsing macros/etc.sql
2020-07-16 19:24:01.273994 (MainThread): Parsing macros/catalog.sql
2020-07-16 19:24:01.282583 (MainThread): Parsing macros/adapters.sql
2020-07-16 19:24:01.303866 (MainThread): Parsing macros/materializations/seed.sql
2020-07-16 19:24:01.307380 (MainThread): Parsing macros/materializations/view.sql
2020-07-16 19:24:01.310851 (MainThread): Parsing macros/materializations/table.sql
2020-07-16 19:24:01.325242 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-16 19:24:01.341939 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-16 19:24:01.370902 (MainThread): Partial parsing not enabled
2020-07-16 19:24:01.417676 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-16 19:24:01.417857 (MainThread): Opening a new connection, currently in state init
2020-07-16 19:24:01.456392 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 19:24:01.456562 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:24:01.471942 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-16 19:24:01.472099 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:24:01.487277 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-16 19:24:01.487428 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:24:01.550491 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-16 19:24:01.550664 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:24:01.995808 (MainThread): Found 4 models, 9 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 2 seed files, 2 sources
2020-07-16 19:24:01.997300 (MainThread): 
2020-07-16 19:24:01.997878 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 19:24:01.998002 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:24:02.004949 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-16 19:24:02.005236 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-16 19:24:02.009026 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-16 19:24:04.785641 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-16 19:24:04.785949 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-16 19:24:04.786129 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 19:24:04.965491 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 19:24:04.965697 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:24:04.966180 (MainThread): 15:24:04 | Concurrency: 1 threads (target='dev')
2020-07-16 19:24:04.966419 (MainThread): 15:24:04 | 
2020-07-16 19:24:04.969087 (Thread-1): Began running node model.springml_demo_dbt_project.creditcard
2020-07-16 19:24:04.971037 (Thread-1): 15:24:04 | 1 of 4 START view model springml_demo_dataset.creditcard............. [RUN]
2020-07-16 19:24:04.971569 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-16 19:24:04.971729 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-16 19:24:04.971902 (Thread-1): Compiling model.springml_demo_dbt_project.creditcard
2020-07-16 19:24:05.002857 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-16 19:24:05.003693 (Thread-1): finished collecting timing info
2020-07-16 19:24:05.044904 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-16 19:24:05.045450 (Thread-1): On model.springml_demo_dbt_project.creditcard: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
  OPTIONS()
  as 

select country,

sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,

sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,

sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,

from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
group by country 
having not (Amex_payments = 0 
and	Mastercard_payments = 0 
and	 Visa_payments = 0)
order by (Amex_payments + Mastercard_payments + Visa_payments) desc;


2020-07-16 19:24:06.258972 (Thread-1): finished collecting timing info
2020-07-16 19:24:06.259757 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7aceaf4f-65b8-4ca8-b3ac-4dba7ae7df90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c15d1d0>]}
2020-07-16 19:24:06.261006 (Thread-1): 15:24:06 | 1 of 4 OK created view model springml_demo_dataset.creditcard........ [CREATE VIEW in 1.29s]
2020-07-16 19:24:06.261165 (Thread-1): Finished running node model.springml_demo_dbt_project.creditcard
2020-07-16 19:24:06.261370 (Thread-1): Began running node model.springml_demo_dbt_project.gender_count
2020-07-16 19:24:06.262630 (Thread-1): 15:24:06 | 2 of 4 START view model springml_demo_dataset.gender_count........... [RUN]
2020-07-16 19:24:06.262994 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 19:24:06.263096 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.creditcard).
2020-07-16 19:24:06.263190 (Thread-1): Compiling model.springml_demo_dbt_project.gender_count
2020-07-16 19:24:06.272051 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 19:24:06.273629 (Thread-1): finished collecting timing info
2020-07-16 19:24:06.278966 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 19:24:06.279473 (Thread-1): On model.springml_demo_dbt_project.gender_count: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.gender_count"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count`
  OPTIONS()
  as SELECT 
CURRENT_DATE() as Ingestion_date, 
countif(ad.Gender is not null and ad.Gender="F" ) as Female_count,
countif(ad.Gender is not null and ad.Gender="M" ) as Male_count,
FROM `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data` as ad;


2020-07-16 19:24:07.331293 (Thread-1): finished collecting timing info
2020-07-16 19:24:07.332216 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7aceaf4f-65b8-4ca8-b3ac-4dba7ae7df90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c13aed0>]}
2020-07-16 19:24:07.333754 (Thread-1): 15:24:07 | 2 of 4 OK created view model springml_demo_dataset.gender_count...... [CREATE VIEW in 1.07s]
2020-07-16 19:24:07.333975 (Thread-1): Finished running node model.springml_demo_dbt_project.gender_count
2020-07-16 19:24:07.334245 (Thread-1): Began running node model.springml_demo_dbt_project.payments
2020-07-16 19:24:07.335382 (Thread-1): 15:24:07 | 3 of 4 START view model springml_demo_dataset.payments............... [RUN]
2020-07-16 19:24:07.335853 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-16 19:24:07.335977 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.gender_count).
2020-07-16 19:24:07.336085 (Thread-1): Compiling model.springml_demo_dbt_project.payments
2020-07-16 19:24:07.345883 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.payments"
2020-07-16 19:24:07.346473 (Thread-1): finished collecting timing info
2020-07-16 19:24:07.351709 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.payments"
2020-07-16 19:24:07.353219 (Thread-1): On model.springml_demo_dbt_project.payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
  OPTIONS()
  as select payment_type, 
    count(*) as number_of_payments, 
    sum(price) as total_price 
from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where country like "United States"
group by payment_type;


2020-07-16 19:24:08.719683 (Thread-1): finished collecting timing info
2020-07-16 19:24:08.720594 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7aceaf4f-65b8-4ca8-b3ac-4dba7ae7df90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c0c8210>]}
2020-07-16 19:24:08.721810 (Thread-1): 15:24:08 | 3 of 4 OK created view model springml_demo_dataset.payments.......... [CREATE VIEW in 1.38s]
2020-07-16 19:24:08.721969 (Thread-1): Finished running node model.springml_demo_dbt_project.payments
2020-07-16 19:24:08.722174 (Thread-1): Began running node model.springml_demo_dbt_project.redact_fields
2020-07-16 19:24:08.723290 (Thread-1): 15:24:08 | 4 of 4 START view model springml_demo_dataset.redact_fields.......... [RUN]
2020-07-16 19:24:08.723742 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-16 19:24:08.723859 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.payments).
2020-07-16 19:24:08.723964 (Thread-1): Compiling model.springml_demo_dbt_project.redact_fields
2020-07-16 19:24:08.735616 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-16 19:24:08.737982 (Thread-1): finished collecting timing info
2020-07-16 19:24:08.743648 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-16 19:24:08.744265 (Thread-1): On model.springml_demo_dbt_project.redact_fields: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.redact_fields"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields`
  OPTIONS()
  as select
	Employee_no,
	'##ARCHIVED##' as Surname,
	'##ARCHIVED##'as Given_name,
	Gender,
	City,
	Age,
	Year_joined ,
	'##ARCHIVED##' as cast(Phone_no as string),
	'##ARCHIVED##' as cast(Social_insurance_no as string)
from
	`prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`;


2020-07-16 19:24:09.664232 (Thread-1): finished collecting timing info
2020-07-16 19:24:09.665020 (Thread-1): Database Error in model redact_fields (models/applicant/redact_fields.sql)
  Syntax error: Unexpected keyword CAST at [14:27]
  compiled SQL at target/run/springml_demo_dbt_project/models/applicant/redact_fields.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 84, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 225, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 352, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 127, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Unexpected keyword CAST at [14:27]

(job ID: 9062fd73-981e-4848-b89c-6c51be63a498)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.redact_fields"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields`
   5:  OPTIONS()
   6:  as select
   7:	Employee_no,
   8:	'##ARCHIVED##' as Surname,
   9:	'##ARCHIVED##'as Given_name,
  10:	Gender,
  11:	City,
  12:	Age,
  13:	Year_joined ,
  14:	'##ARCHIVED##' as cast(Phone_no as string),
  15:	'##ARCHIVED##' as cast(Social_insurance_no as string)
  16:from
  17:	`prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`;
  18:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 234, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 227, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/Cellar/python/3.7.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 88, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 76, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model redact_fields (models/applicant/redact_fields.sql)
  Syntax error: Unexpected keyword CAST at [14:27]
  compiled SQL at target/run/springml_demo_dbt_project/models/applicant/redact_fields.sql
2020-07-16 19:24:09.693090 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7aceaf4f-65b8-4ca8-b3ac-4dba7ae7df90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c0c8210>]}
2020-07-16 19:24:09.695161 (Thread-1): 15:24:09 | 4 of 4 ERROR creating view model springml_demo_dataset.redact_fields. [ERROR in 0.97s]
2020-07-16 19:24:09.695401 (Thread-1): Finished running node model.springml_demo_dbt_project.redact_fields
2020-07-16 19:24:09.713389 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 19:24:09.713639 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:24:09.714118 (MainThread): 15:24:09 | 
2020-07-16 19:24:09.714339 (MainThread): 15:24:09 | Finished running 4 view models in 7.72s.
2020-07-16 19:24:09.714572 (MainThread): Connection 'master' was properly closed.
2020-07-16 19:24:09.714760 (MainThread): Connection 'model.springml_demo_dbt_project.redact_fields' was left open.
2020-07-16 19:24:09.733884 (MainThread): 
2020-07-16 19:24:09.734079 (MainThread): Completed with 1 error and 0 warnings:
2020-07-16 19:24:09.734209 (MainThread): 
2020-07-16 19:24:09.734331 (MainThread): Database Error in model redact_fields (models/applicant/redact_fields.sql)
2020-07-16 19:24:09.734444 (MainThread):   Syntax error: Unexpected keyword CAST at [14:27]
2020-07-16 19:24:09.734544 (MainThread):   compiled SQL at target/run/springml_demo_dbt_project/models/applicant/redact_fields.sql
2020-07-16 19:24:09.734678 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2020-07-16 19:24:09.734903 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c13ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cc98090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c3f23d0>]}
2020-07-16 19:24:09.735102 (MainThread): Flushing usage events
2020-07-16 19:28:46.013321 (MainThread): Running with dbt=0.17.0
2020-07-16 19:28:47.353078 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-16 19:28:47.359888 (MainThread): Tracking: tracking
2020-07-16 19:28:47.384139 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1151cd050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1151d2b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1151d2910>]}
2020-07-16 19:28:47.415149 (MainThread): Partial parsing not enabled
2020-07-16 19:28:47.418934 (MainThread): Parsing macros/core.sql
2020-07-16 19:28:47.427702 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-16 19:28:47.438496 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-16 19:28:47.441343 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-16 19:28:47.464736 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-16 19:28:47.504994 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-16 19:28:47.531959 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-16 19:28:47.535712 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-16 19:28:47.546739 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-16 19:28:47.564927 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-16 19:28:47.575235 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-16 19:28:47.584697 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-16 19:28:47.591728 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-16 19:28:47.593696 (MainThread): Parsing macros/etc/query.sql
2020-07-16 19:28:47.595829 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-16 19:28:47.598497 (MainThread): Parsing macros/etc/datetime.sql
2020-07-16 19:28:47.610383 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-16 19:28:47.613804 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-16 19:28:47.616756 (MainThread): Parsing macros/adapters/common.sql
2020-07-16 19:28:47.682980 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-16 19:28:47.685895 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-16 19:28:47.688263 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-16 19:28:47.690820 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-16 19:28:47.694854 (MainThread): Parsing macros/etc.sql
2020-07-16 19:28:47.696823 (MainThread): Parsing macros/catalog.sql
2020-07-16 19:28:47.705573 (MainThread): Parsing macros/adapters.sql
2020-07-16 19:28:47.726478 (MainThread): Parsing macros/materializations/seed.sql
2020-07-16 19:28:47.729359 (MainThread): Parsing macros/materializations/view.sql
2020-07-16 19:28:47.732756 (MainThread): Parsing macros/materializations/table.sql
2020-07-16 19:28:47.746415 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-16 19:28:47.763174 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-16 19:28:47.788223 (MainThread): Partial parsing not enabled
2020-07-16 19:28:47.843240 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-16 19:28:47.843523 (MainThread): Opening a new connection, currently in state init
2020-07-16 19:28:47.879289 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 19:28:47.879459 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:28:47.893364 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-16 19:28:47.893516 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:28:47.908379 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-16 19:28:47.908558 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:28:47.973581 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-16 19:28:47.973742 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:28:48.418202 (MainThread): Found 4 models, 9 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 2 seed files, 2 sources
2020-07-16 19:28:48.419703 (MainThread): 
2020-07-16 19:28:48.420087 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 19:28:48.420193 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:28:48.426507 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-16 19:28:48.426784 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-16 19:28:48.431530 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-16 19:28:51.554688 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-16 19:28:51.555025 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-16 19:28:51.555265 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 19:28:51.699917 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 19:28:51.700091 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:28:51.700420 (MainThread): 15:28:51 | Concurrency: 1 threads (target='dev')
2020-07-16 19:28:51.700591 (MainThread): 15:28:51 | 
2020-07-16 19:28:51.703157 (Thread-1): Began running node model.springml_demo_dbt_project.creditcard
2020-07-16 19:28:51.704460 (Thread-1): 15:28:51 | 1 of 4 START view model springml_demo_dataset.creditcard............. [RUN]
2020-07-16 19:28:51.704873 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-16 19:28:51.705102 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-16 19:28:51.705253 (Thread-1): Compiling model.springml_demo_dbt_project.creditcard
2020-07-16 19:28:51.727649 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-16 19:28:51.729705 (Thread-1): finished collecting timing info
2020-07-16 19:28:51.768235 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-16 19:28:51.768826 (Thread-1): On model.springml_demo_dbt_project.creditcard: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
  OPTIONS()
  as 

select country,

sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,

sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,

sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,

from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
group by country 
having not (Amex_payments = 0 
and	Mastercard_payments = 0 
and	 Visa_payments = 0)
order by (Amex_payments + Mastercard_payments + Visa_payments) desc;


2020-07-16 19:28:52.372665 (Thread-1): finished collecting timing info
2020-07-16 19:28:52.373497 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0c2273a-29e5-4562-87c7-7ad8c057173b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1155cfc90>]}
2020-07-16 19:28:52.374770 (Thread-1): 15:28:52 | 1 of 4 OK created view model springml_demo_dataset.creditcard........ [CREATE VIEW in 0.67s]
2020-07-16 19:28:52.374936 (Thread-1): Finished running node model.springml_demo_dbt_project.creditcard
2020-07-16 19:28:52.375104 (Thread-1): Began running node model.springml_demo_dbt_project.gender_count
2020-07-16 19:28:52.376479 (Thread-1): 15:28:52 | 2 of 4 START view model springml_demo_dataset.gender_count........... [RUN]
2020-07-16 19:28:52.376843 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 19:28:52.377029 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.creditcard).
2020-07-16 19:28:52.377162 (Thread-1): Compiling model.springml_demo_dbt_project.gender_count
2020-07-16 19:28:52.385843 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 19:28:52.388540 (Thread-1): finished collecting timing info
2020-07-16 19:28:52.394355 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 19:28:52.394916 (Thread-1): On model.springml_demo_dbt_project.gender_count: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.gender_count"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count`
  OPTIONS()
  as SELECT 
CURRENT_DATE() as Ingestion_date, 
countif(ad.Gender is not null and ad.Gender="F" ) as Female_count,
countif(ad.Gender is not null and ad.Gender="M" ) as Male_count,
FROM `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data` as ad;


2020-07-16 19:28:52.924817 (Thread-1): finished collecting timing info
2020-07-16 19:28:52.925723 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0c2273a-29e5-4562-87c7-7ad8c057173b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156e8cd0>]}
2020-07-16 19:28:52.927210 (Thread-1): 15:28:52 | 2 of 4 OK created view model springml_demo_dataset.gender_count...... [CREATE VIEW in 0.55s]
2020-07-16 19:28:52.927418 (Thread-1): Finished running node model.springml_demo_dbt_project.gender_count
2020-07-16 19:28:52.927586 (Thread-1): Began running node model.springml_demo_dbt_project.payments
2020-07-16 19:28:52.928853 (Thread-1): 15:28:52 | 3 of 4 START view model springml_demo_dataset.payments............... [RUN]
2020-07-16 19:28:52.929291 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-16 19:28:52.929410 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.gender_count).
2020-07-16 19:28:52.929517 (Thread-1): Compiling model.springml_demo_dbt_project.payments
2020-07-16 19:28:52.939402 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.payments"
2020-07-16 19:28:52.939924 (Thread-1): finished collecting timing info
2020-07-16 19:28:52.945497 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.payments"
2020-07-16 19:28:52.946087 (Thread-1): On model.springml_demo_dbt_project.payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
  OPTIONS()
  as select payment_type, 
    count(*) as number_of_payments, 
    sum(price) as total_price 
from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where country like "United States"
group by payment_type;


2020-07-16 19:28:53.543553 (Thread-1): finished collecting timing info
2020-07-16 19:28:53.544433 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0c2273a-29e5-4562-87c7-7ad8c057173b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11544d250>]}
2020-07-16 19:28:53.546059 (Thread-1): 15:28:53 | 3 of 4 OK created view model springml_demo_dataset.payments.......... [CREATE VIEW in 0.62s]
2020-07-16 19:28:53.546267 (Thread-1): Finished running node model.springml_demo_dbt_project.payments
2020-07-16 19:28:53.546472 (Thread-1): Began running node model.springml_demo_dbt_project.redact_fields
2020-07-16 19:28:53.548198 (Thread-1): 15:28:53 | 4 of 4 START view model springml_demo_dataset.redact_fields.......... [RUN]
2020-07-16 19:28:53.548669 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-16 19:28:53.548792 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.payments).
2020-07-16 19:28:53.548897 (Thread-1): Compiling model.springml_demo_dbt_project.redact_fields
2020-07-16 19:28:53.562813 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-16 19:28:53.563286 (Thread-1): finished collecting timing info
2020-07-16 19:28:53.568117 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-16 19:28:53.568698 (Thread-1): On model.springml_demo_dbt_project.redact_fields: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.redact_fields"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields`
  OPTIONS()
  as with source as (
	select * 
	from
		`prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`
)

with casted as (
	select
		Employee_no,
		cast(Phone_no as string),
		cast(Social_insurance_no as string)
	from source
)

with casted_edited as (
	select
		Employee_no,
		'##ARCHIVED##' as Phone_no,
		'##ARCHIVED##' as Social_insurance_no
	from casted
)

with edited as (
	select
		Employee_no,
		'##ARCHIVED##' as Surname,
		'##ARCHIVED##'as Given_name,
		Gender,
		City,
		Age,
		Year_joined
	from	
		source
)

select * 
from edited
join casted_edited on Employee_no;


2020-07-16 19:28:53.756777 (Thread-1): finished collecting timing info
2020-07-16 19:28:53.758209 (Thread-1): Database Error in model redact_fields (models/applicant/redact_fields.sql)
  Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [12:1]
  compiled SQL at target/run/springml_demo_dbt_project/models/applicant/redact_fields.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 84, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 225, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 352, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 127, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [12:1]

(job ID: 8e316d81-b01e-4983-958e-481378fbe773)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.redact_fields"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields`
   5:  OPTIONS()
   6:  as with source as (
   7:	select * 
   8:	from
   9:		`prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`
  10:)
  11:
  12:with casted as (
  13:	select
  14:		Employee_no,
  15:		cast(Phone_no as string),
  16:		cast(Social_insurance_no as string)
  17:	from source
  18:)
  19:
  20:with casted_edited as (
  21:	select
  22:		Employee_no,
  23:		'##ARCHIVED##' as Phone_no,
  24:		'##ARCHIVED##' as Social_insurance_no
  25:	from casted
  26:)
  27:
  28:with edited as (
  29:	select
  30:		Employee_no,
  31:		'##ARCHIVED##' as Surname,
  32:		'##ARCHIVED##'as Given_name,
  33:		Gender,
  34:		City,
  35:		Age,
  36:		Year_joined
  37:	from	
  38:		source
  39:)
  40:
  41:select * 
  42:from edited
  43:join casted_edited on Employee_no;
  44:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 234, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 227, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/Cellar/python/3.7.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 88, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 76, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model redact_fields (models/applicant/redact_fields.sql)
  Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [12:1]
  compiled SQL at target/run/springml_demo_dbt_project/models/applicant/redact_fields.sql
2020-07-16 19:28:53.823167 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0c2273a-29e5-4562-87c7-7ad8c057173b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156f6090>]}
2020-07-16 19:28:53.825804 (Thread-1): 15:28:53 | 4 of 4 ERROR creating view model springml_demo_dataset.redact_fields. [ERROR in 0.27s]
2020-07-16 19:28:53.826260 (Thread-1): Finished running node model.springml_demo_dbt_project.redact_fields
2020-07-16 19:28:53.885236 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 19:28:53.885478 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:28:53.886168 (MainThread): 15:28:53 | 
2020-07-16 19:28:53.886491 (MainThread): 15:28:53 | Finished running 4 view models in 5.47s.
2020-07-16 19:28:53.886820 (MainThread): Connection 'master' was properly closed.
2020-07-16 19:28:53.887040 (MainThread): Connection 'model.springml_demo_dbt_project.redact_fields' was left open.
2020-07-16 19:28:53.919540 (MainThread): 
2020-07-16 19:28:53.919889 (MainThread): Completed with 1 error and 0 warnings:
2020-07-16 19:28:53.920103 (MainThread): 
2020-07-16 19:28:53.920324 (MainThread): Database Error in model redact_fields (models/applicant/redact_fields.sql)
2020-07-16 19:28:53.920540 (MainThread):   Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [12:1]
2020-07-16 19:28:53.920779 (MainThread):   compiled SQL at target/run/springml_demo_dbt_project/models/applicant/redact_fields.sql
2020-07-16 19:28:53.921079 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2020-07-16 19:28:53.921560 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1155f4f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156e6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156e6d90>]}
2020-07-16 19:28:53.922364 (MainThread): Flushing usage events
2020-07-16 19:30:01.451794 (MainThread): Running with dbt=0.17.0
2020-07-16 19:30:02.739912 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-16 19:30:02.742750 (MainThread): Tracking: tracking
2020-07-16 19:30:02.758169 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cdc4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ce2a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ce2890>]}
2020-07-16 19:30:02.786516 (MainThread): Partial parsing not enabled
2020-07-16 19:30:02.789138 (MainThread): Parsing macros/core.sql
2020-07-16 19:30:02.795392 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-16 19:30:02.807028 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-16 19:30:02.810031 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-16 19:30:02.831837 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-16 19:30:02.873995 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-16 19:30:02.901314 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-16 19:30:02.904169 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-16 19:30:02.912666 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-16 19:30:02.930784 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-16 19:30:02.939905 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-16 19:30:02.948094 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-16 19:30:02.954547 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-16 19:30:02.956191 (MainThread): Parsing macros/etc/query.sql
2020-07-16 19:30:02.957845 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-16 19:30:02.960783 (MainThread): Parsing macros/etc/datetime.sql
2020-07-16 19:30:02.980315 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-16 19:30:02.984526 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-16 19:30:02.987938 (MainThread): Parsing macros/adapters/common.sql
2020-07-16 19:30:03.049049 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-16 19:30:03.051433 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-16 19:30:03.053413 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-16 19:30:03.055636 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-16 19:30:03.059377 (MainThread): Parsing macros/etc.sql
2020-07-16 19:30:03.060859 (MainThread): Parsing macros/catalog.sql
2020-07-16 19:30:03.068504 (MainThread): Parsing macros/adapters.sql
2020-07-16 19:30:03.090124 (MainThread): Parsing macros/materializations/seed.sql
2020-07-16 19:30:03.102926 (MainThread): Parsing macros/materializations/view.sql
2020-07-16 19:30:03.106969 (MainThread): Parsing macros/materializations/table.sql
2020-07-16 19:30:03.122034 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-16 19:30:03.138731 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-16 19:30:03.164450 (MainThread): Partial parsing not enabled
2020-07-16 19:30:03.208357 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-16 19:30:03.208530 (MainThread): Opening a new connection, currently in state init
2020-07-16 19:30:03.246262 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 19:30:03.246433 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:30:03.261688 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-16 19:30:03.261849 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:30:03.275511 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-16 19:30:03.275680 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:30:03.337895 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-16 19:30:03.338094 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:30:03.768489 (MainThread): Found 4 models, 9 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 2 seed files, 2 sources
2020-07-16 19:30:03.769828 (MainThread): 
2020-07-16 19:30:03.770357 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 19:30:03.770529 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:30:03.777231 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-16 19:30:03.777527 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-16 19:30:03.780627 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-16 19:30:06.215104 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-16 19:30:06.215364 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-16 19:30:06.215530 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 19:30:06.368291 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 19:30:06.368511 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:30:06.368915 (MainThread): 15:30:06 | Concurrency: 1 threads (target='dev')
2020-07-16 19:30:06.369091 (MainThread): 15:30:06 | 
2020-07-16 19:30:06.373101 (Thread-1): Began running node model.springml_demo_dbt_project.creditcard
2020-07-16 19:30:06.374414 (Thread-1): 15:30:06 | 1 of 4 START view model springml_demo_dataset.creditcard............. [RUN]
2020-07-16 19:30:06.374809 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-16 19:30:06.374932 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-16 19:30:06.375053 (Thread-1): Compiling model.springml_demo_dbt_project.creditcard
2020-07-16 19:30:06.397979 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-16 19:30:06.399611 (Thread-1): finished collecting timing info
2020-07-16 19:30:06.438664 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-16 19:30:06.440388 (Thread-1): On model.springml_demo_dbt_project.creditcard: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
  OPTIONS()
  as 

select country,

sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,

sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,

sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,

from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
group by country 
having not (Amex_payments = 0 
and	Mastercard_payments = 0 
and	 Visa_payments = 0)
order by (Amex_payments + Mastercard_payments + Visa_payments) desc;


2020-07-16 19:30:07.235425 (Thread-1): finished collecting timing info
2020-07-16 19:30:07.236216 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27faff74-b41d-41ed-a893-c494ad5064c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130d1f50>]}
2020-07-16 19:30:07.237732 (Thread-1): 15:30:07 | 1 of 4 OK created view model springml_demo_dataset.creditcard........ [CREATE VIEW in 0.86s]
2020-07-16 19:30:07.237911 (Thread-1): Finished running node model.springml_demo_dbt_project.creditcard
2020-07-16 19:30:07.238135 (Thread-1): Began running node model.springml_demo_dbt_project.gender_count
2020-07-16 19:30:07.239397 (Thread-1): 15:30:07 | 2 of 4 START view model springml_demo_dataset.gender_count........... [RUN]
2020-07-16 19:30:07.239880 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 19:30:07.239976 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.creditcard).
2020-07-16 19:30:07.240062 (Thread-1): Compiling model.springml_demo_dbt_project.gender_count
2020-07-16 19:30:07.248729 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 19:30:07.249238 (Thread-1): finished collecting timing info
2020-07-16 19:30:07.253959 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 19:30:07.254415 (Thread-1): On model.springml_demo_dbt_project.gender_count: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.gender_count"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count`
  OPTIONS()
  as SELECT 
CURRENT_DATE() as Ingestion_date, 
countif(ad.Gender is not null and ad.Gender="F" ) as Female_count,
countif(ad.Gender is not null and ad.Gender="M" ) as Male_count,
FROM `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data` as ad;


2020-07-16 19:30:08.069499 (Thread-1): finished collecting timing info
2020-07-16 19:30:08.070423 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27faff74-b41d-41ed-a893-c494ad5064c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a2ab90>]}
2020-07-16 19:30:08.071956 (Thread-1): 15:30:08 | 2 of 4 OK created view model springml_demo_dataset.gender_count...... [CREATE VIEW in 0.83s]
2020-07-16 19:30:08.072111 (Thread-1): Finished running node model.springml_demo_dbt_project.gender_count
2020-07-16 19:30:08.072314 (Thread-1): Began running node model.springml_demo_dbt_project.payments
2020-07-16 19:30:08.073475 (Thread-1): 15:30:08 | 3 of 4 START view model springml_demo_dataset.payments............... [RUN]
2020-07-16 19:30:08.074081 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-16 19:30:08.074209 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.gender_count).
2020-07-16 19:30:08.074320 (Thread-1): Compiling model.springml_demo_dbt_project.payments
2020-07-16 19:30:08.084003 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.payments"
2020-07-16 19:30:08.084454 (Thread-1): finished collecting timing info
2020-07-16 19:30:08.089910 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.payments"
2020-07-16 19:30:08.090460 (Thread-1): On model.springml_demo_dbt_project.payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
  OPTIONS()
  as select payment_type, 
    count(*) as number_of_payments, 
    sum(price) as total_price 
from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where country like "United States"
group by payment_type;


2020-07-16 19:30:08.652559 (Thread-1): finished collecting timing info
2020-07-16 19:30:08.653723 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27faff74-b41d-41ed-a893-c494ad5064c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113aac390>]}
2020-07-16 19:30:08.655358 (Thread-1): 15:30:08 | 3 of 4 OK created view model springml_demo_dataset.payments.......... [CREATE VIEW in 0.58s]
2020-07-16 19:30:08.655593 (Thread-1): Finished running node model.springml_demo_dbt_project.payments
2020-07-16 19:30:08.655821 (Thread-1): Began running node model.springml_demo_dbt_project.redact_fields
2020-07-16 19:30:08.657005 (Thread-1): 15:30:08 | 4 of 4 START view model springml_demo_dataset.redact_fields.......... [RUN]
2020-07-16 19:30:08.657473 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-16 19:30:08.657590 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.payments).
2020-07-16 19:30:08.657696 (Thread-1): Compiling model.springml_demo_dbt_project.redact_fields
2020-07-16 19:30:08.670223 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-16 19:30:08.670736 (Thread-1): finished collecting timing info
2020-07-16 19:30:08.675512 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-16 19:30:08.676009 (Thread-1): On model.springml_demo_dbt_project.redact_fields: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.redact_fields"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields`
  OPTIONS()
  as with source as (
	select * 
	from
		`prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`
),

casted as (
	select
		Employee_no,
		cast(Phone_no as string),
		cast(Social_insurance_no as string)
	from source
),

casted_edited as (
	select
		Employee_no,
		'##ARCHIVED##' as Phone_no,
		'##ARCHIVED##' as Social_insurance_no
	from casted
),

edited as (
	select
		Employee_no,
		'##ARCHIVED##' as Surname,
		'##ARCHIVED##'as Given_name,
		Gender,
		City,
		Age,
		Year_joined
	from	
		source
)

select * 
from edited
join casted_edited on Employee_no;


2020-07-16 19:30:09.283276 (Thread-1): finished collecting timing info
2020-07-16 19:30:09.284155 (Thread-1): Database Error in model redact_fields (models/applicant/redact_fields.sql)
  Column name Employee_no is ambiguous at [43:23]
  compiled SQL at target/run/springml_demo_dbt_project/models/applicant/redact_fields.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 84, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 225, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 352, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 122, in result
    self._blocking_poll(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3098, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 101, in _blocking_poll
    retry_(self._done_or_raise)()
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 80, in _done_or_raise
    if not self.done():
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3085, in done
    timeout=timeout,
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/client.py", line 1287, in _get_query_results
    retry, method="GET", path=path, query_params=extra_params, timeout=timeout
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/client.py", line 556, in _call_api
    return call()
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/google/cloud/_http.py", line 423, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/prismatic-cider-279015/queries/1e2b7a0c-fa6d-4d44-bab7-fa1cb97a5964?maxResults=0&location=US: Column name Employee_no is ambiguous at [43:23]

(job ID: 1e2b7a0c-fa6d-4d44-bab7-fa1cb97a5964)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.redact_fields"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields`
   5:  OPTIONS()
   6:  as with source as (
   7:	select * 
   8:	from
   9:		`prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`
  10:),
  11:
  12:casted as (
  13:	select
  14:		Employee_no,
  15:		cast(Phone_no as string),
  16:		cast(Social_insurance_no as string)
  17:	from source
  18:),
  19:
  20:casted_edited as (
  21:	select
  22:		Employee_no,
  23:		'##ARCHIVED##' as Phone_no,
  24:		'##ARCHIVED##' as Social_insurance_no
  25:	from casted
  26:),
  27:
  28:edited as (
  29:	select
  30:		Employee_no,
  31:		'##ARCHIVED##' as Surname,
  32:		'##ARCHIVED##'as Given_name,
  33:		Gender,
  34:		City,
  35:		Age,
  36:		Year_joined
  37:	from	
  38:		source
  39:)
  40:
  41:select * 
  42:from edited
  43:join casted_edited on Employee_no;
  44:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 234, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 227, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/Cellar/python/3.7.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 88, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 76, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model redact_fields (models/applicant/redact_fields.sql)
  Column name Employee_no is ambiguous at [43:23]
  compiled SQL at target/run/springml_demo_dbt_project/models/applicant/redact_fields.sql
2020-07-16 19:30:09.347884 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27faff74-b41d-41ed-a893-c494ad5064c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f46e10>]}
2020-07-16 19:30:09.350035 (Thread-1): 15:30:09 | 4 of 4 ERROR creating view model springml_demo_dataset.redact_fields. [ERROR in 0.69s]
2020-07-16 19:30:09.350272 (Thread-1): Finished running node model.springml_demo_dbt_project.redact_fields
2020-07-16 19:30:09.363293 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 19:30:09.363543 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:30:09.364050 (MainThread): 15:30:09 | 
2020-07-16 19:30:09.364313 (MainThread): 15:30:09 | Finished running 4 view models in 5.59s.
2020-07-16 19:30:09.364600 (MainThread): Connection 'master' was properly closed.
2020-07-16 19:30:09.364809 (MainThread): Connection 'model.springml_demo_dbt_project.redact_fields' was left open.
2020-07-16 19:30:09.384766 (MainThread): 
2020-07-16 19:30:09.385274 (MainThread): Completed with 1 error and 0 warnings:
2020-07-16 19:30:09.385636 (MainThread): 
2020-07-16 19:30:09.385983 (MainThread): Database Error in model redact_fields (models/applicant/redact_fields.sql)
2020-07-16 19:30:09.386200 (MainThread):   Column name Employee_no is ambiguous at [43:23]
2020-07-16 19:30:09.386382 (MainThread):   compiled SQL at target/run/springml_demo_dbt_project/models/applicant/redact_fields.sql
2020-07-16 19:30:09.386594 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2020-07-16 19:30:09.386956 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f46c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f46e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a2e110>]}
2020-07-16 19:30:09.387334 (MainThread): Flushing usage events
2020-07-16 19:31:46.225105 (MainThread): Running with dbt=0.17.0
2020-07-16 19:31:47.605515 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-16 19:31:47.613403 (MainThread): Tracking: tracking
2020-07-16 19:31:47.632257 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea0ef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9eefd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea24a10>]}
2020-07-16 19:31:47.659930 (MainThread): Partial parsing not enabled
2020-07-16 19:31:47.662881 (MainThread): Parsing macros/core.sql
2020-07-16 19:31:47.669743 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-16 19:31:47.679812 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-16 19:31:47.683102 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-16 19:31:47.706343 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-16 19:31:47.744510 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-16 19:31:47.772201 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-16 19:31:47.775716 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-16 19:31:47.787213 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-16 19:31:47.809253 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-16 19:31:47.819001 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-16 19:31:47.827595 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-16 19:31:47.834369 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-16 19:31:47.836577 (MainThread): Parsing macros/etc/query.sql
2020-07-16 19:31:47.839877 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-16 19:31:47.842914 (MainThread): Parsing macros/etc/datetime.sql
2020-07-16 19:31:47.854652 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-16 19:31:47.857863 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-16 19:31:47.860656 (MainThread): Parsing macros/adapters/common.sql
2020-07-16 19:31:47.920973 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-16 19:31:47.923679 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-16 19:31:47.925719 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-16 19:31:47.928031 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-16 19:31:47.932545 (MainThread): Parsing macros/etc.sql
2020-07-16 19:31:47.934311 (MainThread): Parsing macros/catalog.sql
2020-07-16 19:31:47.943124 (MainThread): Parsing macros/adapters.sql
2020-07-16 19:31:47.963633 (MainThread): Parsing macros/materializations/seed.sql
2020-07-16 19:31:47.967194 (MainThread): Parsing macros/materializations/view.sql
2020-07-16 19:31:47.970813 (MainThread): Parsing macros/materializations/table.sql
2020-07-16 19:31:47.984697 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-16 19:31:48.011364 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-16 19:31:48.037130 (MainThread): Partial parsing not enabled
2020-07-16 19:31:48.082147 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-16 19:31:48.082359 (MainThread): Opening a new connection, currently in state init
2020-07-16 19:31:48.118405 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 19:31:48.118558 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:31:48.133096 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-16 19:31:48.133331 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:31:48.148867 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-16 19:31:48.149048 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:31:48.212203 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-16 19:31:48.212385 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:31:48.636997 (MainThread): Found 4 models, 9 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 2 seed files, 2 sources
2020-07-16 19:31:48.638258 (MainThread): 
2020-07-16 19:31:48.638636 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 19:31:48.638741 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:31:48.645343 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-16 19:31:48.645565 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-16 19:31:48.650172 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-16 19:31:51.734574 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-16 19:31:51.734899 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-16 19:31:51.735141 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 19:31:51.871433 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 19:31:51.871594 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:31:51.871893 (MainThread): 15:31:51 | Concurrency: 1 threads (target='dev')
2020-07-16 19:31:51.872043 (MainThread): 15:31:51 | 
2020-07-16 19:31:51.874556 (Thread-1): Began running node model.springml_demo_dbt_project.creditcard
2020-07-16 19:31:51.875885 (Thread-1): 15:31:51 | 1 of 4 START view model springml_demo_dataset.creditcard............. [RUN]
2020-07-16 19:31:51.876297 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-16 19:31:51.876407 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-16 19:31:51.876534 (Thread-1): Compiling model.springml_demo_dbt_project.creditcard
2020-07-16 19:31:51.902876 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-16 19:31:51.903432 (Thread-1): finished collecting timing info
2020-07-16 19:31:51.941796 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-16 19:31:51.942370 (Thread-1): On model.springml_demo_dbt_project.creditcard: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
  OPTIONS()
  as 

select country,

sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,

sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,

sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,

from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
group by country 
having not (Amex_payments = 0 
and	Mastercard_payments = 0 
and	 Visa_payments = 0)
order by (Amex_payments + Mastercard_payments + Visa_payments) desc;


2020-07-16 19:31:52.590729 (Thread-1): finished collecting timing info
2020-07-16 19:31:52.591570 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '604e947b-88bc-4cba-bcf3-ed58a814de36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee1d5d0>]}
2020-07-16 19:31:52.592861 (Thread-1): 15:31:52 | 1 of 4 OK created view model springml_demo_dataset.creditcard........ [CREATE VIEW in 0.72s]
2020-07-16 19:31:52.593030 (Thread-1): Finished running node model.springml_demo_dbt_project.creditcard
2020-07-16 19:31:52.593333 (Thread-1): Began running node model.springml_demo_dbt_project.gender_count
2020-07-16 19:31:52.594656 (Thread-1): 15:31:52 | 2 of 4 START view model springml_demo_dataset.gender_count........... [RUN]
2020-07-16 19:31:52.594977 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 19:31:52.595077 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.creditcard).
2020-07-16 19:31:52.595172 (Thread-1): Compiling model.springml_demo_dbt_project.gender_count
2020-07-16 19:31:52.604057 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 19:31:52.604613 (Thread-1): finished collecting timing info
2020-07-16 19:31:52.609070 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 19:31:52.609524 (Thread-1): On model.springml_demo_dbt_project.gender_count: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.gender_count"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count`
  OPTIONS()
  as SELECT 
CURRENT_DATE() as Ingestion_date, 
countif(ad.Gender is not null and ad.Gender="F" ) as Female_count,
countif(ad.Gender is not null and ad.Gender="M" ) as Male_count,
FROM `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data` as ad;


2020-07-16 19:31:54.102774 (Thread-1): finished collecting timing info
2020-07-16 19:31:54.103924 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '604e947b-88bc-4cba-bcf3-ed58a814de36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef49dd0>]}
2020-07-16 19:31:54.105398 (Thread-1): 15:31:54 | 2 of 4 OK created view model springml_demo_dataset.gender_count...... [CREATE VIEW in 1.51s]
2020-07-16 19:31:54.105586 (Thread-1): Finished running node model.springml_demo_dbt_project.gender_count
2020-07-16 19:31:54.105801 (Thread-1): Began running node model.springml_demo_dbt_project.payments
2020-07-16 19:31:54.107063 (Thread-1): 15:31:54 | 3 of 4 START view model springml_demo_dataset.payments............... [RUN]
2020-07-16 19:31:54.107468 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-16 19:31:54.107576 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.gender_count).
2020-07-16 19:31:54.107682 (Thread-1): Compiling model.springml_demo_dbt_project.payments
2020-07-16 19:31:54.117569 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.payments"
2020-07-16 19:31:54.118113 (Thread-1): finished collecting timing info
2020-07-16 19:31:54.123475 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.payments"
2020-07-16 19:31:54.123971 (Thread-1): On model.springml_demo_dbt_project.payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
  OPTIONS()
  as select payment_type, 
    count(*) as number_of_payments, 
    sum(price) as total_price 
from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where country like "United States"
group by payment_type;


2020-07-16 19:31:55.474173 (Thread-1): finished collecting timing info
2020-07-16 19:31:55.475077 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '604e947b-88bc-4cba-bcf3-ed58a814de36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef4c9d0>]}
2020-07-16 19:31:55.476374 (Thread-1): 15:31:55 | 3 of 4 OK created view model springml_demo_dataset.payments.......... [CREATE VIEW in 1.37s]
2020-07-16 19:31:55.476581 (Thread-1): Finished running node model.springml_demo_dbt_project.payments
2020-07-16 19:31:55.476762 (Thread-1): Began running node model.springml_demo_dbt_project.redact_fields
2020-07-16 19:31:55.477981 (Thread-1): 15:31:55 | 4 of 4 START view model springml_demo_dataset.redact_fields.......... [RUN]
2020-07-16 19:31:55.478627 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-16 19:31:55.478749 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.payments).
2020-07-16 19:31:55.478857 (Thread-1): Compiling model.springml_demo_dbt_project.redact_fields
2020-07-16 19:31:55.490281 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-16 19:31:55.490737 (Thread-1): finished collecting timing info
2020-07-16 19:31:55.495513 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-16 19:31:55.495986 (Thread-1): On model.springml_demo_dbt_project.redact_fields: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.redact_fields"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields`
  OPTIONS()
  as with source as (
	select * 
	from
		`prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`
),

casted as (
	select
		Employee_no as ed_emp,
		cast(Phone_no as string),
		cast(Social_insurance_no as string)
	from source
),

casted_edited as (
	select
		ed_emp,
		'##ARCHIVED##' as Phone_no,
		'##ARCHIVED##' as Social_insurance_no
	from casted
),

edited as (
	select
		Employee_no,
		'##ARCHIVED##' as Surname,
		'##ARCHIVED##'as Given_name,
		Gender,
		City,
		Age,
		Year_joined
	from	
		source
)

select * 
from edited
join casted_edited on edited.Employee_no = casted_edited.ed_emp;


2020-07-16 19:31:56.712442 (Thread-1): finished collecting timing info
2020-07-16 19:31:56.713352 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '604e947b-88bc-4cba-bcf3-ed58a814de36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efbf390>]}
2020-07-16 19:31:56.714875 (Thread-1): 15:31:56 | 4 of 4 OK created view model springml_demo_dataset.redact_fields..... [CREATE VIEW in 1.23s]
2020-07-16 19:31:56.715049 (Thread-1): Finished running node model.springml_demo_dbt_project.redact_fields
2020-07-16 19:31:56.745948 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 19:31:56.746220 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:31:56.746745 (MainThread): 15:31:56 | 
2020-07-16 19:31:56.746967 (MainThread): 15:31:56 | Finished running 4 view models in 8.11s.
2020-07-16 19:31:56.747175 (MainThread): Connection 'master' was properly closed.
2020-07-16 19:31:56.747331 (MainThread): Connection 'model.springml_demo_dbt_project.redact_fields' was left open.
2020-07-16 19:31:56.774445 (MainThread): 
2020-07-16 19:31:56.774807 (MainThread): Completed successfully
2020-07-16 19:31:56.775075 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-07-16 19:31:56.775495 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef4ce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec03210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec04d50>]}
2020-07-16 19:31:56.775923 (MainThread): Flushing usage events
2020-07-16 19:39:03.993690 (MainThread): Running with dbt=0.17.0
2020-07-16 19:39:05.442335 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-16 19:39:05.444715 (MainThread): Tracking: tracking
2020-07-16 19:39:05.462962 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112589190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11258ead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11258e8d0>]}
2020-07-16 19:39:05.494585 (MainThread): Partial parsing not enabled
2020-07-16 19:39:05.497500 (MainThread): Parsing macros/core.sql
2020-07-16 19:39:05.504172 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-16 19:39:05.514400 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-16 19:39:05.517324 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-16 19:39:05.538721 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-16 19:39:05.576556 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-16 19:39:05.604271 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-16 19:39:05.607667 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-16 19:39:05.616841 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-16 19:39:05.638856 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-16 19:39:05.648467 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-16 19:39:05.657738 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-16 19:39:05.664846 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-16 19:39:05.666647 (MainThread): Parsing macros/etc/query.sql
2020-07-16 19:39:05.668693 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-16 19:39:05.671626 (MainThread): Parsing macros/etc/datetime.sql
2020-07-16 19:39:05.683801 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-16 19:39:05.686784 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-16 19:39:05.689840 (MainThread): Parsing macros/adapters/common.sql
2020-07-16 19:39:05.751452 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-16 19:39:05.753920 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-16 19:39:05.755600 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-16 19:39:05.757206 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-16 19:39:05.760246 (MainThread): Parsing macros/etc.sql
2020-07-16 19:39:05.761500 (MainThread): Parsing macros/catalog.sql
2020-07-16 19:39:05.769085 (MainThread): Parsing macros/adapters.sql
2020-07-16 19:39:05.790545 (MainThread): Parsing macros/materializations/seed.sql
2020-07-16 19:39:05.794035 (MainThread): Parsing macros/materializations/view.sql
2020-07-16 19:39:05.797619 (MainThread): Parsing macros/materializations/table.sql
2020-07-16 19:39:05.813039 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-16 19:39:05.829616 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-16 19:39:05.862951 (MainThread): Partial parsing not enabled
2020-07-16 19:39:05.908109 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-16 19:39:05.908289 (MainThread): Opening a new connection, currently in state init
2020-07-16 19:39:05.944461 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 19:39:05.944614 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:39:05.959726 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-16 19:39:05.959896 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:39:05.976924 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-16 19:39:05.977083 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:39:06.041544 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-16 19:39:06.041722 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:39:06.489141 (MainThread): Found 4 models, 9 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 2 seed files, 2 sources
2020-07-16 19:39:06.490642 (MainThread): 
2020-07-16 19:39:06.491089 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 19:39:06.491252 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:39:06.498664 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-16 19:39:06.499001 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-16 19:39:06.502303 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-16 19:39:08.730473 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-16 19:39:08.730788 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-16 19:39:08.730945 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-16 19:39:08.891950 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 19:39:08.892121 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:39:08.892451 (MainThread): 15:39:08 | Concurrency: 1 threads (target='dev')
2020-07-16 19:39:08.892616 (MainThread): 15:39:08 | 
2020-07-16 19:39:08.896291 (Thread-1): Began running node model.springml_demo_dbt_project.creditcard
2020-07-16 19:39:08.897602 (Thread-1): 15:39:08 | 1 of 4 START view model springml_demo_dataset.creditcard............. [RUN]
2020-07-16 19:39:08.898008 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-16 19:39:08.898120 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-16 19:39:08.898243 (Thread-1): Compiling model.springml_demo_dbt_project.creditcard
2020-07-16 19:39:08.921315 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-16 19:39:08.921872 (Thread-1): finished collecting timing info
2020-07-16 19:39:08.959684 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-16 19:39:08.960185 (Thread-1): On model.springml_demo_dbt_project.creditcard: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
  OPTIONS()
  as 

select country,

sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,

sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,

sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,

from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
group by country 
having not (Amex_payments = 0 
and	Mastercard_payments = 0 
and	 Visa_payments = 0)
order by (Amex_payments + Mastercard_payments + Visa_payments) desc;


2020-07-16 19:39:09.664906 (Thread-1): finished collecting timing info
2020-07-16 19:39:09.665730 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d563c0f-f1a0-4ea7-abae-e3ae609303b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11299a310>]}
2020-07-16 19:39:09.667226 (Thread-1): 15:39:09 | 1 of 4 OK created view model springml_demo_dataset.creditcard........ [CREATE VIEW in 0.77s]
2020-07-16 19:39:09.667469 (Thread-1): Finished running node model.springml_demo_dbt_project.creditcard
2020-07-16 19:39:09.667672 (Thread-1): Began running node model.springml_demo_dbt_project.gender_count
2020-07-16 19:39:09.668946 (Thread-1): 15:39:09 | 2 of 4 START view model springml_demo_dataset.gender_count........... [RUN]
2020-07-16 19:39:09.669289 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-16 19:39:09.669386 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.creditcard).
2020-07-16 19:39:09.669474 (Thread-1): Compiling model.springml_demo_dbt_project.gender_count
2020-07-16 19:39:09.679115 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 19:39:09.679593 (Thread-1): finished collecting timing info
2020-07-16 19:39:09.684183 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-16 19:39:09.684645 (Thread-1): On model.springml_demo_dbt_project.gender_count: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.gender_count"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count`
  OPTIONS()
  as SELECT 
CURRENT_DATE() as Ingestion_date, 
countif(ad.Gender is not null and ad.Gender="F" ) as Female_count,
countif(ad.Gender is not null and ad.Gender="M" ) as Male_count,
FROM `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data` as ad;


2020-07-16 19:39:10.321581 (Thread-1): finished collecting timing info
2020-07-16 19:39:10.322484 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d563c0f-f1a0-4ea7-abae-e3ae609303b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112aa4c90>]}
2020-07-16 19:39:10.323956 (Thread-1): 15:39:10 | 2 of 4 OK created view model springml_demo_dataset.gender_count...... [CREATE VIEW in 0.65s]
2020-07-16 19:39:10.324131 (Thread-1): Finished running node model.springml_demo_dbt_project.gender_count
2020-07-16 19:39:10.324298 (Thread-1): Began running node model.springml_demo_dbt_project.payments
2020-07-16 19:39:10.325659 (Thread-1): 15:39:10 | 3 of 4 START view model springml_demo_dataset.payments............... [RUN]
2020-07-16 19:39:10.326051 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-16 19:39:10.326161 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.gender_count).
2020-07-16 19:39:10.326262 (Thread-1): Compiling model.springml_demo_dbt_project.payments
2020-07-16 19:39:10.336000 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.payments"
2020-07-16 19:39:10.336492 (Thread-1): finished collecting timing info
2020-07-16 19:39:10.341899 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.payments"
2020-07-16 19:39:10.342382 (Thread-1): On model.springml_demo_dbt_project.payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
  OPTIONS()
  as select payment_type, 
    count(*) as number_of_payments, 
    sum(price) as total_price 
from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where country like "United States"
group by payment_type;


2020-07-16 19:39:11.202660 (Thread-1): finished collecting timing info
2020-07-16 19:39:11.203530 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d563c0f-f1a0-4ea7-abae-e3ae609303b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ae9410>]}
2020-07-16 19:39:11.204786 (Thread-1): 15:39:11 | 3 of 4 OK created view model springml_demo_dataset.payments.......... [CREATE VIEW in 0.88s]
2020-07-16 19:39:11.205022 (Thread-1): Finished running node model.springml_demo_dbt_project.payments
2020-07-16 19:39:11.205198 (Thread-1): Began running node model.springml_demo_dbt_project.redact_fields
2020-07-16 19:39:11.206391 (Thread-1): 15:39:11 | 4 of 4 START view model springml_demo_dataset.redact_fields.......... [RUN]
2020-07-16 19:39:11.207002 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-16 19:39:11.207221 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.payments).
2020-07-16 19:39:11.207349 (Thread-1): Compiling model.springml_demo_dbt_project.redact_fields
2020-07-16 19:39:11.220262 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-16 19:39:11.220727 (Thread-1): finished collecting timing info
2020-07-16 19:39:11.225594 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-16 19:39:11.226104 (Thread-1): On model.springml_demo_dbt_project.redact_fields: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.redact_fields"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields`
  OPTIONS()
  as with source as (
	select * 
	from
		`prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`
),

casted as (
	select
		Employee_no as Emp_no,
		cast(Phone_no as string),
		cast(Social_insurance_no as string)
	from source
),

casted_edited as (
	select
		Emp_no,
		'##ARCHIVED##' as Phone_no,
		'##ARCHIVED##' as Social_insurance_no
	from casted
),

edited as (
	select
		Employee_no,
		'##ARCHIVED##' as Surname,
		'##ARCHIVED##'as Given_name,
		Gender,
		City,
		Age,
		Year_joined
	from	
		source
)

select edited.Employee_no,
edited.Surname,
edited.Given_name,
edited.Gender,
edited.City,
edited.Age,
edited.Year_joined,
casted_edited.Phone_no,
casted_edited.Social_insurance_no
from edited
join casted_edited on edited.Employee_no = casted_edited.Emp_no;


2020-07-16 19:39:12.059928 (Thread-1): finished collecting timing info
2020-07-16 19:39:12.061130 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d563c0f-f1a0-4ea7-abae-e3ae609303b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112728d90>]}
2020-07-16 19:39:12.062535 (Thread-1): 15:39:12 | 4 of 4 OK created view model springml_demo_dataset.redact_fields..... [CREATE VIEW in 0.85s]
2020-07-16 19:39:12.062700 (Thread-1): Finished running node model.springml_demo_dbt_project.redact_fields
2020-07-16 19:39:12.101920 (MainThread): Acquiring new bigquery connection "master".
2020-07-16 19:39:12.102208 (MainThread): Opening a new connection, currently in state closed
2020-07-16 19:39:12.102844 (MainThread): 15:39:12 | 
2020-07-16 19:39:12.103186 (MainThread): 15:39:12 | Finished running 4 view models in 5.61s.
2020-07-16 19:39:12.103441 (MainThread): Connection 'master' was properly closed.
2020-07-16 19:39:12.103558 (MainThread): Connection 'model.springml_demo_dbt_project.redact_fields' was left open.
2020-07-16 19:39:12.125846 (MainThread): 
2020-07-16 19:39:12.126106 (MainThread): Completed successfully
2020-07-16 19:39:12.126316 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-07-16 19:39:12.126603 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127e8e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112979dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112abf2d0>]}
2020-07-16 19:39:12.126813 (MainThread): Flushing usage events
2020-07-23 17:11:07.458996 (MainThread): Running with dbt=0.17.0
2020-07-23 17:11:09.247593 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-23 17:11:09.254291 (MainThread): Tracking: tracking
2020-07-23 17:11:09.305736 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134e2290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134e9c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134e9a90>]}
2020-07-23 17:11:09.333395 (MainThread): Partial parsing not enabled
2020-07-23 17:11:09.336318 (MainThread): Parsing macros/core.sql
2020-07-23 17:11:09.350755 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-23 17:11:09.365070 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-23 17:11:09.368164 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-23 17:11:09.397984 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-23 17:11:09.442619 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-23 17:11:09.469646 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-23 17:11:09.474157 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-23 17:11:09.485000 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-23 17:11:09.503153 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-23 17:11:09.512105 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-23 17:11:09.520339 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-23 17:11:09.526691 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-23 17:11:09.528177 (MainThread): Parsing macros/etc/query.sql
2020-07-23 17:11:09.530159 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-23 17:11:09.533119 (MainThread): Parsing macros/etc/datetime.sql
2020-07-23 17:11:09.544434 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-23 17:11:09.547689 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-23 17:11:09.550903 (MainThread): Parsing macros/adapters/common.sql
2020-07-23 17:11:09.610835 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-23 17:11:09.614522 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-23 17:11:09.617073 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-23 17:11:09.619605 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-23 17:11:09.623056 (MainThread): Parsing macros/etc.sql
2020-07-23 17:11:09.624587 (MainThread): Parsing macros/catalog.sql
2020-07-23 17:11:09.633215 (MainThread): Parsing macros/adapters.sql
2020-07-23 17:11:09.652976 (MainThread): Parsing macros/materializations/seed.sql
2020-07-23 17:11:09.657643 (MainThread): Parsing macros/materializations/view.sql
2020-07-23 17:11:09.661830 (MainThread): Parsing macros/materializations/table.sql
2020-07-23 17:11:09.676870 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-23 17:11:09.699089 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-23 17:11:09.738391 (MainThread): Partial parsing not enabled
2020-07-23 17:11:09.799767 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-23 17:11:09.799936 (MainThread): Opening a new connection, currently in state init
2020-07-23 17:11:09.837464 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-23 17:11:09.837630 (MainThread): Opening a new connection, currently in state closed
2020-07-23 17:11:09.851842 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-23 17:11:09.851990 (MainThread): Opening a new connection, currently in state closed
2020-07-23 17:11:09.866390 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-23 17:11:09.866550 (MainThread): Opening a new connection, currently in state closed
2020-07-23 17:11:09.938110 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-23 17:11:09.938284 (MainThread): Opening a new connection, currently in state closed
2020-07-23 17:11:10.365667 (MainThread): Found 4 models, 9 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 2 seed files, 2 sources
2020-07-23 17:11:10.367106 (MainThread): 
2020-07-23 17:11:10.367556 (MainThread): Acquiring new bigquery connection "master".
2020-07-23 17:11:10.367677 (MainThread): Opening a new connection, currently in state closed
2020-07-23 17:11:10.373762 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-23 17:11:10.373971 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-23 17:11:10.384899 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-23 17:11:14.547527 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-23 17:11:14.547802 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-23 17:11:14.547978 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-23 17:11:14.682724 (MainThread): Acquiring new bigquery connection "master".
2020-07-23 17:11:14.682920 (MainThread): Opening a new connection, currently in state closed
2020-07-23 17:11:14.683307 (MainThread): 13:11:14 | Concurrency: 1 threads (target='dev')
2020-07-23 17:11:14.683506 (MainThread): 13:11:14 | 
2020-07-23 17:11:14.688440 (Thread-1): Began running node model.springml_demo_dbt_project.creditcard
2020-07-23 17:11:14.690016 (Thread-1): 13:11:14 | 1 of 4 START view model springml_demo_dataset.creditcard............. [RUN]
2020-07-23 17:11:14.690465 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-23 17:11:14.690596 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-23 17:11:14.690743 (Thread-1): Compiling model.springml_demo_dbt_project.creditcard
2020-07-23 17:11:14.714724 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-23 17:11:14.717996 (Thread-1): finished collecting timing info
2020-07-23 17:11:14.757051 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-23 17:11:14.757635 (Thread-1): On model.springml_demo_dbt_project.creditcard: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
  OPTIONS()
  as 

select country,

sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,

sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,

sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,

from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
group by country 
having not (Amex_payments = 0 
and	Mastercard_payments = 0 
and	 Visa_payments = 0)
order by (Amex_payments + Mastercard_payments + Visa_payments) desc;


2020-07-23 17:11:15.020114 (Thread-1): Unhandled error while running:
/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
  OPTIONS()
  as 

select country,

sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,

sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,

sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,

from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
group by country 
having not (Amex_payments = 0 
and	Mastercard_payments = 0 
and	 Visa_payments = 0)
order by (Amex_payments + Mastercard_payments + Visa_payments) desc;


2020-07-23 17:11:15.020353 (Thread-1): 404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US

(job ID: 234912b7-4abb-41b8-9929-70ed5a5c22e9)

                                                               -----Query Job SQL Follows-----                                                               

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
   5:  OPTIONS()
   6:  as 
   7:
   8:select country,
   9:
  10:sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,
  11:
  12:sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,
  13:
  14:sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,
  15:
  16:from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
  17:group by country 
  18:having not (Amex_payments = 0 
  19:and	Mastercard_payments = 0 
  20:and	 Visa_payments = 0)
  21:order by (Amex_payments + Mastercard_payments + Visa_payments) desc;
  22:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
2020-07-23 17:11:15.020679 (Thread-1): finished collecting timing info
2020-07-23 17:11:15.021387 (Thread-1): Runtime Error in model creditcard (models/base/creditcard.sql)
  404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
  
  (job ID: 234912b7-4abb-41b8-9929-70ed5a5c22e9)
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 84, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 225, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 352, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 127, in result
    raise self._exception
google.api_core.exceptions.NotFound: 404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US

(job ID: 234912b7-4abb-41b8-9929-70ed5a5c22e9)

                                                               -----Query Job SQL Follows-----                                                               

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
   5:  OPTIONS()
   6:  as 
   7:
   8:select country,
   9:
  10:sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,
  11:
  12:sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,
  13:
  14:sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,
  15:
  16:from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
  17:group by country 
  18:having not (Amex_payments = 0 
  19:and	Mastercard_payments = 0 
  20:and	 Visa_payments = 0)
  21:order by (Amex_payments + Mastercard_payments + Visa_payments) desc;
  22:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 234, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 227, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/Cellar/python/3.7.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error in model creditcard (models/base/creditcard.sql)
  404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
  
  (job ID: 234912b7-4abb-41b8-9929-70ed5a5c22e9)
2020-07-23 17:11:15.070846 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba9c25b9-d6c1-4ffd-9b62-4769e666cf2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11423d650>]}
2020-07-23 17:11:15.072747 (Thread-1): 13:11:15 | 1 of 4 ERROR creating view model springml_demo_dataset.creditcard.... [ERROR in 0.38s]
2020-07-23 17:11:15.072943 (Thread-1): Finished running node model.springml_demo_dbt_project.creditcard
2020-07-23 17:11:15.073157 (Thread-1): Began running node model.springml_demo_dbt_project.gender_count
2020-07-23 17:11:15.074521 (Thread-1): 13:11:15 | 2 of 4 START view model springml_demo_dataset.gender_count........... [RUN]
2020-07-23 17:11:15.074933 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-23 17:11:15.075063 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.creditcard).
2020-07-23 17:11:15.075192 (Thread-1): Compiling model.springml_demo_dbt_project.gender_count
2020-07-23 17:11:15.086257 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-23 17:11:15.088136 (Thread-1): finished collecting timing info
2020-07-23 17:11:15.093375 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-23 17:11:15.093899 (Thread-1): On model.springml_demo_dbt_project.gender_count: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.gender_count"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count`
  OPTIONS()
  as select
    CURRENT_DATE() as Ingestion_date, 
    countif(source.Gender is not null and source.Gender = "F") as Female_count,
    countif(source.Gender is not null and source.Gender = "M") as Male_count,
from 
    `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data` as source;


2020-07-23 17:11:15.703819 (Thread-1): finished collecting timing info
2020-07-23 17:11:15.704498 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba9c25b9-d6c1-4ffd-9b62-4769e666cf2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138a8b50>]}
2020-07-23 17:11:15.705543 (Thread-1): 13:11:15 | 2 of 4 OK created view model springml_demo_dataset.gender_count...... [CREATE VIEW in 0.63s]
2020-07-23 17:11:15.705695 (Thread-1): Finished running node model.springml_demo_dbt_project.gender_count
2020-07-23 17:11:15.705888 (Thread-1): Began running node model.springml_demo_dbt_project.payments
2020-07-23 17:11:15.706935 (Thread-1): 13:11:15 | 3 of 4 START view model springml_demo_dataset.payments............... [RUN]
2020-07-23 17:11:15.707308 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-23 17:11:15.707455 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.gender_count).
2020-07-23 17:11:15.707573 (Thread-1): Compiling model.springml_demo_dbt_project.payments
2020-07-23 17:11:15.720284 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.payments"
2020-07-23 17:11:15.720729 (Thread-1): finished collecting timing info
2020-07-23 17:11:15.725126 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.payments"
2020-07-23 17:11:15.725559 (Thread-1): On model.springml_demo_dbt_project.payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
  OPTIONS()
  as select payment_type, 
    count(*) as number_of_payments, 
    sum(price) as total_price 
from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where country like "United States"
group by payment_type;


2020-07-23 17:11:15.916050 (Thread-1): Unhandled error while running:
/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
  OPTIONS()
  as select payment_type, 
    count(*) as number_of_payments, 
    sum(price) as total_price 
from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where country like "United States"
group by payment_type;


2020-07-23 17:11:15.916313 (Thread-1): 404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US

(job ID: e9e7c269-2817-4346-b4fb-367a7e3196ad)

                                                              -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
   5:  OPTIONS()
   6:  as select payment_type, 
   7:    count(*) as number_of_payments, 
   8:    sum(price) as total_price 
   9:from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
  10:where country like "United States"
  11:group by payment_type;
  12:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
2020-07-23 17:11:15.916639 (Thread-1): finished collecting timing info
2020-07-23 17:11:15.917371 (Thread-1): Runtime Error in model payments (models/base/payments.sql)
  404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
  
  (job ID: e9e7c269-2817-4346-b4fb-367a7e3196ad)
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 84, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 225, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 352, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 127, in result
    raise self._exception
google.api_core.exceptions.NotFound: 404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US

(job ID: e9e7c269-2817-4346-b4fb-367a7e3196ad)

                                                              -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
   5:  OPTIONS()
   6:  as select payment_type, 
   7:    count(*) as number_of_payments, 
   8:    sum(price) as total_price 
   9:from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
  10:where country like "United States"
  11:group by payment_type;
  12:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 234, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 227, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/Cellar/python/3.7.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error in model payments (models/base/payments.sql)
  404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
  
  (job ID: e9e7c269-2817-4346-b4fb-367a7e3196ad)
2020-07-23 17:11:15.918412 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba9c25b9-d6c1-4ffd-9b62-4769e666cf2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143284d0>]}
2020-07-23 17:11:15.919954 (Thread-1): 13:11:15 | 3 of 4 ERROR creating view model springml_demo_dataset.payments...... [ERROR in 0.21s]
2020-07-23 17:11:15.920141 (Thread-1): Finished running node model.springml_demo_dbt_project.payments
2020-07-23 17:11:15.920447 (Thread-1): Began running node model.springml_demo_dbt_project.redact_fields
2020-07-23 17:11:15.922518 (Thread-1): 13:11:15 | 4 of 4 START view model springml_demo_dataset.redact_fields.......... [RUN]
2020-07-23 17:11:15.923004 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-23 17:11:15.923142 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.payments).
2020-07-23 17:11:15.923270 (Thread-1): Compiling model.springml_demo_dbt_project.redact_fields
2020-07-23 17:11:15.937286 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-23 17:11:15.937770 (Thread-1): finished collecting timing info
2020-07-23 17:11:15.942498 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-23 17:11:15.943019 (Thread-1): On model.springml_demo_dbt_project.redact_fields: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.redact_fields"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields`
  OPTIONS()
  as with source as (
	select * 
	from
		`prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`
),

casted as (
	select
		Employee_no as Emp_no,
		cast(Phone_no as string),
		cast(Social_insurance_no as string)
	from source
),

casted_redacted as (
	select
		Emp_no,
		'##ARCHIVED##' as Phone_no,
		'##ARCHIVED##' as Social_insurance_no
	from casted
),

redacted as (
	select
		Employee_no,
		'##ARCHIVED##' as Surname,
		'##ARCHIVED##'as Given_name,
		Gender,
		City,
		Age,
		Year_joined
	from	
		source
)

select 
	redacted.Employee_no,
	redacted.Surname,
	redacted.Given_name,
	redacted.Gender,
	redacted.City,
	redacted.Age,
	redacted.Year_joined,
	casted_redacted.Phone_no,
	casted_redacted.Social_insurance_no
from 
	redacted
join 
	casted_redacted 
		on redacted.Employee_no = casted_redacted.Emp_no;


2020-07-23 17:11:16.572849 (Thread-1): finished collecting timing info
2020-07-23 17:11:16.577078 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba9c25b9-d6c1-4ffd-9b62-4769e666cf2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114325850>]}
2020-07-23 17:11:16.578437 (Thread-1): 13:11:16 | 4 of 4 OK created view model springml_demo_dataset.redact_fields..... [CREATE VIEW in 0.65s]
2020-07-23 17:11:16.578630 (Thread-1): Finished running node model.springml_demo_dbt_project.redact_fields
2020-07-23 17:11:16.633544 (MainThread): Acquiring new bigquery connection "master".
2020-07-23 17:11:16.633796 (MainThread): Opening a new connection, currently in state closed
2020-07-23 17:11:16.634314 (MainThread): 13:11:16 | 
2020-07-23 17:11:16.634555 (MainThread): 13:11:16 | Finished running 4 view models in 6.27s.
2020-07-23 17:11:16.634908 (MainThread): Connection 'master' was properly closed.
2020-07-23 17:11:16.635138 (MainThread): Connection 'model.springml_demo_dbt_project.redact_fields' was left open.
2020-07-23 17:11:16.653295 (MainThread): 
2020-07-23 17:11:16.653486 (MainThread): Completed with 2 errors and 0 warnings:
2020-07-23 17:11:16.653640 (MainThread): 
2020-07-23 17:11:16.653837 (MainThread): Runtime Error in model creditcard (models/base/creditcard.sql)
2020-07-23 17:11:16.653961 (MainThread):   404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
2020-07-23 17:11:16.654063 (MainThread):   
2020-07-23 17:11:16.654172 (MainThread):   (job ID: 234912b7-4abb-41b8-9929-70ed5a5c22e9)
2020-07-23 17:11:16.654283 (MainThread): 
2020-07-23 17:11:16.654403 (MainThread): Runtime Error in model payments (models/base/payments.sql)
2020-07-23 17:11:16.654512 (MainThread):   404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
2020-07-23 17:11:16.654608 (MainThread):   
2020-07-23 17:11:16.654709 (MainThread):   (job ID: e9e7c269-2817-4346-b4fb-367a7e3196ad)
2020-07-23 17:11:16.654826 (MainThread): 
Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
2020-07-23 17:11:16.655049 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136be550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114307cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114307590>]}
2020-07-23 17:11:16.655250 (MainThread): Flushing usage events
2020-07-23 17:11:41.091144 (MainThread): Running with dbt=0.17.0
2020-07-23 17:11:42.142181 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['applicant'], partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-23 17:11:42.144048 (MainThread): Tracking: tracking
2020-07-23 17:11:42.160837 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e86c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11349af10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e86790>]}
2020-07-23 17:11:42.188609 (MainThread): Partial parsing not enabled
2020-07-23 17:11:42.191387 (MainThread): Parsing macros/core.sql
2020-07-23 17:11:42.198469 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-23 17:11:42.208722 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-23 17:11:42.212885 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-23 17:11:42.242531 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-23 17:11:42.284469 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-23 17:11:42.314190 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-23 17:11:42.316940 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-23 17:11:42.326017 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-23 17:11:42.345271 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-23 17:11:42.354439 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-23 17:11:42.367188 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-23 17:11:42.375014 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-23 17:11:42.376764 (MainThread): Parsing macros/etc/query.sql
2020-07-23 17:11:42.378624 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-23 17:11:42.381123 (MainThread): Parsing macros/etc/datetime.sql
2020-07-23 17:11:42.392561 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-23 17:11:42.395421 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-23 17:11:42.397718 (MainThread): Parsing macros/adapters/common.sql
2020-07-23 17:11:42.459428 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-23 17:11:42.461645 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-23 17:11:42.463319 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-23 17:11:42.465454 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-23 17:11:42.480374 (MainThread): Parsing macros/etc.sql
2020-07-23 17:11:42.482569 (MainThread): Parsing macros/catalog.sql
2020-07-23 17:11:42.493184 (MainThread): Parsing macros/adapters.sql
2020-07-23 17:11:42.516832 (MainThread): Parsing macros/materializations/seed.sql
2020-07-23 17:11:42.520382 (MainThread): Parsing macros/materializations/view.sql
2020-07-23 17:11:42.523639 (MainThread): Parsing macros/materializations/table.sql
2020-07-23 17:11:42.537990 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-23 17:11:42.554014 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-23 17:11:42.578952 (MainThread): Partial parsing not enabled
2020-07-23 17:11:42.622251 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-23 17:11:42.622412 (MainThread): Opening a new connection, currently in state init
2020-07-23 17:11:42.657810 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-23 17:11:42.657966 (MainThread): Opening a new connection, currently in state closed
2020-07-23 17:11:42.671683 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-23 17:11:42.671831 (MainThread): Opening a new connection, currently in state closed
2020-07-23 17:11:42.685862 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-23 17:11:42.686062 (MainThread): Opening a new connection, currently in state closed
2020-07-23 17:11:42.751269 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-23 17:11:42.751460 (MainThread): Opening a new connection, currently in state closed
2020-07-23 17:11:43.189345 (MainThread): Found 4 models, 9 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 2 seed files, 2 sources
2020-07-23 17:11:43.190566 (MainThread): 
2020-07-23 17:11:43.191058 (MainThread): Acquiring new bigquery connection "master".
2020-07-23 17:11:43.191177 (MainThread): Opening a new connection, currently in state closed
2020-07-23 17:11:43.195603 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-23 17:11:43.195891 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-23 17:11:43.198597 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-23 17:11:44.900459 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-23 17:11:44.900749 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-23 17:11:44.900952 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-23 17:11:45.112986 (MainThread): Acquiring new bigquery connection "master".
2020-07-23 17:11:45.113179 (MainThread): Opening a new connection, currently in state closed
2020-07-23 17:11:45.113577 (MainThread): 13:11:45 | Concurrency: 1 threads (target='dev')
2020-07-23 17:11:45.113774 (MainThread): 13:11:45 | 
2020-07-23 17:11:45.118317 (Thread-1): Began running node model.springml_demo_dbt_project.gender_count
2020-07-23 17:11:45.119903 (Thread-1): 13:11:45 | 1 of 2 START view model springml_demo_dataset.gender_count........... [RUN]
2020-07-23 17:11:45.120371 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-23 17:11:45.120505 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-23 17:11:45.120658 (Thread-1): Compiling model.springml_demo_dbt_project.gender_count
2020-07-23 17:11:45.142718 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-23 17:11:45.143900 (Thread-1): finished collecting timing info
2020-07-23 17:11:45.181430 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-23 17:11:45.182400 (Thread-1): On model.springml_demo_dbt_project.gender_count: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.gender_count"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count`
  OPTIONS()
  as select
    CURRENT_DATE() as Ingestion_date, 
    countif(source.Gender is not null and source.Gender = "F") as Female_count,
    countif(source.Gender is not null and source.Gender = "M") as Male_count,
from 
    `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data` as source;


2020-07-23 17:11:45.830257 (Thread-1): finished collecting timing info
2020-07-23 17:11:45.831152 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '481261a8-5071-4a70-af9d-0fbe7f3c4a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11293b3d0>]}
2020-07-23 17:11:45.832737 (Thread-1): 13:11:45 | 1 of 2 OK created view model springml_demo_dataset.gender_count...... [CREATE VIEW in 0.71s]
2020-07-23 17:11:45.833024 (Thread-1): Finished running node model.springml_demo_dbt_project.gender_count
2020-07-23 17:11:45.833303 (Thread-1): Began running node model.springml_demo_dbt_project.redact_fields
2020-07-23 17:11:45.834727 (Thread-1): 13:11:45 | 2 of 2 START view model springml_demo_dataset.redact_fields.......... [RUN]
2020-07-23 17:11:45.835564 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-23 17:11:45.835778 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.gender_count).
2020-07-23 17:11:45.835909 (Thread-1): Compiling model.springml_demo_dbt_project.redact_fields
2020-07-23 17:11:45.855036 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-23 17:11:45.855633 (Thread-1): finished collecting timing info
2020-07-23 17:11:45.864103 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-23 17:11:45.864747 (Thread-1): On model.springml_demo_dbt_project.redact_fields: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.redact_fields"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields`
  OPTIONS()
  as with source as (
	select * 
	from
		`prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`
),

casted as (
	select
		Employee_no as Emp_no,
		cast(Phone_no as string),
		cast(Social_insurance_no as string)
	from source
),

casted_redacted as (
	select
		Emp_no,
		'##ARCHIVED##' as Phone_no,
		'##ARCHIVED##' as Social_insurance_no
	from casted
),

redacted as (
	select
		Employee_no,
		'##ARCHIVED##' as Surname,
		'##ARCHIVED##'as Given_name,
		Gender,
		City,
		Age,
		Year_joined
	from	
		source
)

select 
	redacted.Employee_no,
	redacted.Surname,
	redacted.Given_name,
	redacted.Gender,
	redacted.City,
	redacted.Age,
	redacted.Year_joined,
	casted_redacted.Phone_no,
	casted_redacted.Social_insurance_no
from 
	redacted
join 
	casted_redacted 
		on redacted.Employee_no = casted_redacted.Emp_no;


2020-07-23 17:11:46.538286 (Thread-1): finished collecting timing info
2020-07-23 17:11:46.538969 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '481261a8-5071-4a70-af9d-0fbe7f3c4a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115c6ce10>]}
2020-07-23 17:11:46.540191 (Thread-1): 13:11:46 | 2 of 2 OK created view model springml_demo_dataset.redact_fields..... [CREATE VIEW in 0.70s]
2020-07-23 17:11:46.540373 (Thread-1): Finished running node model.springml_demo_dbt_project.redact_fields
2020-07-23 17:11:46.567346 (MainThread): Acquiring new bigquery connection "master".
2020-07-23 17:11:46.567597 (MainThread): Opening a new connection, currently in state closed
2020-07-23 17:11:46.568111 (MainThread): 13:11:46 | 
2020-07-23 17:11:46.568365 (MainThread): 13:11:46 | Finished running 2 view models in 3.38s.
2020-07-23 17:11:46.568568 (MainThread): Connection 'master' was properly closed.
2020-07-23 17:11:46.568714 (MainThread): Connection 'model.springml_demo_dbt_project.redact_fields' was left open.
2020-07-23 17:11:46.581894 (MainThread): 
2020-07-23 17:11:46.582203 (MainThread): Completed successfully
2020-07-23 17:11:46.582430 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-07-23 17:11:46.582776 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1153c5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115c6f050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1152e1750>]}
2020-07-23 17:11:46.583096 (MainThread): Flushing usage events
2020-07-23 19:06:49.648308 (MainThread): Running with dbt=0.17.0
2020-07-23 19:06:51.572739 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['applicant'], partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-23 19:06:51.580669 (MainThread): Tracking: tracking
2020-07-23 19:06:51.616622 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116416f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1163ce490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11641ba50>]}
2020-07-23 19:06:51.650853 (MainThread): Partial parsing not enabled
2020-07-23 19:06:51.653777 (MainThread): Parsing macros/core.sql
2020-07-23 19:06:51.660567 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-23 19:06:51.670809 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-23 19:06:51.679769 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-23 19:06:51.709531 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-23 19:06:51.747662 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-23 19:06:51.774947 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-23 19:06:51.777691 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-23 19:06:51.786437 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-23 19:06:51.804928 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-23 19:06:51.815005 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-23 19:06:51.823129 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-23 19:06:51.830790 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-23 19:06:51.832297 (MainThread): Parsing macros/etc/query.sql
2020-07-23 19:06:51.833902 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-23 19:06:51.836212 (MainThread): Parsing macros/etc/datetime.sql
2020-07-23 19:06:51.847455 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-23 19:06:51.850718 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-23 19:06:51.853800 (MainThread): Parsing macros/adapters/common.sql
2020-07-23 19:06:51.914926 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-23 19:06:51.917695 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-23 19:06:51.920082 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-23 19:06:51.922886 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-23 19:06:51.927666 (MainThread): Parsing macros/etc.sql
2020-07-23 19:06:51.929509 (MainThread): Parsing macros/catalog.sql
2020-07-23 19:06:51.938563 (MainThread): Parsing macros/adapters.sql
2020-07-23 19:06:51.963476 (MainThread): Parsing macros/materializations/seed.sql
2020-07-23 19:06:51.967730 (MainThread): Parsing macros/materializations/view.sql
2020-07-23 19:06:51.971594 (MainThread): Parsing macros/materializations/table.sql
2020-07-23 19:06:51.985897 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-23 19:06:52.003465 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-23 19:06:52.045894 (MainThread): Partial parsing not enabled
2020-07-23 19:06:52.110153 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-23 19:06:52.110355 (MainThread): Opening a new connection, currently in state init
2020-07-23 19:06:52.145155 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-23 19:06:52.145311 (MainThread): Opening a new connection, currently in state closed
2020-07-23 19:06:52.159661 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-23 19:06:52.159825 (MainThread): Opening a new connection, currently in state closed
2020-07-23 19:06:52.176142 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-23 19:06:52.176310 (MainThread): Opening a new connection, currently in state closed
2020-07-23 19:06:52.250393 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-23 19:06:52.250563 (MainThread): Opening a new connection, currently in state closed
2020-07-23 19:06:52.715848 (MainThread): Found 4 models, 9 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 2 seed files, 2 sources
2020-07-23 19:06:52.718086 (MainThread): 
2020-07-23 19:06:52.718715 (MainThread): Acquiring new bigquery connection "master".
2020-07-23 19:06:52.718874 (MainThread): Opening a new connection, currently in state closed
2020-07-23 19:06:52.723347 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-23 19:06:52.723642 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-23 19:06:52.726502 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-23 19:06:55.963397 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-23 19:06:55.963727 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-23 19:06:55.963947 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-23 19:06:56.104577 (MainThread): Acquiring new bigquery connection "master".
2020-07-23 19:06:56.104793 (MainThread): Opening a new connection, currently in state closed
2020-07-23 19:06:56.105216 (MainThread): 15:06:56 | Concurrency: 1 threads (target='dev')
2020-07-23 19:06:56.105425 (MainThread): 15:06:56 | 
2020-07-23 19:06:56.108710 (Thread-1): Began running node model.springml_demo_dbt_project.gender_count
2020-07-23 19:06:56.110154 (Thread-1): 15:06:56 | 1 of 2 START table model springml_demo_dataset.gender_count.......... [RUN]
2020-07-23 19:06:56.110602 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-23 19:06:56.110724 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-23 19:06:56.110859 (Thread-1): Compiling model.springml_demo_dbt_project.gender_count
2020-07-23 19:06:56.134296 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-23 19:06:56.135885 (Thread-1): finished collecting timing info
2020-07-23 19:06:56.167057 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-23 19:06:56.316526 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-23 19:06:56.457135 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-23 19:06:56.457714 (Thread-1): On model.springml_demo_dbt_project.gender_count: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.gender_count"} */


  create or replace table `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count`
  
  
  OPTIONS()
  as (
    select
    CURRENT_DATE() as Ingestion_date, 
    countif(source.Gender is not null and source.Gender = "F") as Female_count,
    countif(source.Gender is not null and source.Gender = "M") as Male_count,
from 
    `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data` as source
  );
    
2020-07-23 19:06:58.743118 (Thread-1): finished collecting timing info
2020-07-23 19:06:58.745933 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c859773-f625-41e2-9c92-0e503a83be1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1165e9410>]}
2020-07-23 19:06:58.747654 (Thread-1): 15:06:58 | 1 of 2 OK created table model springml_demo_dataset.gender_count..... [CREATE TABLE (1) in 2.64s]
2020-07-23 19:06:58.747858 (Thread-1): Finished running node model.springml_demo_dbt_project.gender_count
2020-07-23 19:06:58.748147 (Thread-1): Began running node model.springml_demo_dbt_project.redact_fields
2020-07-23 19:06:58.749305 (Thread-1): 15:06:58 | 2 of 2 START table model springml_demo_dataset.redact_fields......... [RUN]
2020-07-23 19:06:58.749692 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-23 19:06:58.749917 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.gender_count).
2020-07-23 19:06:58.750048 (Thread-1): Compiling model.springml_demo_dbt_project.redact_fields
2020-07-23 19:06:58.762126 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-23 19:06:58.762669 (Thread-1): finished collecting timing info
2020-07-23 19:06:58.767089 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-23 19:06:59.008214 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-23 19:06:59.150054 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-23 19:06:59.151128 (Thread-1): On model.springml_demo_dbt_project.redact_fields: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.redact_fields"} */


  create or replace table `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields`
  
  
  OPTIONS()
  as (
    with source as (
	select * 
	from
		`prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`
),

casted as (
	select
		Employee_no as Emp_no,
		cast(Phone_no as string),
		cast(Social_insurance_no as string)
	from source
),

casted_redacted as (
	select
		Emp_no,
		'##ARCHIVED##' as Phone_no,
		'##ARCHIVED##' as Social_insurance_no
	from casted
),

redacted as (
	select
		Employee_no,
		'##ARCHIVED##' as Surname,
		'##ARCHIVED##'as Given_name,
		Gender,
		City,
		Age,
		Year_joined
	from	
		source
)

select 
	redacted.Employee_no,
	redacted.Surname,
	redacted.Given_name,
	redacted.Gender,
	redacted.City,
	redacted.Age,
	redacted.Year_joined,
	casted_redacted.Phone_no,
	casted_redacted.Social_insurance_no
from 
	redacted
join 
	casted_redacted 
		on redacted.Employee_no = casted_redacted.Emp_no
  );
    
2020-07-23 19:07:02.726157 (Thread-1): finished collecting timing info
2020-07-23 19:07:02.727225 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c859773-f625-41e2-9c92-0e503a83be1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11692cc10>]}
2020-07-23 19:07:02.728742 (Thread-1): 15:07:02 | 2 of 2 OK created table model springml_demo_dataset.redact_fields.... [CREATE TABLE (8336) in 3.98s]
2020-07-23 19:07:02.728934 (Thread-1): Finished running node model.springml_demo_dbt_project.redact_fields
2020-07-23 19:07:02.769394 (MainThread): Acquiring new bigquery connection "master".
2020-07-23 19:07:02.769712 (MainThread): Opening a new connection, currently in state closed
2020-07-23 19:07:02.770430 (MainThread): 15:07:02 | 
2020-07-23 19:07:02.770748 (MainThread): 15:07:02 | Finished running 2 table models in 10.05s.
2020-07-23 19:07:02.771008 (MainThread): Connection 'master' was properly closed.
2020-07-23 19:07:02.771202 (MainThread): Connection 'model.springml_demo_dbt_project.redact_fields' was left open.
2020-07-23 19:07:02.784589 (MainThread): 
2020-07-23 19:07:02.784814 (MainThread): Completed successfully
2020-07-23 19:07:02.785030 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-07-23 19:07:02.785325 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1169435d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116949d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116949c90>]}
2020-07-23 19:07:02.785591 (MainThread): Flushing usage events
2020-07-30 16:58:03.907184 (MainThread): Running with dbt=0.17.0
2020-07-30 16:58:06.168973 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['applicant'], partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-30 16:58:06.171543 (MainThread): Tracking: tracking
2020-07-30 16:58:06.214987 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a12c710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117bfde10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a173d50>]}
2020-07-30 16:58:06.246487 (MainThread): Partial parsing not enabled
2020-07-30 16:58:06.249967 (MainThread): Parsing macros/core.sql
2020-07-30 16:58:06.257785 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-30 16:58:06.271075 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-30 16:58:06.275104 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-30 16:58:06.298452 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-30 16:58:06.334668 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-30 16:58:06.361779 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-30 16:58:06.365151 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-30 16:58:06.373719 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-30 16:58:06.390703 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-30 16:58:06.400577 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-30 16:58:06.413210 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-30 16:58:06.423430 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-30 16:58:06.425323 (MainThread): Parsing macros/etc/query.sql
2020-07-30 16:58:06.427372 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-30 16:58:06.430225 (MainThread): Parsing macros/etc/datetime.sql
2020-07-30 16:58:06.441604 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-30 16:58:06.444722 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-30 16:58:06.447762 (MainThread): Parsing macros/adapters/common.sql
2020-07-30 16:58:06.507114 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-30 16:58:06.510308 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-30 16:58:06.512438 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-30 16:58:06.514810 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-30 16:58:06.519416 (MainThread): Parsing macros/etc.sql
2020-07-30 16:58:06.521143 (MainThread): Parsing macros/catalog.sql
2020-07-30 16:58:06.530182 (MainThread): Parsing macros/adapters.sql
2020-07-30 16:58:06.552947 (MainThread): Parsing macros/materializations/seed.sql
2020-07-30 16:58:06.556377 (MainThread): Parsing macros/materializations/view.sql
2020-07-30 16:58:06.559348 (MainThread): Parsing macros/materializations/table.sql
2020-07-30 16:58:06.572819 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-30 16:58:06.589554 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-30 16:58:06.622081 (MainThread): Partial parsing not enabled
2020-07-30 16:58:06.696686 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-30 16:58:06.696885 (MainThread): Opening a new connection, currently in state init
2020-07-30 16:58:06.732337 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-30 16:58:06.732511 (MainThread): Opening a new connection, currently in state closed
2020-07-30 16:58:06.747869 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-30 16:58:06.748064 (MainThread): Opening a new connection, currently in state closed
2020-07-30 16:58:06.764014 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-30 16:58:06.764163 (MainThread): Opening a new connection, currently in state closed
2020-07-30 16:58:06.841947 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-30 16:58:06.842164 (MainThread): Opening a new connection, currently in state closed
2020-07-30 16:58:07.288444 (MainThread): Found 4 models, 9 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 2 seed files, 2 sources
2020-07-30 16:58:07.293237 (MainThread): 
2020-07-30 16:58:07.293706 (MainThread): Acquiring new bigquery connection "master".
2020-07-30 16:58:07.293819 (MainThread): Opening a new connection, currently in state closed
2020-07-30 16:58:07.297359 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-30 16:58:07.297497 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-30 16:58:07.326625 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-30 16:58:11.986767 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-30 16:58:11.987098 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-30 16:58:11.987368 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-30 16:58:12.143423 (MainThread): Acquiring new bigquery connection "master".
2020-07-30 16:58:12.143708 (MainThread): Opening a new connection, currently in state closed
2020-07-30 16:58:12.144283 (MainThread): 12:58:12 | Concurrency: 1 threads (target='dev')
2020-07-30 16:58:12.144528 (MainThread): 12:58:12 | 
2020-07-30 16:58:12.147511 (Thread-1): Began running node model.springml_demo_dbt_project.gender_count
2020-07-30 16:58:12.149553 (Thread-1): 12:58:12 | 1 of 2 START table model springml_demo_dataset.gender_count.......... [RUN]
2020-07-30 16:58:12.150213 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-30 16:58:12.150410 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-30 16:58:12.150618 (Thread-1): Compiling model.springml_demo_dbt_project.gender_count
2020-07-30 16:58:12.180129 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-30 16:58:12.194639 (Thread-1): finished collecting timing info
2020-07-30 16:58:12.230774 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-30 16:58:12.428317 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-30 16:58:12.430760 (Thread-1): On model.springml_demo_dbt_project.gender_count: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.gender_count"} */


  create or replace table `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count`
  
  
  OPTIONS()
  as (
    select
    CURRENT_DATE() as Ingestion_date, 
    countif(source.Gender is not null and source.Gender = "F") as Female_count,
    countif(source.Gender is not null and source.Gender = "M") as Male_count,
from 
    `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data` as source
  );
    
2020-07-30 16:58:14.929169 (Thread-1): finished collecting timing info
2020-07-30 16:58:14.930044 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '472d9326-3603-4e21-a29f-75fbbbe499cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a383550>]}
2020-07-30 16:58:14.931383 (Thread-1): 12:58:14 | 1 of 2 OK created table model springml_demo_dataset.gender_count..... [CREATE TABLE (1) in 2.78s]
2020-07-30 16:58:14.931549 (Thread-1): Finished running node model.springml_demo_dbt_project.gender_count
2020-07-30 16:58:14.931718 (Thread-1): Began running node model.springml_demo_dbt_project.redact_fields
2020-07-30 16:58:14.932968 (Thread-1): 12:58:14 | 2 of 2 START table model springml_demo_dataset.redact_fields......... [RUN]
2020-07-30 16:58:14.933346 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-30 16:58:14.933456 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.gender_count).
2020-07-30 16:58:14.933560 (Thread-1): Compiling model.springml_demo_dbt_project.redact_fields
2020-07-30 16:58:14.944733 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-30 16:58:14.945218 (Thread-1): finished collecting timing info
2020-07-30 16:58:14.949589 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-30 16:58:15.124064 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-30 16:58:15.124741 (Thread-1): On model.springml_demo_dbt_project.redact_fields: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.redact_fields"} */


  create or replace table `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields`
  
  
  OPTIONS()
  as (
    with source as (
	select * 
	from
		`prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`
),

casted as (
	select
		Employee_no as Emp_no,
		cast(Phone_no as string),
		cast(Social_insurance_no as string)
	from source
),

casted_redacted as (
	select
		Emp_no,
		'##ARCHIVED##' as Phone_no,
		'##ARCHIVED##' as Social_insurance_no
	from casted
),

redacted as (
	select
		Employee_no,
		'##ARCHIVED##' as Surname,
		'##ARCHIVED##'as Given_name,
		Gender,
		City,
		Age,
		Year_joined
	from	
		source
)

select 
	redacted.Employee_no,
	redacted.Surname,
	redacted.Given_name,
	redacted.Gender,
	redacted.City,
	redacted.Age,
	redacted.Year_joined,
	casted_redacted.Phone_no,
	casted_redacted.Social_insurance_no
from 
	redacted
join 
	casted_redacted 
		on redacted.Employee_no = casted_redacted.Emp_no
  );
    
2020-07-30 16:58:17.737328 (Thread-1): finished collecting timing info
2020-07-30 16:58:17.738317 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '472d9326-3603-4e21-a29f-75fbbbe499cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a690dd0>]}
2020-07-30 16:58:17.739567 (Thread-1): 12:58:17 | 2 of 2 OK created table model springml_demo_dataset.redact_fields.... [CREATE TABLE (8336) in 2.80s]
2020-07-30 16:58:17.739728 (Thread-1): Finished running node model.springml_demo_dbt_project.redact_fields
2020-07-30 16:58:17.825802 (MainThread): Acquiring new bigquery connection "master".
2020-07-30 16:58:17.826070 (MainThread): Opening a new connection, currently in state closed
2020-07-30 16:58:17.826593 (MainThread): 12:58:17 | 
2020-07-30 16:58:17.826840 (MainThread): 12:58:17 | Finished running 2 table models in 10.53s.
2020-07-30 16:58:17.827064 (MainThread): Connection 'master' was properly closed.
2020-07-30 16:58:17.827225 (MainThread): Connection 'model.springml_demo_dbt_project.redact_fields' was left open.
2020-07-30 16:58:17.839324 (MainThread): 
2020-07-30 16:58:17.839670 (MainThread): Completed successfully
2020-07-30 16:58:17.840090 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-07-30 16:58:17.840563 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a3de550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a69ab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a690dd0>]}
2020-07-30 16:58:17.840877 (MainThread): Flushing usage events
2020-07-30 17:03:30.078861 (MainThread): Running with dbt=0.17.0
2020-07-30 17:03:31.108343 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['applicant'], partial_parse=None, profile='springml', profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-30 17:03:31.117347 (MainThread): Tracking: tracking
2020-07-30 17:03:31.140990 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e94db10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e997bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9979d0>]}
2020-07-30 17:03:31.178321 (MainThread): Partial parsing not enabled
2020-07-30 17:03:31.181208 (MainThread): Parsing macros/core.sql
2020-07-30 17:03:31.188228 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-30 17:03:31.198903 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-30 17:03:31.202043 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-30 17:03:31.228867 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-30 17:03:31.265122 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-30 17:03:31.292157 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-30 17:03:31.296330 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-30 17:03:31.306280 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-30 17:03:31.324411 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-30 17:03:31.334222 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-30 17:03:31.343392 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-30 17:03:31.350378 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-30 17:03:31.352580 (MainThread): Parsing macros/etc/query.sql
2020-07-30 17:03:31.354535 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-30 17:03:31.357362 (MainThread): Parsing macros/etc/datetime.sql
2020-07-30 17:03:31.368966 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-30 17:03:31.372328 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-30 17:03:31.375277 (MainThread): Parsing macros/adapters/common.sql
2020-07-30 17:03:31.434230 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-30 17:03:31.436331 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-30 17:03:31.437820 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-30 17:03:31.439579 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-30 17:03:31.442892 (MainThread): Parsing macros/etc.sql
2020-07-30 17:03:31.443982 (MainThread): Parsing macros/catalog.sql
2020-07-30 17:03:31.451787 (MainThread): Parsing macros/adapters.sql
2020-07-30 17:03:31.473051 (MainThread): Parsing macros/materializations/seed.sql
2020-07-30 17:03:31.476944 (MainThread): Parsing macros/materializations/view.sql
2020-07-30 17:03:31.481164 (MainThread): Parsing macros/materializations/table.sql
2020-07-30 17:03:31.497315 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-30 17:03:31.513861 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-30 17:03:31.547441 (MainThread): Partial parsing not enabled
2020-07-30 17:03:31.601995 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-30 17:03:31.602179 (MainThread): Opening a new connection, currently in state init
2020-07-30 17:03:31.637082 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-30 17:03:31.637248 (MainThread): Opening a new connection, currently in state closed
2020-07-30 17:03:31.651358 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-30 17:03:31.651509 (MainThread): Opening a new connection, currently in state closed
2020-07-30 17:03:31.666534 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-30 17:03:31.666697 (MainThread): Opening a new connection, currently in state closed
2020-07-30 17:03:31.728441 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-30 17:03:31.728629 (MainThread): Opening a new connection, currently in state closed
2020-07-30 17:03:32.162155 (MainThread): Found 4 models, 9 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 2 seed files, 2 sources
2020-07-30 17:03:32.163440 (MainThread): 
2020-07-30 17:03:32.163989 (MainThread): Acquiring new bigquery connection "master".
2020-07-30 17:03:32.164144 (MainThread): Opening a new connection, currently in state closed
2020-07-30 17:03:32.169686 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-30 17:03:32.169967 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-30 17:03:32.173847 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-30 17:03:34.194518 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-30 17:03:34.194803 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-30 17:03:34.194982 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-30 17:03:34.389377 (MainThread): Acquiring new bigquery connection "master".
2020-07-30 17:03:34.389566 (MainThread): Opening a new connection, currently in state closed
2020-07-30 17:03:34.389962 (MainThread): 13:03:34 | Concurrency: 1 threads (target='dev')
2020-07-30 17:03:34.390159 (MainThread): 13:03:34 | 
2020-07-30 17:03:34.394311 (Thread-1): Began running node model.springml_demo_dbt_project.gender_count
2020-07-30 17:03:34.395808 (Thread-1): 13:03:34 | 1 of 2 START table model springml_demo_dataset.gender_count.......... [RUN]
2020-07-30 17:03:34.396225 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-30 17:03:34.396344 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-30 17:03:34.396468 (Thread-1): Compiling model.springml_demo_dbt_project.gender_count
2020-07-30 17:03:34.420809 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-30 17:03:34.422759 (Thread-1): finished collecting timing info
2020-07-30 17:03:34.450903 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-30 17:03:34.635905 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-30 17:03:34.636434 (Thread-1): On model.springml_demo_dbt_project.gender_count: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.gender_count"} */


  create or replace table `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count`
  
  
  OPTIONS()
  as (
    select
    CURRENT_DATE() as Ingestion_date, 
    countif(source.Gender is not null and source.Gender = "F") as Female_num_count,
    countif(source.Gender is not null and source.Gender = "M") as Male_num_count,
from 
    `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data` as source
  );
    
2020-07-30 17:03:37.437933 (Thread-1): finished collecting timing info
2020-07-30 17:03:37.438788 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c07e8876-760e-4761-98a8-b6aae74ecc82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecd8590>]}
2020-07-30 17:03:37.440092 (Thread-1): 13:03:37 | 1 of 2 OK created table model springml_demo_dataset.gender_count..... [CREATE TABLE (1) in 3.04s]
2020-07-30 17:03:37.440269 (Thread-1): Finished running node model.springml_demo_dbt_project.gender_count
2020-07-30 17:03:37.440483 (Thread-1): Began running node model.springml_demo_dbt_project.redact_fields
2020-07-30 17:03:37.441642 (Thread-1): 13:03:37 | 2 of 2 START table model springml_demo_dataset.redact_fields......... [RUN]
2020-07-30 17:03:37.442002 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-30 17:03:37.442108 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.gender_count).
2020-07-30 17:03:37.442215 (Thread-1): Compiling model.springml_demo_dbt_project.redact_fields
2020-07-30 17:03:37.453530 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-30 17:03:37.455926 (Thread-1): finished collecting timing info
2020-07-30 17:03:37.461533 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-30 17:03:37.634726 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-30 17:03:37.635410 (Thread-1): On model.springml_demo_dbt_project.redact_fields: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.redact_fields"} */


  create or replace table `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields`
  
  
  OPTIONS()
  as (
    with source as (
	select * 
	from
		`prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`
),

casted as (
	select
		Employee_no as Emp_no,
		cast(Phone_no as string),
		cast(Social_insurance_no as string)
	from source
),

casted_redacted as (
	select
		Emp_no,
		'##ARCHIVED##' as Phone_no,
		'##ARCHIVED##' as Social_insurance_no
	from casted
),

redacted as (
	select
		Employee_no,
		'##ARCHIVED##' as Surname,
		'##ARCHIVED##'as Given_name,
		Gender,
		City,
		Age,
		Year_joined
	from	
		source
)

select 
	redacted.Employee_no,
	redacted.Surname,
	redacted.Given_name,
	redacted.Gender,
	redacted.City,
	redacted.Age,
	redacted.Year_joined,
	casted_redacted.Phone_no,
	casted_redacted.Social_insurance_no
from 
	redacted
join 
	casted_redacted 
		on redacted.Employee_no = casted_redacted.Emp_no
  );
    
2020-07-30 17:03:42.130104 (Thread-1): finished collecting timing info
2020-07-30 17:03:42.131160 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c07e8876-760e-4761-98a8-b6aae74ecc82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eee8c50>]}
2020-07-30 17:03:42.132691 (Thread-1): 13:03:42 | 2 of 2 OK created table model springml_demo_dataset.redact_fields.... [CREATE TABLE (8336) in 4.69s]
2020-07-30 17:03:42.132883 (Thread-1): Finished running node model.springml_demo_dbt_project.redact_fields
2020-07-30 17:03:42.138668 (MainThread): Acquiring new bigquery connection "master".
2020-07-30 17:03:42.138991 (MainThread): Opening a new connection, currently in state closed
2020-07-30 17:03:42.139540 (MainThread): 13:03:42 | 
2020-07-30 17:03:42.139759 (MainThread): 13:03:42 | Finished running 2 table models in 9.98s.
2020-07-30 17:03:42.140023 (MainThread): Connection 'master' was properly closed.
2020-07-30 17:03:42.140219 (MainThread): Connection 'model.springml_demo_dbt_project.redact_fields' was left open.
2020-07-30 17:03:42.151386 (MainThread): 
2020-07-30 17:03:42.151798 (MainThread): Completed successfully
2020-07-30 17:03:42.152129 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-07-30 17:03:42.152525 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eda7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eeb4390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eec5e50>]}
2020-07-30 17:03:42.152810 (MainThread): Flushing usage events
2020-07-31 19:36:55.844499 (MainThread): Running with dbt=0.17.0
2020-07-31 19:36:57.628597 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-31 19:36:57.634578 (MainThread): Tracking: tracking
2020-07-31 19:36:57.735146 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a146e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a15f990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a15f790>]}
2020-07-31 19:36:57.772103 (MainThread): Partial parsing not enabled
2020-07-31 19:36:57.781921 (MainThread): Parsing macros/core.sql
2020-07-31 19:36:57.802500 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-31 19:36:57.819824 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-31 19:36:57.829434 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-31 19:36:57.863647 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-31 19:36:57.911482 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-31 19:36:57.941639 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-31 19:36:57.945461 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-31 19:36:57.954924 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-31 19:36:57.973340 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-31 19:36:57.983279 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-31 19:36:57.992784 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-31 19:36:58.000354 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-31 19:36:58.002202 (MainThread): Parsing macros/etc/query.sql
2020-07-31 19:36:58.004189 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-31 19:36:58.007001 (MainThread): Parsing macros/etc/datetime.sql
2020-07-31 19:36:58.019229 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-31 19:36:58.022040 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-31 19:36:58.024823 (MainThread): Parsing macros/adapters/common.sql
2020-07-31 19:36:58.092931 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-31 19:36:58.095282 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-31 19:36:58.096772 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-31 19:36:58.107268 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-31 19:36:58.112282 (MainThread): Parsing macros/etc.sql
2020-07-31 19:36:58.113618 (MainThread): Parsing macros/catalog.sql
2020-07-31 19:36:58.160137 (MainThread): Parsing macros/adapters.sql
2020-07-31 19:36:58.185968 (MainThread): Parsing macros/materializations/seed.sql
2020-07-31 19:36:58.189766 (MainThread): Parsing macros/materializations/view.sql
2020-07-31 19:36:58.193014 (MainThread): Parsing macros/materializations/table.sql
2020-07-31 19:36:58.207163 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-31 19:36:58.224765 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-31 19:36:58.263057 (MainThread): Partial parsing not enabled
2020-07-31 19:36:58.319582 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-31 19:36:58.319928 (MainThread): Opening a new connection, currently in state init
2020-07-31 19:36:58.363494 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-31 19:36:58.363660 (MainThread): Opening a new connection, currently in state closed
2020-07-31 19:36:58.380592 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-31 19:36:58.380817 (MainThread): Opening a new connection, currently in state closed
2020-07-31 19:36:58.403674 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-31 19:36:58.403840 (MainThread): Opening a new connection, currently in state closed
2020-07-31 19:36:58.487405 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-31 19:36:58.487666 (MainThread): Opening a new connection, currently in state closed
2020-07-31 19:36:58.954843 (MainThread): Found 4 models, 9 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 2 seed files, 2 sources
2020-07-31 19:36:58.956273 (MainThread): 
2020-07-31 19:36:58.956788 (MainThread): Acquiring new bigquery connection "master".
2020-07-31 19:36:58.956921 (MainThread): Opening a new connection, currently in state closed
2020-07-31 19:36:58.963617 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-31 19:36:58.963879 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-31 19:36:58.971568 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-31 19:37:03.177321 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-31 19:37:03.178301 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-31 19:37:03.178716 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-31 19:37:03.316415 (MainThread): Acquiring new bigquery connection "master".
2020-07-31 19:37:03.316709 (MainThread): Opening a new connection, currently in state closed
2020-07-31 19:37:03.317237 (MainThread): 15:37:03 | Concurrency: 1 threads (target='dev')
2020-07-31 19:37:03.317448 (MainThread): 15:37:03 | 
2020-07-31 19:37:03.320970 (Thread-1): Began running node model.springml_demo_dbt_project.creditcard
2020-07-31 19:37:03.322163 (Thread-1): 15:37:03 | 1 of 4 START view model springml_demo_dataset.creditcard............. [RUN]
2020-07-31 19:37:03.322543 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-31 19:37:03.322643 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-31 19:37:03.322807 (Thread-1): Compiling model.springml_demo_dbt_project.creditcard
2020-07-31 19:37:03.353687 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-31 19:37:03.369251 (Thread-1): finished collecting timing info
2020-07-31 19:37:03.431208 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-31 19:37:03.431948 (Thread-1): On model.springml_demo_dbt_project.creditcard: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
  OPTIONS()
  as 

select country,

sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,

sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,

sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,

from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
group by country 
having not (Amex_payments = 0 
and	Mastercard_payments = 0 
and	 Visa_payments = 0)
order by (Amex_payments + Mastercard_payments + Visa_payments) desc;


2020-07-31 19:37:03.746692 (Thread-1): Unhandled error while running:
/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
  OPTIONS()
  as 

select country,

sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,

sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,

sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,

from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
group by country 
having not (Amex_payments = 0 
and	Mastercard_payments = 0 
and	 Visa_payments = 0)
order by (Amex_payments + Mastercard_payments + Visa_payments) desc;


2020-07-31 19:37:03.752151 (Thread-1): 404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US

(job ID: 295f11ad-81e0-4bb7-84a4-f84987855b52)

                                                               -----Query Job SQL Follows-----                                                               

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
   5:  OPTIONS()
   6:  as 
   7:
   8:select country,
   9:
  10:sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,
  11:
  12:sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,
  13:
  14:sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,
  15:
  16:from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
  17:group by country 
  18:having not (Amex_payments = 0 
  19:and	Mastercard_payments = 0 
  20:and	 Visa_payments = 0)
  21:order by (Amex_payments + Mastercard_payments + Visa_payments) desc;
  22:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
2020-07-31 19:37:03.752505 (Thread-1): finished collecting timing info
2020-07-31 19:37:03.753578 (Thread-1): Runtime Error in model creditcard (models/base/creditcard.sql)
  404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
  
  (job ID: 295f11ad-81e0-4bb7-84a4-f84987855b52)
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 84, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 225, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 352, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 127, in result
    raise self._exception
google.api_core.exceptions.NotFound: 404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US

(job ID: 295f11ad-81e0-4bb7-84a4-f84987855b52)

                                                               -----Query Job SQL Follows-----                                                               

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
   5:  OPTIONS()
   6:  as 
   7:
   8:select country,
   9:
  10:sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,
  11:
  12:sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,
  13:
  14:sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,
  15:
  16:from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
  17:group by country 
  18:having not (Amex_payments = 0 
  19:and	Mastercard_payments = 0 
  20:and	 Visa_payments = 0)
  21:order by (Amex_payments + Mastercard_payments + Visa_payments) desc;
  22:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 234, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 227, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/Cellar/python/3.7.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error in model creditcard (models/base/creditcard.sql)
  404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
  
  (job ID: 295f11ad-81e0-4bb7-84a4-f84987855b52)
2020-07-31 19:37:04.009093 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4333207a-f999-490c-96ba-084e4f882b7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a2f8590>]}
2020-07-31 19:37:04.010691 (Thread-1): 15:37:04 | 1 of 4 ERROR creating view model springml_demo_dataset.creditcard.... [ERROR in 0.69s]
2020-07-31 19:37:04.010900 (Thread-1): Finished running node model.springml_demo_dbt_project.creditcard
2020-07-31 19:37:04.011142 (Thread-1): Began running node model.springml_demo_dbt_project.gender_count
2020-07-31 19:37:04.012600 (Thread-1): 15:37:04 | 2 of 4 START table model springml_demo_dataset.gender_count.......... [RUN]
2020-07-31 19:37:04.013047 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-31 19:37:04.013198 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.creditcard).
2020-07-31 19:37:04.013338 (Thread-1): Compiling model.springml_demo_dbt_project.gender_count
2020-07-31 19:37:04.024692 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-31 19:37:04.026332 (Thread-1): finished collecting timing info
2020-07-31 19:37:04.062210 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-31 19:37:04.211020 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-31 19:37:04.211493 (Thread-1): On model.springml_demo_dbt_project.gender_count: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.gender_count"} */


  create or replace table `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count`
  
  
  OPTIONS()
  as (
    select
    CURRENT_DATE() as Ingestion_date, 
    countif(source.Gender is not null and source.Gender = "F") as Female_count,
    countif(source.Gender is not null and source.Gender = "M") as Male_count,
from 
    `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data` as source
  );
    
2020-07-31 19:37:06.319479 (Thread-1): finished collecting timing info
2020-07-31 19:37:06.320275 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4333207a-f999-490c-96ba-084e4f882b7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a3d0b50>]}
2020-07-31 19:37:06.321862 (Thread-1): 15:37:06 | 2 of 4 OK created table model springml_demo_dataset.gender_count..... [CREATE TABLE (1) in 2.31s]
2020-07-31 19:37:06.322069 (Thread-1): Finished running node model.springml_demo_dbt_project.gender_count
2020-07-31 19:37:06.322284 (Thread-1): Began running node model.springml_demo_dbt_project.payments
2020-07-31 19:37:06.323394 (Thread-1): 15:37:06 | 3 of 4 START view model springml_demo_dataset.payments............... [RUN]
2020-07-31 19:37:06.323881 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-31 19:37:06.323996 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.gender_count).
2020-07-31 19:37:06.324131 (Thread-1): Compiling model.springml_demo_dbt_project.payments
2020-07-31 19:37:06.333448 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.payments"
2020-07-31 19:37:06.333925 (Thread-1): finished collecting timing info
2020-07-31 19:37:06.340362 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.payments"
2020-07-31 19:37:06.341548 (Thread-1): On model.springml_demo_dbt_project.payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
  OPTIONS()
  as select payment_type, 
    count(*) as number_of_payments, 
    sum(price) as total_price 
from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where country like "United States"
group by payment_type;


2020-07-31 19:37:06.525754 (Thread-1): Unhandled error while running:
/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
  OPTIONS()
  as select payment_type, 
    count(*) as number_of_payments, 
    sum(price) as total_price 
from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where country like "United States"
group by payment_type;


2020-07-31 19:37:06.525993 (Thread-1): 404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US

(job ID: 5deba24a-76b2-4079-b72b-56039a23f23f)

                                                              -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
   5:  OPTIONS()
   6:  as select payment_type, 
   7:    count(*) as number_of_payments, 
   8:    sum(price) as total_price 
   9:from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
  10:where country like "United States"
  11:group by payment_type;
  12:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
2020-07-31 19:37:06.526334 (Thread-1): finished collecting timing info
2020-07-31 19:37:06.527028 (Thread-1): Runtime Error in model payments (models/base/payments.sql)
  404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
  
  (job ID: 5deba24a-76b2-4079-b72b-56039a23f23f)
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 84, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 225, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 352, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 127, in result
    raise self._exception
google.api_core.exceptions.NotFound: 404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US

(job ID: 5deba24a-76b2-4079-b72b-56039a23f23f)

                                                              -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
   5:  OPTIONS()
   6:  as select payment_type, 
   7:    count(*) as number_of_payments, 
   8:    sum(price) as total_price 
   9:from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
  10:where country like "United States"
  11:group by payment_type;
  12:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 234, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 227, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/Cellar/python/3.7.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error in model payments (models/base/payments.sql)
  404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
  
  (job ID: 5deba24a-76b2-4079-b72b-56039a23f23f)
2020-07-31 19:37:06.528307 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4333207a-f999-490c-96ba-084e4f882b7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da8cd10>]}
2020-07-31 19:37:06.529661 (Thread-1): 15:37:06 | 3 of 4 ERROR creating view model springml_demo_dataset.payments...... [ERROR in 0.20s]
2020-07-31 19:37:06.529845 (Thread-1): Finished running node model.springml_demo_dbt_project.payments
2020-07-31 19:37:06.530033 (Thread-1): Began running node model.springml_demo_dbt_project.redact_fields
2020-07-31 19:37:06.531197 (Thread-1): 15:37:06 | 4 of 4 START table model springml_demo_dataset.redact_fields......... [RUN]
2020-07-31 19:37:06.531549 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-31 19:37:06.531650 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.payments).
2020-07-31 19:37:06.531744 (Thread-1): Compiling model.springml_demo_dbt_project.redact_fields
2020-07-31 19:37:06.550498 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-31 19:37:06.551039 (Thread-1): finished collecting timing info
2020-07-31 19:37:06.558494 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-31 19:37:06.694273 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-31 19:37:06.695369 (Thread-1): On model.springml_demo_dbt_project.redact_fields: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.redact_fields"} */


  create or replace table `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields`
  
  
  OPTIONS()
  as (
    with source as (
	select * 
	from
		`prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`
),

casted as (
	select
		Employee_no as Emp_no,
		cast(Phone_no as string),
		cast(Social_insurance_no as string)
	from source
),

casted_redacted as (
	select
		Emp_no,
		'##ARCHIVED##' as Phone_no,
		'##ARCHIVED##' as Social_insurance_no
	from casted
),

redacted as (
	select
		Employee_no,
		'##ARCHIVED##' as Surname,
		'##ARCHIVED##'as Given_name,
		Gender,
		City,
		Age,
		Year_joined
	from	
		source
)

select 
	redacted.Employee_no,
	redacted.Surname,
	redacted.Given_name,
	redacted.Gender,
	redacted.City,
	redacted.Age,
	redacted.Year_joined,
	casted_redacted.Phone_no,
	casted_redacted.Social_insurance_no
from 
	redacted
join 
	casted_redacted 
		on redacted.Employee_no = casted_redacted.Emp_no
  );
    
2020-07-31 19:37:09.837396 (Thread-1): finished collecting timing info
2020-07-31 19:37:09.843650 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4333207a-f999-490c-96ba-084e4f882b7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11af71dd0>]}
2020-07-31 19:37:09.845583 (Thread-1): 15:37:09 | 4 of 4 OK created table model springml_demo_dataset.redact_fields.... [CREATE TABLE (8336) in 3.31s]
2020-07-31 19:37:09.845825 (Thread-1): Finished running node model.springml_demo_dbt_project.redact_fields
2020-07-31 19:37:09.888670 (MainThread): Acquiring new bigquery connection "master".
2020-07-31 19:37:09.888906 (MainThread): Opening a new connection, currently in state closed
2020-07-31 19:37:09.889674 (MainThread): 15:37:09 | 
2020-07-31 19:37:09.889941 (MainThread): 15:37:09 | Finished running 2 view models, 2 table models in 10.93s.
2020-07-31 19:37:09.890153 (MainThread): Connection 'master' was properly closed.
2020-07-31 19:37:09.890287 (MainThread): Connection 'model.springml_demo_dbt_project.redact_fields' was left open.
2020-07-31 19:37:09.921314 (MainThread): 
2020-07-31 19:37:09.921639 (MainThread): Completed with 2 errors and 0 warnings:
2020-07-31 19:37:09.921845 (MainThread): 
2020-07-31 19:37:09.922096 (MainThread): Runtime Error in model creditcard (models/base/creditcard.sql)
2020-07-31 19:37:09.922266 (MainThread):   404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
2020-07-31 19:37:09.922450 (MainThread):   
2020-07-31 19:37:09.922606 (MainThread):   (job ID: 295f11ad-81e0-4bb7-84a4-f84987855b52)
2020-07-31 19:37:09.922755 (MainThread): 
2020-07-31 19:37:09.922931 (MainThread): Runtime Error in model payments (models/base/payments.sql)
2020-07-31 19:37:09.923082 (MainThread):   404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
2020-07-31 19:37:09.923260 (MainThread):   
2020-07-31 19:37:09.923403 (MainThread):   (job ID: 5deba24a-76b2-4079-b72b-56039a23f23f)
2020-07-31 19:37:09.923562 (MainThread): 
Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
2020-07-31 19:37:09.923888 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a56da50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a46fd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9147d0>]}
2020-07-31 19:37:09.924095 (MainThread): Flushing usage events
2020-07-31 19:55:13.601551 (MainThread): Running with dbt=0.17.0
2020-07-31 19:55:15.248023 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-31 19:55:15.256325 (MainThread): Tracking: tracking
2020-07-31 19:55:15.304740 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113aa4190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113aaab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113aaa950>]}
2020-07-31 19:55:15.345658 (MainThread): Partial parsing not enabled
2020-07-31 19:55:15.357498 (MainThread): Parsing macros/core.sql
2020-07-31 19:55:15.374843 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-31 19:55:15.391758 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-31 19:55:15.397669 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-31 19:55:15.444870 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-31 19:55:15.495868 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-31 19:55:15.542430 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-31 19:55:15.548914 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-31 19:55:15.558046 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-31 19:55:15.579674 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-31 19:55:15.589646 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-31 19:55:15.602349 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-31 19:55:15.610072 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-31 19:55:15.613129 (MainThread): Parsing macros/etc/query.sql
2020-07-31 19:55:15.624953 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-31 19:55:15.628027 (MainThread): Parsing macros/etc/datetime.sql
2020-07-31 19:55:15.648290 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-31 19:55:15.652386 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-31 19:55:15.655589 (MainThread): Parsing macros/adapters/common.sql
2020-07-31 19:55:15.754949 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-31 19:55:15.757599 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-31 19:55:15.760185 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-31 19:55:15.767847 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-31 19:55:15.772528 (MainThread): Parsing macros/etc.sql
2020-07-31 19:55:15.774177 (MainThread): Parsing macros/catalog.sql
2020-07-31 19:55:15.785716 (MainThread): Parsing macros/adapters.sql
2020-07-31 19:55:15.822143 (MainThread): Parsing macros/materializations/seed.sql
2020-07-31 19:55:15.826385 (MainThread): Parsing macros/materializations/view.sql
2020-07-31 19:55:15.829905 (MainThread): Parsing macros/materializations/table.sql
2020-07-31 19:55:15.848006 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-31 19:55:15.871447 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-31 19:55:15.910430 (MainThread): Partial parsing not enabled
2020-07-31 19:55:15.988909 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-31 19:55:15.989100 (MainThread): Opening a new connection, currently in state init
2020-07-31 19:55:16.047958 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-31 19:55:16.048112 (MainThread): Opening a new connection, currently in state closed
2020-07-31 19:55:16.072859 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-31 19:55:16.073087 (MainThread): Opening a new connection, currently in state closed
2020-07-31 19:55:16.096151 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-31 19:55:16.096300 (MainThread): Opening a new connection, currently in state closed
2020-07-31 19:55:16.217764 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-31 19:55:16.217975 (MainThread): Opening a new connection, currently in state closed
2020-07-31 19:55:16.904072 (MainThread): Found 4 models, 9 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 2 seed files, 2 sources
2020-07-31 19:55:16.905392 (MainThread): 
2020-07-31 19:55:16.905845 (MainThread): Acquiring new bigquery connection "master".
2020-07-31 19:55:16.906105 (MainThread): Opening a new connection, currently in state closed
2020-07-31 19:55:16.915898 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-31 19:55:16.916186 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-31 19:55:16.919943 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-31 19:55:19.650258 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-31 19:55:19.650493 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-31 19:55:19.650650 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-31 19:55:19.801837 (MainThread): Acquiring new bigquery connection "master".
2020-07-31 19:55:19.802009 (MainThread): Opening a new connection, currently in state closed
2020-07-31 19:55:19.802336 (MainThread): 15:55:19 | Concurrency: 1 threads (target='dev')
2020-07-31 19:55:19.802511 (MainThread): 15:55:19 | 
2020-07-31 19:55:19.809381 (Thread-1): Began running node model.springml_demo_dbt_project.creditcard
2020-07-31 19:55:19.811250 (Thread-1): 15:55:19 | 1 of 4 START view model springml_demo_dataset.creditcard............. [RUN]
2020-07-31 19:55:19.811819 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-31 19:55:19.811998 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-31 19:55:19.812184 (Thread-1): Compiling model.springml_demo_dbt_project.creditcard
2020-07-31 19:55:19.840163 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-31 19:55:19.843795 (Thread-1): finished collecting timing info
2020-07-31 19:55:19.888748 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-31 19:55:19.889246 (Thread-1): On model.springml_demo_dbt_project.creditcard: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
  OPTIONS()
  as 

select country,

sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,

sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,

sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,

from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
group by country 
having not (Amex_payments = 0 
and	Mastercard_payments = 0 
and	 Visa_payments = 0)
order by (Amex_payments + Mastercard_payments + Visa_payments) desc;


2020-07-31 19:55:20.981371 (Thread-1): Unhandled error while running:
/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
  OPTIONS()
  as 

select country,

sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,

sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,

sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,

from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
group by country 
having not (Amex_payments = 0 
and	Mastercard_payments = 0 
and	 Visa_payments = 0)
order by (Amex_payments + Mastercard_payments + Visa_payments) desc;


2020-07-31 19:55:20.981568 (Thread-1): 404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US

(job ID: 05f04232-2156-4652-973c-9f7051dbbefe)

                                                               -----Query Job SQL Follows-----                                                               

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
   5:  OPTIONS()
   6:  as 
   7:
   8:select country,
   9:
  10:sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,
  11:
  12:sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,
  13:
  14:sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,
  15:
  16:from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
  17:group by country 
  18:having not (Amex_payments = 0 
  19:and	Mastercard_payments = 0 
  20:and	 Visa_payments = 0)
  21:order by (Amex_payments + Mastercard_payments + Visa_payments) desc;
  22:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
2020-07-31 19:55:20.981788 (Thread-1): finished collecting timing info
2020-07-31 19:55:20.982315 (Thread-1): Runtime Error in model creditcard (models/base/creditcard.sql)
  404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
  
  (job ID: 05f04232-2156-4652-973c-9f7051dbbefe)
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 84, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 225, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 352, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 127, in result
    raise self._exception
google.api_core.exceptions.NotFound: 404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US

(job ID: 05f04232-2156-4652-973c-9f7051dbbefe)

                                                               -----Query Job SQL Follows-----                                                               

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
   5:  OPTIONS()
   6:  as 
   7:
   8:select country,
   9:
  10:sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,
  11:
  12:sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,
  13:
  14:sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,
  15:
  16:from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
  17:group by country 
  18:having not (Amex_payments = 0 
  19:and	Mastercard_payments = 0 
  20:and	 Visa_payments = 0)
  21:order by (Amex_payments + Mastercard_payments + Visa_payments) desc;
  22:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 234, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 227, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/Cellar/python/3.7.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error in model creditcard (models/base/creditcard.sql)
  404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
  
  (job ID: 05f04232-2156-4652-973c-9f7051dbbefe)
2020-07-31 19:55:21.029942 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90d896ae-2cee-422b-ad52-967975699970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fce7d0>]}
2020-07-31 19:55:21.031833 (Thread-1): 15:55:21 | 1 of 4 ERROR creating view model springml_demo_dataset.creditcard.... [ERROR in 1.22s]
2020-07-31 19:55:21.032082 (Thread-1): Finished running node model.springml_demo_dbt_project.creditcard
2020-07-31 19:55:21.032299 (Thread-1): Began running node model.springml_demo_dbt_project.gender_count
2020-07-31 19:55:21.034049 (Thread-1): 15:55:21 | 2 of 4 START table model springml_demo_dataset.gender_count.......... [RUN]
2020-07-31 19:55:21.034574 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-31 19:55:21.034688 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.creditcard).
2020-07-31 19:55:21.034843 (Thread-1): Compiling model.springml_demo_dbt_project.gender_count
2020-07-31 19:55:21.045258 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-31 19:55:21.046736 (Thread-1): finished collecting timing info
2020-07-31 19:55:21.077296 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-31 19:55:21.337814 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-31 19:55:21.338318 (Thread-1): On model.springml_demo_dbt_project.gender_count: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.gender_count"} */


  create or replace table `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count`
  
  
  OPTIONS()
  as (
    select
    CURRENT_DATE() as Ingestion_date, 
    countif(source.Gender is not null and source.Gender = "F") as Female_count,
    countif(source.Gender is not null and source.Gender = "M") as Male_count,
from 
    `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data` as source
  );
    
2020-07-31 19:55:23.392333 (Thread-1): finished collecting timing info
2020-07-31 19:55:23.393141 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90d896ae-2cee-422b-ad52-967975699970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148c8f10>]}
2020-07-31 19:55:23.394274 (Thread-1): 15:55:23 | 2 of 4 OK created table model springml_demo_dataset.gender_count..... [CREATE TABLE (1) in 2.36s]
2020-07-31 19:55:23.394431 (Thread-1): Finished running node model.springml_demo_dbt_project.gender_count
2020-07-31 19:55:23.394595 (Thread-1): Began running node model.springml_demo_dbt_project.payments
2020-07-31 19:55:23.395658 (Thread-1): 15:55:23 | 3 of 4 START view model springml_demo_dataset.payments............... [RUN]
2020-07-31 19:55:23.396024 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-31 19:55:23.396247 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.gender_count).
2020-07-31 19:55:23.396350 (Thread-1): Compiling model.springml_demo_dbt_project.payments
2020-07-31 19:55:23.405348 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.payments"
2020-07-31 19:55:23.405852 (Thread-1): finished collecting timing info
2020-07-31 19:55:23.412454 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.payments"
2020-07-31 19:55:23.413404 (Thread-1): On model.springml_demo_dbt_project.payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
  OPTIONS()
  as select payment_type, 
    count(*) as number_of_payments, 
    sum(price) as total_price 
from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where country like "United States"
group by payment_type;


2020-07-31 19:55:23.650964 (Thread-1): Unhandled error while running:
/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
  OPTIONS()
  as select payment_type, 
    count(*) as number_of_payments, 
    sum(price) as total_price 
from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where country like "United States"
group by payment_type;


2020-07-31 19:55:23.651277 (Thread-1): 404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US

(job ID: b4deb795-b9de-455f-ae29-ac085a4ae1dd)

                                                              -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
   5:  OPTIONS()
   6:  as select payment_type, 
   7:    count(*) as number_of_payments, 
   8:    sum(price) as total_price 
   9:from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
  10:where country like "United States"
  11:group by payment_type;
  12:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
2020-07-31 19:55:23.653222 (Thread-1): finished collecting timing info
2020-07-31 19:55:23.653790 (Thread-1): Runtime Error in model payments (models/base/payments.sql)
  404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
  
  (job ID: b4deb795-b9de-455f-ae29-ac085a4ae1dd)
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 84, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 225, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 352, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 127, in result
    raise self._exception
google.api_core.exceptions.NotFound: 404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US

(job ID: b4deb795-b9de-455f-ae29-ac085a4ae1dd)

                                                              -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
   5:  OPTIONS()
   6:  as select payment_type, 
   7:    count(*) as number_of_payments, 
   8:    sum(price) as total_price 
   9:from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
  10:where country like "United States"
  11:group by payment_type;
  12:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 234, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 227, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/Cellar/python/3.7.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error in model payments (models/base/payments.sql)
  404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
  
  (job ID: b4deb795-b9de-455f-ae29-ac085a4ae1dd)
2020-07-31 19:55:23.654491 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90d896ae-2cee-422b-ad52-967975699970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148e0b10>]}
2020-07-31 19:55:23.655656 (Thread-1): 15:55:23 | 3 of 4 ERROR creating view model springml_demo_dataset.payments...... [ERROR in 0.26s]
2020-07-31 19:55:23.655798 (Thread-1): Finished running node model.springml_demo_dbt_project.payments
2020-07-31 19:55:23.656013 (Thread-1): Began running node model.springml_demo_dbt_project.redact_fields
2020-07-31 19:55:23.657127 (Thread-1): 15:55:23 | 4 of 4 START table model springml_demo_dataset.redact_fields......... [RUN]
2020-07-31 19:55:23.657811 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-31 19:55:23.658029 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.payments).
2020-07-31 19:55:23.658199 (Thread-1): Compiling model.springml_demo_dbt_project.redact_fields
2020-07-31 19:55:23.671746 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-31 19:55:23.672233 (Thread-1): finished collecting timing info
2020-07-31 19:55:23.677322 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-31 19:55:23.815667 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-31 19:55:23.816453 (Thread-1): On model.springml_demo_dbt_project.redact_fields: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.redact_fields"} */


  create or replace table `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields`
  
  
  OPTIONS()
  as (
    with source as (
	select * 
	from
		`prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`
),

casted as (
	select
		Employee_no as Emp_no,
		cast(Phone_no as string),
		cast(Social_insurance_no as string)
	from source
),

casted_redacted as (
	select
		Emp_no,
		'##ARCHIVED##' as Phone_no,
		'##ARCHIVED##' as Social_insurance_no
	from casted
),

redacted as (
	select
		Employee_no,
		'##ARCHIVED##' as Surname,
		'##ARCHIVED##'as Given_name,
		Gender,
		City,
		Age,
		Year_joined
	from	
		source
)

select 
	redacted.Employee_no,
	redacted.Surname,
	redacted.Given_name,
	redacted.Gender,
	redacted.City,
	redacted.Age,
	redacted.Year_joined,
	casted_redacted.Phone_no,
	casted_redacted.Social_insurance_no
from 
	redacted
join 
	casted_redacted 
		on redacted.Employee_no = casted_redacted.Emp_no
  );
    
2020-07-31 19:55:26.375969 (Thread-1): finished collecting timing info
2020-07-31 19:55:26.377510 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90d896ae-2cee-422b-ad52-967975699970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148f5290>]}
2020-07-31 19:55:26.379656 (Thread-1): 15:55:26 | 4 of 4 OK created table model springml_demo_dataset.redact_fields.... [CREATE TABLE (8336) in 2.72s]
2020-07-31 19:55:26.380112 (Thread-1): Finished running node model.springml_demo_dbt_project.redact_fields
2020-07-31 19:55:26.415527 (MainThread): Acquiring new bigquery connection "master".
2020-07-31 19:55:26.415764 (MainThread): Opening a new connection, currently in state closed
2020-07-31 19:55:26.416386 (MainThread): 15:55:26 | 
2020-07-31 19:55:26.416641 (MainThread): 15:55:26 | Finished running 2 view models, 2 table models in 9.51s.
2020-07-31 19:55:26.416824 (MainThread): Connection 'master' was properly closed.
2020-07-31 19:55:26.416948 (MainThread): Connection 'model.springml_demo_dbt_project.redact_fields' was left open.
2020-07-31 19:55:26.444595 (MainThread): 
2020-07-31 19:55:26.444865 (MainThread): Completed with 2 errors and 0 warnings:
2020-07-31 19:55:26.445050 (MainThread): 
2020-07-31 19:55:26.445226 (MainThread): Runtime Error in model creditcard (models/base/creditcard.sql)
2020-07-31 19:55:26.445387 (MainThread):   404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
2020-07-31 19:55:26.445537 (MainThread):   
2020-07-31 19:55:26.445685 (MainThread):   (job ID: 05f04232-2156-4652-973c-9f7051dbbefe)
2020-07-31 19:55:26.445904 (MainThread): 
2020-07-31 19:55:26.446077 (MainThread): Runtime Error in model payments (models/base/payments.sql)
2020-07-31 19:55:26.446224 (MainThread):   404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
2020-07-31 19:55:26.446371 (MainThread):   
2020-07-31 19:55:26.446511 (MainThread):   (job ID: b4deb795-b9de-455f-ae29-ac085a4ae1dd)
2020-07-31 19:55:26.446675 (MainThread): 
Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
2020-07-31 19:55:26.446957 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113cfebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e0de10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fc9fd0>]}
2020-07-31 19:55:26.447224 (MainThread): Flushing usage events
2020-07-31 20:14:48.015198 (MainThread): Running with dbt=0.17.0
2020-07-31 20:14:49.861913 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/medhapatil/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-31 20:14:49.868236 (MainThread): Tracking: tracking
2020-07-31 20:14:49.892784 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbc4f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbc9a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbc9890>]}
2020-07-31 20:14:49.919712 (MainThread): Partial parsing not enabled
2020-07-31 20:14:49.924763 (MainThread): Parsing macros/core.sql
2020-07-31 20:14:49.932949 (MainThread): Parsing macros/materializations/helpers.sql
2020-07-31 20:14:49.947119 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-07-31 20:14:49.949991 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-07-31 20:14:49.974110 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-07-31 20:14:50.012418 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-07-31 20:14:50.039356 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-07-31 20:14:50.042637 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-07-31 20:14:50.053034 (MainThread): Parsing macros/materializations/common/merge.sql
2020-07-31 20:14:50.070890 (MainThread): Parsing macros/materializations/table/table.sql
2020-07-31 20:14:50.080532 (MainThread): Parsing macros/materializations/view/view.sql
2020-07-31 20:14:50.089533 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-07-31 20:14:50.096472 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-07-31 20:14:50.098323 (MainThread): Parsing macros/etc/query.sql
2020-07-31 20:14:50.100668 (MainThread): Parsing macros/etc/is_incremental.sql
2020-07-31 20:14:50.103788 (MainThread): Parsing macros/etc/datetime.sql
2020-07-31 20:14:50.115889 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-07-31 20:14:50.121460 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-07-31 20:14:50.125709 (MainThread): Parsing macros/adapters/common.sql
2020-07-31 20:14:50.187168 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-07-31 20:14:50.189427 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-07-31 20:14:50.191033 (MainThread): Parsing macros/schema_tests/unique.sql
2020-07-31 20:14:50.193057 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-07-31 20:14:50.196951 (MainThread): Parsing macros/etc.sql
2020-07-31 20:14:50.198646 (MainThread): Parsing macros/catalog.sql
2020-07-31 20:14:50.206876 (MainThread): Parsing macros/adapters.sql
2020-07-31 20:14:50.228024 (MainThread): Parsing macros/materializations/seed.sql
2020-07-31 20:14:50.231211 (MainThread): Parsing macros/materializations/view.sql
2020-07-31 20:14:50.234646 (MainThread): Parsing macros/materializations/table.sql
2020-07-31 20:14:50.248545 (MainThread): Parsing macros/materializations/incremental.sql
2020-07-31 20:14:50.265259 (MainThread): Parsing macros/materializations/snapshot.sql
2020-07-31 20:14:50.290901 (MainThread): Partial parsing not enabled
2020-07-31 20:14:50.338062 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-31 20:14:50.338306 (MainThread): Opening a new connection, currently in state init
2020-07-31 20:14:50.379093 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-31 20:14:50.379249 (MainThread): Opening a new connection, currently in state closed
2020-07-31 20:14:50.393681 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-31 20:14:50.393839 (MainThread): Opening a new connection, currently in state closed
2020-07-31 20:14:50.407555 (MainThread): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-31 20:14:50.407728 (MainThread): Opening a new connection, currently in state closed
2020-07-31 20:14:50.472398 (MainThread): Acquiring new bigquery connection "test.springml_demo_dbt_project.creditcardtest".
2020-07-31 20:14:50.472609 (MainThread): Opening a new connection, currently in state closed
2020-07-31 20:14:50.926811 (MainThread): Found 4 models, 9 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 2 seed files, 2 sources
2020-07-31 20:14:50.928101 (MainThread): 
2020-07-31 20:14:50.928497 (MainThread): Acquiring new bigquery connection "master".
2020-07-31 20:14:50.928600 (MainThread): Opening a new connection, currently in state closed
2020-07-31 20:14:50.934968 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_prismatic-cider-279015".
2020-07-31 20:14:50.935257 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-31 20:14:50.940451 (ThreadPoolExecutor-0_0): Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
2020-07-31 20:14:54.084817 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_prismatic-cider-279015_springml_demo_dataset".
2020-07-31 20:14:54.085148 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_prismatic-cider-279015).
2020-07-31 20:14:54.085337 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-31 20:14:54.234063 (MainThread): Acquiring new bigquery connection "master".
2020-07-31 20:14:54.234234 (MainThread): Opening a new connection, currently in state closed
2020-07-31 20:14:54.234572 (MainThread): 16:14:54 | Concurrency: 1 threads (target='dev')
2020-07-31 20:14:54.234745 (MainThread): 16:14:54 | 
2020-07-31 20:14:54.237785 (Thread-1): Began running node model.springml_demo_dbt_project.creditcard
2020-07-31 20:14:54.238951 (Thread-1): 16:14:54 | 1 of 4 START view model springml_demo_dataset.creditcard............. [RUN]
2020-07-31 20:14:54.239311 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.creditcard".
2020-07-31 20:14:54.239418 (Thread-1): Re-using an available connection from the pool (formerly list_prismatic-cider-279015_springml_demo_dataset).
2020-07-31 20:14:54.239535 (Thread-1): Compiling model.springml_demo_dbt_project.creditcard
2020-07-31 20:14:54.263167 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-31 20:14:54.264578 (Thread-1): finished collecting timing info
2020-07-31 20:14:54.304493 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.creditcard"
2020-07-31 20:14:54.305251 (Thread-1): On model.springml_demo_dbt_project.creditcard: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
  OPTIONS()
  as 

select country,

sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,

sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,

sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,

from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
group by country 
having not (Amex_payments = 0 
and	Mastercard_payments = 0 
and	 Visa_payments = 0)
order by (Amex_payments + Mastercard_payments + Visa_payments) desc;


2020-07-31 20:14:55.234867 (Thread-1): Unhandled error while running:
/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
  OPTIONS()
  as 

select country,

sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,

sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,

sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,

from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
group by country 
having not (Amex_payments = 0 
and	Mastercard_payments = 0 
and	 Visa_payments = 0)
order by (Amex_payments + Mastercard_payments + Visa_payments) desc;


2020-07-31 20:14:55.235097 (Thread-1): 404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US

(job ID: e3529d7e-dec4-486b-a871-28eefadbb2c6)

                                                               -----Query Job SQL Follows-----                                                               

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
   5:  OPTIONS()
   6:  as 
   7:
   8:select country,
   9:
  10:sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,
  11:
  12:sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,
  13:
  14:sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,
  15:
  16:from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
  17:group by country 
  18:having not (Amex_payments = 0 
  19:and	Mastercard_payments = 0 
  20:and	 Visa_payments = 0)
  21:order by (Amex_payments + Mastercard_payments + Visa_payments) desc;
  22:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
2020-07-31 20:14:55.235339 (Thread-1): finished collecting timing info
2020-07-31 20:14:55.235928 (Thread-1): Runtime Error in model creditcard (models/base/creditcard.sql)
  404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
  
  (job ID: e3529d7e-dec4-486b-a871-28eefadbb2c6)
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 84, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 225, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 352, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 127, in result
    raise self._exception
google.api_core.exceptions.NotFound: 404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US

(job ID: e3529d7e-dec4-486b-a871-28eefadbb2c6)

                                                               -----Query Job SQL Follows-----                                                               

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.creditcard"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`
   5:  OPTIONS()
   6:  as 
   7:
   8:select country,
   9:
  10:sum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,
  11:
  12:sum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,
  13:
  14:sum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,
  15:
  16:from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
  17:group by country 
  18:having not (Amex_payments = 0 
  19:and	Mastercard_payments = 0 
  20:and	 Visa_payments = 0)
  21:order by (Amex_payments + Mastercard_payments + Visa_payments) desc;
  22:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 234, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 227, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/Cellar/python/3.7.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error in model creditcard (models/base/creditcard.sql)
  404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
  
  (job ID: e3529d7e-dec4-486b-a871-28eefadbb2c6)
2020-07-31 20:14:55.255111 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38ded2b0-f718-49c2-9cfa-52da1f9390b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100ed390>]}
2020-07-31 20:14:55.256692 (Thread-1): 16:14:55 | 1 of 4 ERROR creating view model springml_demo_dataset.creditcard.... [ERROR in 1.02s]
2020-07-31 20:14:55.256900 (Thread-1): Finished running node model.springml_demo_dbt_project.creditcard
2020-07-31 20:14:55.257317 (Thread-1): Began running node model.springml_demo_dbt_project.gender_count
2020-07-31 20:14:55.258484 (Thread-1): 16:14:55 | 2 of 4 START table model springml_demo_dataset.gender_count.......... [RUN]
2020-07-31 20:14:55.258855 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.gender_count".
2020-07-31 20:14:55.258964 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.creditcard).
2020-07-31 20:14:55.259071 (Thread-1): Compiling model.springml_demo_dbt_project.gender_count
2020-07-31 20:14:55.268504 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-31 20:14:55.269093 (Thread-1): finished collecting timing info
2020-07-31 20:14:55.289536 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-31 20:14:55.448714 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.gender_count"
2020-07-31 20:14:55.451451 (Thread-1): On model.springml_demo_dbt_project.gender_count: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.gender_count"} */


  create or replace table `prismatic-cider-279015`.`springml_demo_dataset`.`gender_count`
  
  
  OPTIONS()
  as (
    select
    CURRENT_DATE() as Ingestion_date, 
    countif(source.Gender is not null and source.Gender = "F") as Female_count,
    countif(source.Gender is not null and source.Gender = "M") as Male_count,
from 
    `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data` as source
  );
    
2020-07-31 20:14:59.130972 (Thread-1): finished collecting timing info
2020-07-31 20:14:59.131864 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38ded2b0-f718-49c2-9cfa-52da1f9390b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100df110>]}
2020-07-31 20:14:59.133317 (Thread-1): 16:14:59 | 2 of 4 OK created table model springml_demo_dataset.gender_count..... [CREATE TABLE (1) in 3.87s]
2020-07-31 20:14:59.133521 (Thread-1): Finished running node model.springml_demo_dbt_project.gender_count
2020-07-31 20:14:59.133726 (Thread-1): Began running node model.springml_demo_dbt_project.payments
2020-07-31 20:14:59.135184 (Thread-1): 16:14:59 | 3 of 4 START view model springml_demo_dataset.payments............... [RUN]
2020-07-31 20:14:59.135661 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.payments".
2020-07-31 20:14:59.135787 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.gender_count).
2020-07-31 20:14:59.135946 (Thread-1): Compiling model.springml_demo_dbt_project.payments
2020-07-31 20:14:59.144840 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.payments"
2020-07-31 20:14:59.145753 (Thread-1): finished collecting timing info
2020-07-31 20:14:59.151445 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.payments"
2020-07-31 20:14:59.151939 (Thread-1): On model.springml_demo_dbt_project.payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
  OPTIONS()
  as select payment_type, 
    count(*) as number_of_payments, 
    sum(price) as total_price 
from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where country like "United States"
group by payment_type;


2020-07-31 20:14:59.421351 (Thread-1): Unhandled error while running:
/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */


  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
  OPTIONS()
  as select payment_type, 
    count(*) as number_of_payments, 
    sum(price) as total_price 
from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
where country like "United States"
group by payment_type;


2020-07-31 20:14:59.421526 (Thread-1): 404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US

(job ID: 3b9e2ec9-9ec8-45ee-90ad-39bc43f54083)

                                                              -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
   5:  OPTIONS()
   6:  as select payment_type, 
   7:    count(*) as number_of_payments, 
   8:    sum(price) as total_price 
   9:from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
  10:where country like "United States"
  11:group by payment_type;
  12:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
2020-07-31 20:14:59.421706 (Thread-1): finished collecting timing info
2020-07-31 20:14:59.422338 (Thread-1): Runtime Error in model payments (models/base/payments.sql)
  404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
  
  (job ID: 3b9e2ec9-9ec8-45ee-90ad-39bc43f54083)
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 84, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 225, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 352, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.7/site-packages/google/api_core/future/polling.py", line 127, in result
    raise self._exception
google.api_core.exceptions.NotFound: 404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US

(job ID: 3b9e2ec9-9ec8-45ee-90ad-39bc43f54083)

                                                              -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.payments"} */
   2:
   3:
   4:  create or replace view `prismatic-cider-279015`.`springml_demo_dataset`.`payments`
   5:  OPTIONS()
   6:  as select payment_type, 
   7:    count(*) as number_of_payments, 
   8:    sum(price) as total_price 
   9:from `prismatic-cider-279015`.`springml_demo_dataset`.`sales`
  10:where country like "United States"
  11:group by payment_type;
  12:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 234, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 227, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 363, in _retry_and_handle
    deadline=None)
  File "/usr/local/Cellar/python/3.7.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error in model payments (models/base/payments.sql)
  404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
  
  (job ID: 3b9e2ec9-9ec8-45ee-90ad-39bc43f54083)
2020-07-31 20:14:59.423151 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38ded2b0-f718-49c2-9cfa-52da1f9390b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a0ccd0>]}
2020-07-31 20:14:59.424405 (Thread-1): 16:14:59 | 3 of 4 ERROR creating view model springml_demo_dataset.payments...... [ERROR in 0.29s]
2020-07-31 20:14:59.424562 (Thread-1): Finished running node model.springml_demo_dbt_project.payments
2020-07-31 20:14:59.424733 (Thread-1): Began running node model.springml_demo_dbt_project.redact_fields
2020-07-31 20:14:59.426231 (Thread-1): 16:14:59 | 4 of 4 START table model springml_demo_dataset.redact_fields......... [RUN]
2020-07-31 20:14:59.426765 (Thread-1): Acquiring new bigquery connection "model.springml_demo_dbt_project.redact_fields".
2020-07-31 20:14:59.426926 (Thread-1): Re-using an available connection from the pool (formerly model.springml_demo_dbt_project.payments).
2020-07-31 20:14:59.427030 (Thread-1): Compiling model.springml_demo_dbt_project.redact_fields
2020-07-31 20:14:59.438926 (Thread-1): Writing injected SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-31 20:14:59.439394 (Thread-1): finished collecting timing info
2020-07-31 20:14:59.444210 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-31 20:14:59.628700 (Thread-1): Writing runtime SQL for node "model.springml_demo_dbt_project.redact_fields"
2020-07-31 20:14:59.629314 (Thread-1): On model.springml_demo_dbt_project.redact_fields: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "springml", "target_name": "dev", "node_id": "model.springml_demo_dbt_project.redact_fields"} */


  create or replace table `prismatic-cider-279015`.`springml_demo_dataset`.`redact_fields`
  
  
  OPTIONS()
  as (
    with source as (
	select * 
	from
		`prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`
),

casted as (
	select
		Employee_no as Emp_no,
		cast(Phone_no as string),
		cast(Social_insurance_no as string)
	from source
),

casted_redacted as (
	select
		Emp_no,
		'##ARCHIVED##' as Phone_no,
		'##ARCHIVED##' as Social_insurance_no
	from casted
),

redacted as (
	select
		Employee_no,
		'##ARCHIVED##' as Surname,
		'##ARCHIVED##'as Given_name,
		Gender,
		City,
		Age,
		Year_joined
	from	
		source
)

select 
	redacted.Employee_no,
	redacted.Surname,
	redacted.Given_name,
	redacted.Gender,
	redacted.City,
	redacted.Age,
	redacted.Year_joined,
	casted_redacted.Phone_no,
	casted_redacted.Social_insurance_no
from 
	redacted
join 
	casted_redacted 
		on redacted.Employee_no = casted_redacted.Emp_no
  );
    
2020-07-31 20:15:05.173998 (Thread-1): finished collecting timing info
2020-07-31 20:15:05.176387 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38ded2b0-f718-49c2-9cfa-52da1f9390b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101e5990>]}
2020-07-31 20:15:05.177830 (Thread-1): 16:15:05 | 4 of 4 OK created table model springml_demo_dataset.redact_fields.... [CREATE TABLE (8336) in 5.75s]
2020-07-31 20:15:05.178216 (Thread-1): Finished running node model.springml_demo_dbt_project.redact_fields
2020-07-31 20:15:05.231282 (MainThread): Acquiring new bigquery connection "master".
2020-07-31 20:15:05.231489 (MainThread): Opening a new connection, currently in state closed
2020-07-31 20:15:05.231857 (MainThread): 16:15:05 | 
2020-07-31 20:15:05.232005 (MainThread): 16:15:05 | Finished running 2 view models, 2 table models in 14.30s.
2020-07-31 20:15:05.232178 (MainThread): Connection 'master' was properly closed.
2020-07-31 20:15:05.232342 (MainThread): Connection 'model.springml_demo_dbt_project.redact_fields' was left open.
2020-07-31 20:15:05.249068 (MainThread): 
2020-07-31 20:15:05.249361 (MainThread): Completed with 2 errors and 0 warnings:
2020-07-31 20:15:05.249697 (MainThread): 
2020-07-31 20:15:05.249910 (MainThread): Runtime Error in model creditcard (models/base/creditcard.sql)
2020-07-31 20:15:05.250047 (MainThread):   404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
2020-07-31 20:15:05.250176 (MainThread):   
2020-07-31 20:15:05.250299 (MainThread):   (job ID: e3529d7e-dec4-486b-a871-28eefadbb2c6)
2020-07-31 20:15:05.250429 (MainThread): 
2020-07-31 20:15:05.250564 (MainThread): Runtime Error in model payments (models/base/payments.sql)
2020-07-31 20:15:05.250719 (MainThread):   404 Not found: Table prismatic-cider-279015:springml_demo_dataset.sales was not found in location US
2020-07-31 20:15:05.250899 (MainThread):   
2020-07-31 20:15:05.251068 (MainThread):   (job ID: 3b9e2ec9-9ec8-45ee-90ad-39bc43f54083)
2020-07-31 20:15:05.251216 (MainThread): 
Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
2020-07-31 20:15:05.251472 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fffcdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffcd350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffcded0>]}
2020-07-31 20:15:05.251689 (MainThread): Flushing usage events
