{"results": [{"node": {"raw_sql": "{% set creditcards = [\"Amex\", \"Mastercard\", \"Visa\"] %}\n\nselect country,\n{% for creditcard in creditcards %}\nsum(case when payment_type = '{{creditcard}}' then 1 else 0 end) as {{creditcard}}_payments,\n{% endfor %}\nfrom {{ source('springml_demo_dataset','sales') }}\ngroup by country \nhaving not (Amex_payments = 0 \nand\tMastercard_payments = 0 \nand\t Visa_payments = 0)\norder by (Amex_payments + Mastercard_payments + Visa_payments) desc", "database": "prismatic-cider-279015", "schema": "springml_demo_dataset", "fqn": ["springml_demo_dbt_project", "base", "creditcard"], "unique_id": "model.springml_demo_dbt_project.creditcard", "package_name": "springml_demo_dbt_project", "root_path": "/Users/medhapatil/springml/springml_demo_dbt", "path": "base/creditcard.sql", "original_file_path": "models/base/creditcard.sql", "name": "creditcard", "resource_type": "model", "alias": "creditcard", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [], "sources": [["springml_demo_dataset", "sales"]], "depends_on": {"macros": [], "nodes": ["source.springml_demo_dbt_project.springml_demo_dataset.sales"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/springml_demo_dbt_project/models/base/creditcard.sql", "compiled": true, "compiled_sql": "\n\nselect country,\n\nsum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,\n\nsum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,\n\nsum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,\n\nfrom `prismatic-cider-279015`.`springml_demo_dataset`.`sales`\ngroup by country \nhaving not (Amex_payments = 0 \nand\tMastercard_payments = 0 \nand\t Visa_payments = 0)\norder by (Amex_payments + Mastercard_payments + Visa_payments) desc", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\nselect country,\n\nsum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,\n\nsum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,\n\nsum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,\n\nfrom `prismatic-cider-279015`.`springml_demo_dataset`.`sales`\ngroup by country \nhaving not (Amex_payments = 0 \nand\tMastercard_payments = 0 \nand\t Visa_payments = 0)\norder by (Amex_payments + Mastercard_payments + Visa_payments) desc"}, "error": null, "status": null, "execution_time": 0.023730039596557617, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-07-08T09:22:18.696571Z", "completed_at": "2020-07-08T09:22:18.718802Z"}, {"name": "execute", "started_at": "2020-07-08T09:22:18.719274Z", "completed_at": "2020-07-08T09:22:18.719296Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "select payment_type, \n    count(*) as number_of_payments, \n    sum(price) as total_price \nfrom {{ source('springml_demo_dataset','sales') }}\nwhere country like \"United States\"\ngroup by payment_type", "database": "prismatic-cider-279015", "schema": "springml_demo_dataset", "fqn": ["springml_demo_dbt_project", "base", "payments"], "unique_id": "model.springml_demo_dbt_project.payments", "package_name": "springml_demo_dbt_project", "root_path": "/Users/medhapatil/springml/springml_demo_dbt", "path": "base/payments.sql", "original_file_path": "models/base/payments.sql", "name": "payments", "resource_type": "model", "alias": "payments", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [], "sources": [["springml_demo_dataset", "sales"]], "depends_on": {"macros": [], "nodes": ["source.springml_demo_dbt_project.springml_demo_dataset.sales"]}, "description": "Analysing payment types from sales data", "columns": {"payment_type": {"name": "payment_type", "description": "Payment type: Credit or cash", "meta": {}, "data_type": null, "tags": []}, "number_of_payments": {"name": "number_of_payments", "description": "", "meta": {}, "data_type": null, "tags": []}, "total_price": {"name": "total_price", "description": "", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/base/schema.yml", "build_path": "target/compiled/springml_demo_dbt_project/models/base/payments.sql", "compiled": true, "compiled_sql": "select payment_type, \n    count(*) as number_of_payments, \n    sum(price) as total_price \nfrom `prismatic-cider-279015`.`springml_demo_dataset`.`sales`\nwhere country like \"United States\"\ngroup by payment_type", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "select payment_type, \n    count(*) as number_of_payments, \n    sum(price) as total_price \nfrom `prismatic-cider-279015`.`springml_demo_dataset`.`sales`\nwhere country like \"United States\"\ngroup by payment_type"}, "error": null, "status": null, "execution_time": 0.02324986457824707, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-07-08T09:22:18.720706Z", "completed_at": "2020-07-08T09:22:18.742260Z"}, {"name": "execute", "started_at": "2020-07-08T09:22:18.742863Z", "completed_at": "2020-07-08T09:22:18.742876Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "", "database": "prismatic-cider-279015", "schema": "springml_demo_dataset", "fqn": ["springml_demo_dbt_project", "datafile_sales"], "unique_id": "seed.springml_demo_dbt_project.datafile_sales", "package_name": "springml_demo_dbt_project", "root_path": "/Users/medhapatil/springml/springml_demo_dbt", "path": "datafile_sales.csv", "original_file_path": "data/datafile_sales.csv", "name": "datafile_sales", "resource_type": "seed", "alias": "datafile_sales", "config": {"enabled": true, "materialized": "seed", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "quote_columns": null}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": [], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": null, "compiled": true, "compiled_sql": "", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": ""}, "error": null, "status": null, "execution_time": 0.022739887237548828, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-07-08T09:22:18.745077Z", "completed_at": "2020-07-08T09:22:18.765350Z"}, {"name": "execute", "started_at": "2020-07-08T09:22:18.766073Z", "completed_at": "2020-07-08T09:22:18.766087Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "-- Making sure that there are no countries that have zero payments in all three credit cards\n\nselect country\nfrom {{ ref('creditcard' )}}\nwhere Amex_payments = 0 and\tMastercard_payments = 0 and\t Visa_payments = 0", "database": "prismatic-cider-279015", "schema": "springml_demo_dataset", "fqn": ["springml_demo_dbt_project", "data_test", "creditcardtest"], "unique_id": "test.springml_demo_dbt_project.creditcardtest", "package_name": "springml_demo_dbt_project", "root_path": "/Users/medhapatil/springml/springml_demo_dbt", "path": "data_test/creditcardtest.sql", "original_file_path": "tests/creditcardtest.sql", "name": "creditcardtest", "resource_type": "test", "alias": "creditcardtest", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "ERROR"}, "tags": ["data"], "refs": [["creditcard"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.springml_demo_dbt_project.creditcard"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/springml_demo_dbt_project/tests/creditcardtest.sql", "compiled": true, "compiled_sql": "-- Making sure that there are no countries that have zero payments in all three credit cards\n\nselect country\nfrom `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`\nwhere Amex_payments = 0 and\tMastercard_payments = 0 and\t Visa_payments = 0", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "-- Making sure that there are no countries that have zero payments in all three credit cards\n\nselect country\nfrom `prismatic-cider-279015`.`springml_demo_dataset`.`creditcard`\nwhere Amex_payments = 0 and\tMastercard_payments = 0 and\t Visa_payments = 0"}, "error": null, "status": null, "execution_time": 0.024684906005859375, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-07-08T09:22:18.769024Z", "completed_at": "2020-07-08T09:22:18.792043Z"}, {"name": "execute", "started_at": "2020-07-08T09:22:18.792390Z", "completed_at": "2020-07-08T09:22:18.792399Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_accepted_values(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "accepted_values", "kwargs": {"values": ["Mastercard", "Amex", "Visa", "Diners"], "column_name": "payment_type", "model": "{{ ref('payments') }}"}}, "database": "prismatic-cider-279015", "schema": "springml_demo_dataset", "fqn": ["springml_demo_dbt_project", "schema_test", "accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners"], "unique_id": "test.springml_demo_dbt_project.accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners", "package_name": "springml_demo_dbt_project", "root_path": "/Users/medhapatil/springml/springml_demo_dbt", "path": "schema_test/accepted_values_payments_794507e7eb7cd6afaa023640efdcd53e.sql", "original_file_path": "models/base/schema.yml", "name": "accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners", "resource_type": "test", "alias": "accepted_values_payments_payment_type__Mastercard__Amex__Visa__Diners", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "ERROR"}, "tags": ["schema"], "refs": [["payments"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values"], "nodes": ["model.springml_demo_dbt_project.payments"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/springml_demo_dbt_project/models/base/schema.yml/schema_test/accepted_values_payments_794507e7eb7cd6afaa023640efdcd53e.sql", "compiled": true, "compiled_sql": "\n\n\n\n\nwith all_values as (\n\n    select distinct\n        payment_type as value_field\n\n    from `prismatic-cider-279015`.`springml_demo_dataset`.`payments`\n\n),\n\nvalidation_errors as (\n\n    select\n        value_field\n\n    from all_values\n    where value_field not in (\n        'Mastercard','Amex','Visa','Diners'\n    )\n)\n\nselect count(*) as validation_errors\nfrom validation_errors\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\n\nwith all_values as (\n\n    select distinct\n        payment_type as value_field\n\n    from `prismatic-cider-279015`.`springml_demo_dataset`.`payments`\n\n),\n\nvalidation_errors as (\n\n    select\n        value_field\n\n    from all_values\n    where value_field not in (\n        'Mastercard','Amex','Visa','Diners'\n    )\n)\n\nselect count(*) as validation_errors\nfrom validation_errors\n\n", "column_name": "payment_type"}, "error": null, "status": null, "execution_time": 0.02220916748046875, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-07-08T09:22:18.793554Z", "completed_at": "2020-07-08T09:22:18.814310Z"}, {"name": "execute", "started_at": "2020-07-08T09:22:18.814753Z", "completed_at": "2020-07-08T09:22:18.814764Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "number_of_payments", "model": "{{ ref('payments') }}"}}, "database": "prismatic-cider-279015", "schema": "springml_demo_dataset", "fqn": ["springml_demo_dbt_project", "schema_test", "not_null_payments_number_of_payments"], "unique_id": "test.springml_demo_dbt_project.not_null_payments_number_of_payments", "package_name": "springml_demo_dbt_project", "root_path": "/Users/medhapatil/springml/springml_demo_dbt", "path": "schema_test/not_null_payments_number_of_payments.sql", "original_file_path": "models/base/schema.yml", "name": "not_null_payments_number_of_payments", "resource_type": "test", "alias": "not_null_payments_number_of_payments", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "ERROR"}, "tags": ["schema"], "refs": [["payments"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.springml_demo_dbt_project.payments"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/springml_demo_dbt_project/models/base/schema.yml/schema_test/not_null_payments_number_of_payments.sql", "compiled": true, "compiled_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom `prismatic-cider-279015`.`springml_demo_dataset`.`payments`\nwhere number_of_payments is null\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom `prismatic-cider-279015`.`springml_demo_dataset`.`payments`\nwhere number_of_payments is null\n\n", "column_name": "number_of_payments"}, "error": null, "status": null, "execution_time": 0.014279842376708984, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-07-08T09:22:18.816063Z", "completed_at": "2020-07-08T09:22:18.828436Z"}, {"name": "execute", "started_at": "2020-07-08T09:22:18.829010Z", "completed_at": "2020-07-08T09:22:18.829023Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "total_price", "model": "{{ ref('payments') }}"}}, "database": "prismatic-cider-279015", "schema": "springml_demo_dataset", "fqn": ["springml_demo_dbt_project", "schema_test", "not_null_payments_total_price"], "unique_id": "test.springml_demo_dbt_project.not_null_payments_total_price", "package_name": "springml_demo_dbt_project", "root_path": "/Users/medhapatil/springml/springml_demo_dbt", "path": "schema_test/not_null_payments_total_price.sql", "original_file_path": "models/base/schema.yml", "name": "not_null_payments_total_price", "resource_type": "test", "alias": "not_null_payments_total_price", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "ERROR"}, "tags": ["schema"], "refs": [["payments"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.springml_demo_dbt_project.payments"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/springml_demo_dbt_project/models/base/schema.yml/schema_test/not_null_payments_total_price.sql", "compiled": true, "compiled_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom `prismatic-cider-279015`.`springml_demo_dataset`.`payments`\nwhere total_price is null\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom `prismatic-cider-279015`.`springml_demo_dataset`.`payments`\nwhere total_price is null\n\n", "column_name": "total_price"}, "error": null, "status": null, "execution_time": 0.015933990478515625, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-07-08T09:22:18.831364Z", "completed_at": "2020-07-08T09:22:18.845635Z"}, {"name": "execute", "started_at": "2020-07-08T09:22:18.846092Z", "completed_at": "2020-07-08T09:22:18.846103Z"}], "fail": null, "warn": null, "skip": false}], "generated_at": "2020-07-08T09:22:18.900546Z", "elapsed_time": 2.737485885620117}