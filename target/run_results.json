{"results": [{"node": {"raw_sql": "{% set creditcards = [\"Amex\", \"Mastercard\", \"Visa\"] %}\n\nselect country,\n{% for creditcard in creditcards %}\nsum(case when payment_type = '{{creditcard}}' then 1 else 0 end) as {{creditcard}}_payments,\n{% endfor %}\nfrom {{ source('springml_demo_dataset','sales') }}\ngroup by country \nhaving not (Amex_payments = 0 \nand\tMastercard_payments = 0 \nand\t Visa_payments = 0)\norder by (Amex_payments + Mastercard_payments + Visa_payments) desc", "database": "prismatic-cider-279015", "schema": "springml_demo_dataset", "fqn": ["springml_demo_dbt_project", "base", "creditcard"], "unique_id": "model.springml_demo_dbt_project.creditcard", "package_name": "springml_demo_dbt_project", "root_path": "/Users/medhapatil/springml/springml_demo_dbt", "path": "base/creditcard.sql", "original_file_path": "models/base/creditcard.sql", "name": "creditcard", "resource_type": "model", "alias": "creditcard", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [], "sources": [["springml_demo_dataset", "sales"]], "depends_on": {"macros": ["macro.dbt.create_or_replace_view", "macro.dbt.persist_docs"], "nodes": ["source.springml_demo_dbt_project.springml_demo_dataset.sales"]}, "description": "Viewing credit card payment counts by country", "columns": {"country": {"name": "country", "description": "", "meta": {}, "data_type": null, "tags": []}, "Amex_payments": {"name": "Amex_payments", "description": "", "meta": {}, "data_type": null, "tags": []}, "Mastercard_payments": {"name": "Mastercard_payments", "description": "", "meta": {}, "data_type": null, "tags": []}, "Visa_payments": {"name": "Visa_payments", "description": "", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/base/schema.yml", "build_path": "target/run/springml_demo_dbt_project/models/base/creditcard.sql", "compiled": true, "compiled_sql": "\n\nselect country,\n\nsum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,\n\nsum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,\n\nsum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,\n\nfrom `prismatic-cider-279015`.`springml_demo_dataset`.`sales`\ngroup by country \nhaving not (Amex_payments = 0 \nand\tMastercard_payments = 0 \nand\t Visa_payments = 0)\norder by (Amex_payments + Mastercard_payments + Visa_payments) desc", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\nselect country,\n\nsum(case when payment_type = 'Amex' then 1 else 0 end) as Amex_payments,\n\nsum(case when payment_type = 'Mastercard' then 1 else 0 end) as Mastercard_payments,\n\nsum(case when payment_type = 'Visa' then 1 else 0 end) as Visa_payments,\n\nfrom `prismatic-cider-279015`.`springml_demo_dataset`.`sales`\ngroup by country \nhaving not (Amex_payments = 0 \nand\tMastercard_payments = 0 \nand\t Visa_payments = 0)\norder by (Amex_payments + Mastercard_payments + Visa_payments) desc"}, "error": null, "status": "CREATE VIEW", "execution_time": 0.7676758766174316, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-07-16T19:39:08.898212Z", "completed_at": "2020-07-16T19:39:08.921813Z"}, {"name": "execute", "started_at": "2020-07-16T19:39:08.922143Z", "completed_at": "2020-07-16T19:39:09.664850Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "SELECT \nCURRENT_DATE() as Ingestion_date, \ncountif(ad.Gender is not null and ad.Gender=\"F\" ) as Female_count,\ncountif(ad.Gender is not null and ad.Gender=\"M\" ) as Male_count,\nFROM {{ source('springml_demo_dataset','applicant_data') }} as ad", "database": "prismatic-cider-279015", "schema": "springml_demo_dataset", "fqn": ["springml_demo_dbt_project", "applicant", "gender_count"], "unique_id": "model.springml_demo_dbt_project.gender_count", "package_name": "springml_demo_dbt_project", "root_path": "/Users/medhapatil/springml/springml_demo_dbt", "path": "applicant/gender_count.sql", "original_file_path": "models/applicant/gender_count.sql", "name": "gender_count", "resource_type": "model", "alias": "gender_count", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [], "sources": [["springml_demo_dataset", "applicant_data"]], "depends_on": {"macros": ["macro.dbt.create_or_replace_view", "macro.dbt.persist_docs"], "nodes": ["source.springml_demo_dbt_project.springml_demo_dataset.applicant_data"]}, "description": "Number of female and male applicants till today", "columns": {"Ingestion_date": {"name": "Ingestion_date", "description": "", "meta": {}, "data_type": null, "tags": []}, "Female_count": {"name": "Female_count", "description": "", "meta": {}, "data_type": null, "tags": []}, "Male_count": {"name": "Male_count", "description": "", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/applicant/schema.yml", "build_path": "target/run/springml_demo_dbt_project/models/applicant/gender_count.sql", "compiled": true, "compiled_sql": "SELECT \nCURRENT_DATE() as Ingestion_date, \ncountif(ad.Gender is not null and ad.Gender=\"F\" ) as Female_count,\ncountif(ad.Gender is not null and ad.Gender=\"M\" ) as Male_count,\nFROM `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data` as ad", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "SELECT \nCURRENT_DATE() as Ingestion_date, \ncountif(ad.Gender is not null and ad.Gender=\"F\" ) as Female_count,\ncountif(ad.Gender is not null and ad.Gender=\"M\" ) as Male_count,\nFROM `prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data` as ad"}, "error": null, "status": "CREATE VIEW", "execution_time": 0.6530551910400391, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-07-16T19:39:09.669453Z", "completed_at": "2020-07-16T19:39:09.679551Z"}, {"name": "execute", "started_at": "2020-07-16T19:39:09.679831Z", "completed_at": "2020-07-16T19:39:10.321518Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "select payment_type, \n    count(*) as number_of_payments, \n    sum(price) as total_price \nfrom {{ source('springml_demo_dataset','sales') }}\nwhere country like \"United States\"\ngroup by payment_type", "database": "prismatic-cider-279015", "schema": "springml_demo_dataset", "fqn": ["springml_demo_dbt_project", "base", "payments"], "unique_id": "model.springml_demo_dbt_project.payments", "package_name": "springml_demo_dbt_project", "root_path": "/Users/medhapatil/springml/springml_demo_dbt", "path": "base/payments.sql", "original_file_path": "models/base/payments.sql", "name": "payments", "resource_type": "model", "alias": "payments", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [], "sources": [["springml_demo_dataset", "sales"]], "depends_on": {"macros": ["macro.dbt.create_or_replace_view", "macro.dbt.persist_docs"], "nodes": ["source.springml_demo_dbt_project.springml_demo_dataset.sales"]}, "description": "Analysing payment types from sales data", "columns": {"payment_type": {"name": "payment_type", "description": "Payment type: Credit or cash", "meta": {}, "data_type": null, "tags": []}, "number_of_payments": {"name": "number_of_payments", "description": "", "meta": {}, "data_type": null, "tags": []}, "total_price": {"name": "total_price", "description": "", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/base/schema.yml", "build_path": "target/run/springml_demo_dbt_project/models/base/payments.sql", "compiled": true, "compiled_sql": "select payment_type, \n    count(*) as number_of_payments, \n    sum(price) as total_price \nfrom `prismatic-cider-279015`.`springml_demo_dataset`.`sales`\nwhere country like \"United States\"\ngroup by payment_type", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "select payment_type, \n    count(*) as number_of_payments, \n    sum(price) as total_price \nfrom `prismatic-cider-279015`.`springml_demo_dataset`.`sales`\nwhere country like \"United States\"\ngroup by payment_type"}, "error": null, "status": "CREATE VIEW", "execution_time": 0.8774518966674805, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-07-16T19:39:10.326238Z", "completed_at": "2020-07-16T19:39:10.336451Z"}, {"name": "execute", "started_at": "2020-07-16T19:39:10.336713Z", "completed_at": "2020-07-16T19:39:11.202583Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "with source as (\n\tselect * \n\tfrom\n\t\t{{ source('springml_demo_dataset','applicant_data') }}\n),\n\ncasted as (\n\tselect\n\t\tEmployee_no as Emp_no,\n\t\tcast(Phone_no as string),\n\t\tcast(Social_insurance_no as string)\n\tfrom source\n),\n\ncasted_edited as (\n\tselect\n\t\tEmp_no,\n\t\t'##ARCHIVED##' as Phone_no,\n\t\t'##ARCHIVED##' as Social_insurance_no\n\tfrom casted\n),\n\nedited as (\n\tselect\n\t\tEmployee_no,\n\t\t'##ARCHIVED##' as Surname,\n\t\t'##ARCHIVED##'as Given_name,\n\t\tGender,\n\t\tCity,\n\t\tAge,\n\t\tYear_joined\n\tfrom\t\n\t\tsource\n)\n\nselect edited.Employee_no,\nedited.Surname,\nedited.Given_name,\nedited.Gender,\nedited.City,\nedited.Age,\nedited.Year_joined,\ncasted_edited.Phone_no,\ncasted_edited.Social_insurance_no\nfrom edited\njoin casted_edited on edited.Employee_no = casted_edited.Emp_no", "database": "prismatic-cider-279015", "schema": "springml_demo_dataset", "fqn": ["springml_demo_dbt_project", "applicant", "redact_fields"], "unique_id": "model.springml_demo_dbt_project.redact_fields", "package_name": "springml_demo_dbt_project", "root_path": "/Users/medhapatil/springml/springml_demo_dbt", "path": "applicant/redact_fields.sql", "original_file_path": "models/applicant/redact_fields.sql", "name": "redact_fields", "resource_type": "model", "alias": "redact_fields", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [], "sources": [["springml_demo_dataset", "applicant_data"]], "depends_on": {"macros": ["macro.dbt.create_or_replace_view", "macro.dbt.persist_docs"], "nodes": ["source.springml_demo_dbt_project.springml_demo_dataset.applicant_data"]}, "description": "Redacted table of applicants hired more than 5 years ago from today", "columns": {"Employee_no": {"name": "Employee_no", "description": "", "meta": {}, "data_type": null, "tags": []}, "Surname": {"name": "Surname", "description": "", "meta": {}, "data_type": null, "tags": []}, "Given_name": {"name": "Given_name", "description": "", "meta": {}, "data_type": null, "tags": []}, "Gender": {"name": "Gender", "description": "", "meta": {}, "data_type": null, "tags": []}, "City": {"name": "City", "description": "", "meta": {}, "data_type": null, "tags": []}, "Age": {"name": "Age", "description": "", "meta": {}, "data_type": null, "tags": []}, "Year_joined": {"name": "Year_joined", "description": "", "meta": {}, "data_type": null, "tags": []}, "Phone_no": {"name": "Phone_no", "description": "", "meta": {}, "data_type": null, "tags": []}, "Social_insurance_no": {"name": "Social_insurance_no", "description": "", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/applicant/schema.yml", "build_path": "target/run/springml_demo_dbt_project/models/applicant/redact_fields.sql", "compiled": true, "compiled_sql": "with source as (\n\tselect * \n\tfrom\n\t\t`prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`\n),\n\ncasted as (\n\tselect\n\t\tEmployee_no as Emp_no,\n\t\tcast(Phone_no as string),\n\t\tcast(Social_insurance_no as string)\n\tfrom source\n),\n\ncasted_edited as (\n\tselect\n\t\tEmp_no,\n\t\t'##ARCHIVED##' as Phone_no,\n\t\t'##ARCHIVED##' as Social_insurance_no\n\tfrom casted\n),\n\nedited as (\n\tselect\n\t\tEmployee_no,\n\t\t'##ARCHIVED##' as Surname,\n\t\t'##ARCHIVED##'as Given_name,\n\t\tGender,\n\t\tCity,\n\t\tAge,\n\t\tYear_joined\n\tfrom\t\n\t\tsource\n)\n\nselect edited.Employee_no,\nedited.Surname,\nedited.Given_name,\nedited.Gender,\nedited.City,\nedited.Age,\nedited.Year_joined,\ncasted_edited.Phone_no,\ncasted_edited.Social_insurance_no\nfrom edited\njoin casted_edited on edited.Employee_no = casted_edited.Emp_no", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "with source as (\n\tselect * \n\tfrom\n\t\t`prismatic-cider-279015`.`springml_demo_dataset`.`applicant_data`\n),\n\ncasted as (\n\tselect\n\t\tEmployee_no as Emp_no,\n\t\tcast(Phone_no as string),\n\t\tcast(Social_insurance_no as string)\n\tfrom source\n),\n\ncasted_edited as (\n\tselect\n\t\tEmp_no,\n\t\t'##ARCHIVED##' as Phone_no,\n\t\t'##ARCHIVED##' as Social_insurance_no\n\tfrom casted\n),\n\nedited as (\n\tselect\n\t\tEmployee_no,\n\t\t'##ARCHIVED##' as Surname,\n\t\t'##ARCHIVED##'as Given_name,\n\t\tGender,\n\t\tCity,\n\t\tAge,\n\t\tYear_joined\n\tfrom\t\n\t\tsource\n)\n\nselect edited.Employee_no,\nedited.Surname,\nedited.Given_name,\nedited.Gender,\nedited.City,\nedited.Age,\nedited.Year_joined,\ncasted_edited.Phone_no,\ncasted_edited.Social_insurance_no\nfrom edited\njoin casted_edited on edited.Employee_no = casted_edited.Emp_no"}, "error": null, "status": "CREATE VIEW", "execution_time": 0.8540759086608887, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-07-16T19:39:11.207324Z", "completed_at": "2020-07-16T19:39:11.220685Z"}, {"name": "execute", "started_at": "2020-07-16T19:39:11.220979Z", "completed_at": "2020-07-16T19:39:12.059845Z"}], "fail": null, "warn": null, "skip": false}], "generated_at": "2020-07-16T19:39:12.103654Z", "elapsed_time": 5.61185097694397}